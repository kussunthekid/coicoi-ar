"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[701],{4355:(e,t,n)=>{n.d(t,{A:()=>i});let i=(0,n(7565).A)("camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]])},5169:(e,t,n)=>{n.d(t,{A:()=>i});let i=(0,n(7565).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},7565:(e,t,n)=>{n.d(t,{A:()=>s});var i=n(2115);let a=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},o=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((e,t,n)=>!!e&&""!==e.trim()&&n.indexOf(e)===t).join(" ").trim()};var r={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,i.forwardRef)((e,t)=>{let{color:n="currentColor",size:a=24,strokeWidth:l=2,absoluteStrokeWidth:s,className:c="",children:d,iconNode:m,...p}=e;return(0,i.createElement)("svg",{ref:t,...r,width:a,height:a,stroke:n,strokeWidth:s?24*Number(l)/Number(a):l,className:o("lucide",c),...!d&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(p)&&{"aria-hidden":"true"},...p},[...m.map(e=>{let[t,n]=e;return(0,i.createElement)(t,n)}),...Array.isArray(d)?d:[d]])}),s=(e,t)=>{let n=(0,i.forwardRef)((n,r)=>{let{className:s,...c}=n;return(0,i.createElement)(l,{ref:r,iconNode:t,className:o("lucide-".concat(a(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),s),...c})});return n.displayName=a(e),n}},8701:(e,t,n)=>{n.r(t),n.d(t,{default:()=>s});var i=n(5155),a=n(2115),o=n(5169);let r=(0,n(7565).A)("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);var l=n(4355);let s=()=>{let e=(0,a.useRef)(null),[t,n]=(0,a.useState)(!1),[s,c]=(0,a.useState)(!1),[d,m]=(0,a.useState)(null),[p,h]=(0,a.useState)("coicoi"),g={coicoi:{mindFile:"/targets.mind",modelFile:"/coicoi.glb",modelName:"coicoi画像"},wkwk:{mindFile:"/targets.mind",modelFile:"/wkwk.glb",modelName:"wkwk画像"}};(0,a.useEffect)(()=>{(async()=>{try{if(!window.MINDAR||!window.AFRAME){for(let e of(console.log("Loading MindAR and A-Frame libraries..."),["https://aframe.io/releases/1.3.0/aframe.min.js","https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"]))await new Promise((t,n)=>{let i=document.createElement("script");i.src=e,i.async=!1,i.onload=()=>{console.log("Loaded: ".concat(e)),t()},i.onerror=()=>{console.error("Failed to load: ".concat(e)),n(Error("Failed to load ".concat(e)))},document.head.appendChild(i)});await new Promise(e=>setTimeout(e,500)),console.log("All libraries loaded")}n(!0)}catch(e){console.error("Failed to load libraries:",e),m("ARライブラリの読み込みに失敗しました。")}})()},[]);let u=async()=>{if(!e.current)return void m("コンテナが見つかりません");try{console.log("Starting AR initialization...");let t=g[p];console.log("Using marker config:",t,"Target index:",+("coicoi"!==p)),console.log("Skipping targets.mind validation for now...");let n=document.createElement("style");n.setAttribute("data-mindar-fullscreen","true"),n.textContent="\n        html, body {\n          margin: 0 !important;\n          padding: 0 !important;\n          overflow: hidden !important;\n          width: 100% !important;\n          height: 100% !important;\n        }\n        .mindar-ui-overlay {\n          position: fixed !important;\n          top: 0 !important;\n          left: 0 !important;\n          width: 100% !important;\n          height: 100% !important;\n        }\n        .mindar-ui-scanning {\n          width: 100% !important;\n          height: 100% !important;\n        }\n        a-scene {\n          position: fixed !important;\n          top: 0 !important;\n          left: 0 !important;\n          width: 100vw !important;\n          height: 100vh !important;\n          display: block !important;\n          margin: 0 !important;\n          padding: 0 !important;\n        }\n        a-scene canvas {\n          position: fixed !important;\n          top: 0 !important;\n          left: 0 !important;\n          width: 100% !important;\n          height: 100% !important;\n          display: block !important;\n        }\n        video {\n          position: fixed !important;\n          top: 0 !important;\n          left: 0 !important;\n          width: 100% !important;\n          height: 100% !important;\n          object-fit: cover !important;\n        }\n      ",document.head.appendChild(n),e.current.innerHTML='\n        <a-scene\n          mindar-image="imageTargetSrc: /targets.mind; maxTrack: 2; showStats: false; uiLoading: yes; uiScanning: yes; uiError: yes; filterMinCF: 0.0001; filterBeta: 1000; warmupTolerance: 5; missTolerance: 5;"\n          color-space="sRGB"\n          renderer="colorManagement: true, physicallyCorrectLights"\n          vr-mode-ui="enabled: false"\n          device-orientation-permission-ui="enabled: false"\n          embedded\n          style="display: block; width: 100%; height: 100%;"\n        >\n          <a-camera\n            position="0 0 0"\n            look-controls="enabled: false"\n            cursor="fuse: false; rayOrigin: mouse"\n            raycaster="far: 10000; objects: .clickable"\n          ></a-camera>\n          \n          \x3c!-- Coicoi用アンカー (index 0) --\x3e\n          <a-anchor mindar-image-target="targetIndex: 0">\n            <a-box \n              position="0 0.5 0" \n              material="color: red;" \n              scale="0.5 0.5 0.5"\n              visible="true"\n            ></a-box>\n            <a-gltf-model\n              src="/coicoi.glb"\n              position="0 0 0"\n              rotation="0 0 0"\n              scale="1 1 1"\n              animation-mixer=""\n              visible="true"\n            ></a-gltf-model>\n          </a-anchor>\n          \n          \x3c!-- WKWK用アンカー (index 1) --\x3e\n          <a-anchor mindar-image-target="targetIndex: 1">\n            <a-box \n              position="0 0.5 0" \n              material="color: yellow;" \n              scale="0.5 0.5 0.5"\n              visible="true"\n            ></a-box>\n            <a-gltf-model\n              src="/wkwk.glb"\n              position="0 0 0"\n              rotation="0 0 0"\n              scale="1 1 1"\n              animation-mixer=""\n              visible="true"\n            ></a-gltf-model>\n          </a-anchor>\n          \n          <a-light type="ambient" color="#ffffff" intensity="0.6"></a-light>\n          <a-light type="directional" position="0 1 1" intensity="0.8"></a-light>\n        </a-scene>\n      ',await new Promise(t=>{var n;let i=null==(n=e.current)?void 0:n.querySelector("a-scene");i?(i.style.cssText="position: fixed !important; top: 0 !important; left: 0 !important; width: 100vw !important; height: 100vh !important; display: block !important; margin: 0 !important; padding: 0 !important;",i.addEventListener("loaded",()=>{console.log("A-Frame scene loaded successfully");let e=i.querySelectorAll("a-anchor");console.log("Found ".concat(e.length," anchor(s) in scene")),e.forEach((e,t)=>{console.log("Setting up anchor ".concat(t,":"),e),e.addEventListener("targetFound",()=>{console.log("\uD83C\uDFAF Target ".concat(t," found! Showing 3D model..."));let n=e.querySelector("a-gltf-model"),i=e.querySelector("a-box");n&&(n.setAttribute("visible","true"),console.log("Model ".concat(t," made visible"))),i&&(i.setAttribute("visible","true"),console.log("Box ".concat(t," made visible")))}),e.addEventListener("targetLost",()=>{console.log("❌ Target ".concat(t," lost!"))})}),i.addEventListener("arReady",()=>{console.log("✅ MindAR is ready!")}),i.addEventListener("arError",e=>{console.error("❌ MindAR error:",e)}),i.querySelectorAll("canvas").forEach(e=>{e.style.cssText="position: fixed !important; top: 0 !important; left: 0 !important; width: 100% !important; height: 100% !important; display: block !important;"}),document.querySelectorAll("video").forEach(e=>{e.style.cssText="position: fixed !important; top: 0 !important; left: 0 !important; width: 100% !important; height: 100% !important; object-fit: cover !important;"}),document.querySelectorAll(".mindar-ui-overlay, .mindar-ui-scanning").forEach(e=>{e.style.cssText="position: fixed !important; top: 0 !important; left: 0 !important; width: 100% !important; height: 100% !important;"}),window.dispatchEvent(new Event("resize")),setTimeout(()=>window.dispatchEvent(new Event("resize")),100),t()})):setTimeout(t,1e3)}),c(!0),console.log("AR initialized successfully")}catch(e){console.error("AR initialization failed:",e),m("AR初期化に失敗しました")}},x=()=>{if(e.current){e.current.innerHTML="";let t=document.querySelector("style[data-mindar-fullscreen]");t&&t.remove(),c(!1)}};return(0,i.jsxs)("div",{className:"fixed inset-0 bg-black overflow-hidden",children:[(0,i.jsx)("div",{ref:e,className:"fixed inset-0",style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",margin:0,padding:0}}),(0,i.jsx)("div",{className:"absolute top-0 left-0 right-0 p-4 bg-gradient-to-b from-black/50 to-transparent z-10",children:(0,i.jsxs)("div",{className:"flex items-center justify-between text-white",children:[(0,i.jsxs)("button",{onClick:()=>{x(),window.location.href="/start"},className:"flex items-center gap-2 px-4 py-2 bg-black/50 rounded-lg backdrop-blur-sm hover:bg-black/70 transition-colors",children:[(0,i.jsx)(o.A,{className:"w-5 h-5"}),"戻る"]}),(0,i.jsx)("h1",{className:"text-lg font-semibold",children:"画像認識AR"}),(0,i.jsxs)("button",{onClick:()=>{x(),setTimeout(()=>u(),500)},className:"flex items-center gap-2 px-4 py-2 bg-black/50 rounded-lg backdrop-blur-sm hover:bg-black/70 transition-colors",children:[(0,i.jsx)(r,{className:"w-5 h-5"}),"リセット"]})]})}),(0,i.jsx)("div",{className:"absolute bottom-0 left-0 right-0 p-4 bg-gradient-to-t from-black/70 to-transparent z-10",children:(0,i.jsxs)("div",{className:"text-white text-center space-y-2",children:[(0,i.jsx)("p",{className:"text-sm opacity-90",children:"認識させたい画像をカメラに向けてください"}),(0,i.jsx)("div",{className:"flex justify-center space-x-4 text-xs",children:(0,i.jsxs)("span",{className:"bg-black/50 px-3 py-1 rounded",children:["coicoi"===p?"coicoi画像":"wkwk画像","を認識中"]})})]})}),t&&!s&&!d&&(0,i.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/80 z-20",children:(0,i.jsxs)("div",{className:"text-white text-center",children:[(0,i.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"認識する画像を選択"}),(0,i.jsxs)("div",{className:"flex gap-4 mb-6",children:[(0,i.jsx)("button",{onClick:()=>h("coicoi"),className:"px-6 py-3 rounded-lg transition-colors ".concat("coicoi"===p?"bg-cyan-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:"coicoi画像"}),(0,i.jsx)("button",{onClick:()=>h("wkwk"),className:"px-6 py-3 rounded-lg transition-colors ".concat("wkwk"===p?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:"wkwk画像"})]}),(0,i.jsxs)("button",{onClick:u,className:"flex items-center gap-3 px-8 py-4 bg-green-600 hover:bg-green-700 text-white rounded-lg text-lg font-semibold transition-colors mx-auto",children:[(0,i.jsx)(l.A,{className:"w-6 h-6"}),"ARを開始"]})]})}),!t&&!d&&(0,i.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black z-20",children:(0,i.jsxs)("div",{className:"text-white text-center",children:[(0,i.jsx)("div",{className:"animate-spin w-8 h-8 border-2 border-cyan-600 border-t-transparent rounded-full mx-auto mb-4"}),(0,i.jsx)("p",{children:"ARライブラリを読み込み中..."})]})}),d&&(0,i.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black z-20",children:(0,i.jsxs)("div",{className:"text-white text-center max-w-md mx-4",children:[(0,i.jsx)("div",{className:"text-red-500 text-xl mb-4",children:"⚠️"}),(0,i.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"エラーが発生しました"}),(0,i.jsx)("p",{className:"text-gray-300 mb-4",children:d}),(0,i.jsx)("button",{onClick:()=>window.location.reload(),className:"px-6 py-3 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg transition-colors",children:"再試行"})]})})]})}}}]);