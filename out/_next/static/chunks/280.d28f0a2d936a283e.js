"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[280],{1065:(e,t,r)=>{e.exports=r.p+"static/media/face_mesh_face_model.fa315231.zbin"},1142:(e,t,r)=>{r.d(t,{p8:()=>i,tb:()=>a});var i=1e-6,a="undefined"!=typeof Float32Array?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)})},2771:(e,t,r)=>{e.exports=r.p+"static/media/face_mesh_full_head_simplified_model.a7bd99f8.zbin"},6280:(e,t,r)=>{let i,a,s,n,o,l,_,c,d,h,u,m,p,f;r.r(t),r.d(t,{BarcodeFinder:()=>rM,Camera:()=>rO,CameraEnvironmentMap:()=>r4,CameraMirrorMode:()=>x,CameraPoseMode:()=>R,CameraProfile:()=>M,CameraSource:()=>rF,DefaultLoaderUI:()=>r0,FaceAnchorGroup:()=>rW,FaceBufferGeometry:()=>rY,FaceLandmark:()=>rc,FaceLandmarkGroup:()=>rq,FaceLandmarkName:()=>I.EC,FaceMesh:()=>rs,FaceMeshLoader:()=>rj,FaceTracker:()=>rk,FaceTrackerLoader:()=>rH,FeaturePointsGeometry:()=>iv,FeaturePointsMesh:()=>iw,GroundAnchorGroup:()=>r7,HTMLElementSource:()=>rC,HeadMaskMesh:()=>rX,HeadMaskMeshLoader:()=>r$,ImageAnchorGroup:()=>rN,ImageTracker:()=>rx,ImageTrackerLoader:()=>rV,InstantWorldAnchorGroup:()=>rG,InstantWorldTracker:()=>rI,LibraryLoader:()=>rQ,LoadingManager:()=>r1,LogLevel:()=>I.f_,Pipeline:()=>r_,SequenceSource:()=>rl,TargetImagePreviewBufferGeometry:()=>r2,TargetImagePreviewMesh:()=>r3,UserPlacementAnchorGroup:()=>ig,WorldAnchorGroup:()=>iA,WorldPlacementGroup:()=>ia,WorldTracker:()=>rS,WorldTrackerQuality:()=>I.DN,WorldTrackerUI:()=>rp,browserIncompatible:()=>t3,browserIncompatibleUI:()=>t5,cookiesPermitted:()=>t8,getDefaultPipeline:()=>rR,glContextLost:()=>rU,glContextSet:()=>rD,loaded:()=>t7,loadedPromise:()=>t6,onFrameUpdate:()=>rE,permissionDenied:()=>rg,permissionDeniedUI:()=>ry,permissionGranted:()=>rf,permissionRequest:()=>rv,permissionRequestUI:()=>rb,setLogLevel:()=>rw});class g{constructor(){this._funcs=[]}bind(e){this._funcs.push(e)}unbind(e){let t=this._funcs.indexOf(e);t>-1&&this._funcs.splice(t,1)}emit(){for(let e=0,t=this._funcs.length;e<t;e++)this._funcs[e]()}}class v{constructor(){this._funcs=[]}bind(e){this._funcs.push(e)}unbind(e){let t=this._funcs.indexOf(e);t>-1&&this._funcs.splice(t,1)}emit(e){for(let t=0,r=this._funcs.length;t<r;t++)this._funcs[t](e)}}var b,y,w,A,T,E,R,x,M,k,I=r(8044),S=r(8437),F=r(6050);class C{constructor(e){this._messageSender=e,this._globalState={log_level:1},this.serializer=new S.A(e=>{this._messageSender(e)}),this.deserializer=new F.X,this._latestId=1,this._pipeline_state_by_instance=new Map,this._camera_source_state_by_instance=new Map,this._sequence_source_state_by_instance=new Map,this._image_tracker_state_by_instance=new Map,this._face_tracker_state_by_instance=new Map,this._face_mesh_state_by_instance=new Map,this._face_landmark_state_by_instance=new Map,this._barcode_finder_state_by_instance=new Map,this._instant_world_tracker_state_by_instance=new Map,this._zapcode_tracker_state_by_instance=new Map,this._world_tracker_state_by_instance=new Map,this._custom_anchor_state_by_instance=new Map,this._d3_tracker_state_by_instance=new Map,this.impl={log_level:()=>this._globalState.log_level,log_level_set:e=>{this.serializer.sendMessage(39,t=>{t.logLevel(e)})},analytics_project_id_set:(e,t)=>{this.serializer.sendMessage(36,r=>{r.string(e),r.string(t)})},pipeline_create:()=>{let e=this._latestId++,t={current_frame_user_data:0,camera_model:new Float32Array([300,300,160,120,0,0]),camera_data_width:320,camera_data_height:240,camera_pose:new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),camera_frame_camera_attitude:new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),camera_frame_device_attitude:new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),frame_number:0};return this._pipeline_state_by_instance.set(e,t),this.serializer.sendMessage(32,t=>{t.type(e)}),e},pipeline_destroy:e=>{if(!this._pipeline_state_by_instance.get(e))throw Error("This object has been destroyed");this._pipeline_state_by_instance.delete(e),this.serializer.sendMessage(33,t=>{t.type(e)})},pipeline_frame_update:e=>{if(!this._pipeline_state_by_instance.get(e))throw Error("This object has been destroyed");this.serializer.sendMessage(9,t=>{t.type(e)})},pipeline_frame_number:e=>{let t=this._pipeline_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.frame_number},pipeline_camera_model:e=>{let t=this._pipeline_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.camera_model},pipeline_camera_data_width:e=>{let t=this._pipeline_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.camera_data_width},pipeline_camera_data_height:e=>{let t=this._pipeline_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.camera_data_height},pipeline_camera_frame_user_data:e=>{let t=this._pipeline_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.current_frame_user_data},pipeline_camera_frame_submit:(e,t,r,i,a,s,n,o,l)=>{if(!this._pipeline_state_by_instance.get(e))throw Error("This object has been destroyed");this.serializer.sendMessage(8,_=>{_.type(e),_.dataWithLength(t),_.int(r),_.int(i),_.int(a),_.matrix4x4(s),_.cameraModel(n),_.bool(o),_.int(l)})},pipeline_camera_frame_camera_attitude:e=>{let t=this._pipeline_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.camera_frame_camera_attitude},pipeline_camera_frame_device_attitude:e=>{let t=this._pipeline_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.camera_frame_device_attitude},pipeline_motion_accelerometer_submit:(e,t,r,i,a)=>{if(!this._pipeline_state_by_instance.get(e))throw Error("This object has been destroyed");this.serializer.sendMessage(10,s=>{s.type(e),s.timestamp(t),s.float(r),s.float(i),s.float(a)})},pipeline_motion_accelerometer_with_gravity_submit_int:(e,t,r,i,a,s)=>{if(!this._pipeline_state_by_instance.get(e))throw Error("This object has been destroyed");this.serializer.sendMessage(12,n=>{n.type(e),n.timestamp(t),n.timestamp(r),n.float(i),n.float(a),n.float(s)})},pipeline_motion_accelerometer_without_gravity_submit_int:(e,t,r,i,a,s)=>{if(!this._pipeline_state_by_instance.get(e))throw Error("This object has been destroyed");this.serializer.sendMessage(11,n=>{n.type(e),n.timestamp(t),n.timestamp(r),n.float(i),n.float(a),n.float(s)})},pipeline_motion_rotation_rate_submit:(e,t,r,i,a)=>{if(!this._pipeline_state_by_instance.get(e))throw Error("This object has been destroyed");this.serializer.sendMessage(15,s=>{s.type(e),s.timestamp(t),s.float(r),s.float(i),s.float(a)})},pipeline_motion_rotation_rate_submit_int:(e,t,r,i,a,s)=>{if(!this._pipeline_state_by_instance.get(e))throw Error("This object has been destroyed");this.serializer.sendMessage(13,n=>{n.type(e),n.timestamp(t),n.timestamp(r),n.float(i),n.float(a),n.float(s)})},pipeline_motion_attitude_submit:(e,t,r,i,a)=>{if(!this._pipeline_state_by_instance.get(e))throw Error("This object has been destroyed");this.serializer.sendMessage(16,s=>{s.type(e),s.timestamp(t),s.float(r),s.float(i),s.float(a)})},pipeline_motion_attitude_submit_int:(e,t,r,i,a,s)=>{if(!this._pipeline_state_by_instance.get(e))throw Error("This object has been destroyed");this.serializer.sendMessage(14,n=>{n.type(e),n.timestamp(t),n.timestamp(r),n.float(i),n.float(a),n.float(s)})},pipeline_motion_relative_orientation_submit_int:(e,t,r,i,a,s,n)=>{if(!this._pipeline_state_by_instance.get(e))throw Error("This object has been destroyed");this.serializer.sendMessage(17,o=>{o.type(e),o.timestamp(t),o.timestamp(r),o.float(i),o.float(a),o.float(s),o.float(n)})},pipeline_motion_attitude_matrix_submit:(e,t)=>{if(!this._pipeline_state_by_instance.get(e))throw Error("This object has been destroyed");this.serializer.sendMessage(18,r=>{r.type(e),r.matrix4x4(t)})},camera_source_create:(e,t)=>{let r=this._latestId++;return this._camera_source_state_by_instance.set(r,{}),this.serializer.sendMessage(34,i=>{i.type(r),i.type(e),i.string(t)}),r},camera_source_destroy:e=>{if(!this._camera_source_state_by_instance.get(e))throw Error("This object has been destroyed");this._camera_source_state_by_instance.delete(e),this.serializer.sendMessage(35,t=>{t.type(e)})},sequence_source_create:e=>{let t=this._latestId++;return this._sequence_source_state_by_instance.set(t,{}),this.serializer.sendMessage(40,r=>{r.type(t),r.type(e)}),t},sequence_source_destroy:e=>{if(!this._sequence_source_state_by_instance.get(e))throw Error("This object has been destroyed");this._sequence_source_state_by_instance.delete(e),this.serializer.sendMessage(41,t=>{t.type(e)})},image_tracker_create:e=>{let t=this._latestId++;return this._image_tracker_state_by_instance.set(t,{enabled:!0,target_loaded_version:-1,anchor_count:0,anchor_id:[],anchor_pose:[]}),this.serializer.sendMessage(2,r=>{r.type(t),r.type(e)}),t},image_tracker_destroy:e=>{if(!this._image_tracker_state_by_instance.get(e))throw Error("This object has been destroyed");this._image_tracker_state_by_instance.delete(e),this.serializer.sendMessage(19,t=>{t.type(e)})},image_tracker_target_load_from_memory:(e,t)=>{if(!this._image_tracker_state_by_instance.get(e))throw Error("This object has been destroyed");this.serializer.sendMessage(4,r=>{r.type(e),r.dataWithLength(t)})},image_tracker_target_loaded_version:e=>{let t=this._image_tracker_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.target_loaded_version},image_tracker_enabled:e=>{let t=this._image_tracker_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.enabled},image_tracker_enabled_set:(e,t)=>{let r=this._image_tracker_state_by_instance.get(e);if(!r)throw Error("This object has been destroyed");this.serializer.sendMessage(3,r=>{r.type(e),r.bool(t)}),r.enabled=t},image_tracker_anchor_count:e=>{let t=this._image_tracker_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.anchor_count},image_tracker_anchor_id:(e,t)=>{let r=this._image_tracker_state_by_instance.get(e);if(!r)throw Error("This object has been destroyed");return r.anchor_id[t]},image_tracker_anchor_pose_raw:(e,t)=>{let r=this._image_tracker_state_by_instance.get(e);if(!r)throw Error("This object has been destroyed");return r.anchor_pose[t]},face_tracker_create:e=>{let t=this._latestId++;return this._face_tracker_state_by_instance.set(t,{enabled:!0,model_loaded:-1,max_faces:1,anchor_count:0,anchor_id:[],anchor_pose:[],anchor_identity_coefficients:[],anchor_expression_coefficients:[]}),this.serializer.sendMessage(25,r=>{r.type(t),r.type(e)}),t},face_tracker_destroy:e=>{if(!this._face_tracker_state_by_instance.get(e))throw Error("This object has been destroyed");this._face_tracker_state_by_instance.delete(e),this.serializer.sendMessage(26,t=>{t.type(e)})},face_tracker_model_load_from_memory:(e,t)=>{if(!this._face_tracker_state_by_instance.get(e))throw Error("This object has been destroyed");this.serializer.sendMessage(27,r=>{r.type(e),r.dataWithLength(t)})},face_tracker_model_loaded_version:e=>{let t=this._face_tracker_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.model_loaded},face_tracker_enabled_set:(e,t)=>{let r=this._face_tracker_state_by_instance.get(e);if(!r)throw Error("This object has been destroyed");this.serializer.sendMessage(28,r=>{r.type(e),r.bool(t)}),r.enabled=t},face_tracker_enabled:e=>{let t=this._face_tracker_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.enabled},face_tracker_max_faces_set:(e,t)=>{let r=this._face_tracker_state_by_instance.get(e);if(!r)throw Error("This object has been destroyed");this.serializer.sendMessage(29,r=>{r.type(e),r.int(t)}),r.max_faces=t},face_tracker_max_faces:e=>{let t=this._face_tracker_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.max_faces},face_tracker_anchor_count:e=>{let t=this._face_tracker_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.anchor_count},face_tracker_anchor_id:(e,t)=>{let r=this._face_tracker_state_by_instance.get(e);if(!r)throw Error("This object has been destroyed");return r.anchor_id[t]},face_tracker_anchor_pose_raw:(e,t)=>{let r=this._face_tracker_state_by_instance.get(e);if(!r)throw Error("This object has been destroyed");return r.anchor_pose[t]},face_tracker_anchor_identity_coefficients:(e,t)=>{let r=this._face_tracker_state_by_instance.get(e);if(!r)throw Error("This object has been destroyed");return r.anchor_identity_coefficients[t]},face_tracker_anchor_expression_coefficients:(e,t)=>{let r=this._face_tracker_state_by_instance.get(e);if(!r)throw Error("This object has been destroyed");return r.anchor_expression_coefficients[t]},face_mesh_create:()=>{let e=this._latestId++;return this._face_mesh_state_by_instance.set(e,{}),this.serializer.sendMessage(30,t=>{t.type(e)}),e},face_mesh_destroy:e=>{if(!this._face_mesh_state_by_instance.get(e))throw Error("This object has been destroyed");this._face_mesh_state_by_instance.delete(e),this.serializer.sendMessage(31,t=>{t.type(e)})},face_landmark_create:e=>{let t=this._latestId++;return this._face_landmark_state_by_instance.set(t,{}),this.serializer.sendMessage(37,r=>{r.type(t),r.faceLandmarkName(e)}),t},face_landmark_destroy:e=>{if(!this._face_landmark_state_by_instance.get(e))throw Error("This object has been destroyed");this._face_landmark_state_by_instance.delete(e),this.serializer.sendMessage(38,t=>{t.type(e)})},barcode_finder_create:e=>{let t=this._latestId++;return this._barcode_finder_state_by_instance.set(t,{enabled:!0,number_found:0,found_text:[],found_format:[],formats:131071}),this.serializer.sendMessage(21,r=>{r.type(t),r.type(e)}),t},barcode_finder_destroy:e=>{if(!this._barcode_finder_state_by_instance.get(e))throw Error("This object has been destroyed");this._barcode_finder_state_by_instance.delete(e),this.serializer.sendMessage(22,t=>{t.type(e)})},barcode_finder_enabled_set:(e,t)=>{let r=this._barcode_finder_state_by_instance.get(e);if(!r)throw Error("This object has been destroyed");this.serializer.sendMessage(23,r=>{r.type(e),r.bool(t)}),r.enabled=t},barcode_finder_enabled:e=>{let t=this._barcode_finder_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.enabled},barcode_finder_found_number:e=>{let t=this._barcode_finder_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.number_found},barcode_finder_found_text:(e,t)=>{let r=this._barcode_finder_state_by_instance.get(e);if(!r)throw Error("This object has been destroyed");return r.found_text[t]},barcode_finder_found_format:(e,t)=>{let r=this._barcode_finder_state_by_instance.get(e);if(!r)throw Error("This object has been destroyed");return r.found_format[t]},barcode_finder_formats:e=>{let t=this._barcode_finder_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.formats},barcode_finder_formats_set:(e,t)=>{let r=this._barcode_finder_state_by_instance.get(e);if(!r)throw Error("This object has been destroyed");this.serializer.sendMessage(24,r=>{r.type(e),r.barcodeFormat(t)}),r.formats=t},instant_world_tracker_create:e=>{let t=this._latestId++,r={enabled:!0,pose:new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])};return this._instant_world_tracker_state_by_instance.set(t,r),this.serializer.sendMessage(5,r=>{r.type(t),r.type(e)}),t},instant_world_tracker_destroy:e=>{if(!this._instant_world_tracker_state_by_instance.get(e))throw Error("This object has been destroyed");this._instant_world_tracker_state_by_instance.delete(e),this.serializer.sendMessage(20,t=>{t.type(e)})},instant_world_tracker_enabled_set:(e,t)=>{let r=this._instant_world_tracker_state_by_instance.get(e);if(!r)throw Error("This object has been destroyed");this.serializer.sendMessage(6,r=>{r.type(e),r.bool(t)}),r.enabled=t},instant_world_tracker_enabled:e=>{let t=this._instant_world_tracker_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.enabled},instant_world_tracker_anchor_pose_raw:e=>{let t=this._instant_world_tracker_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.pose},instant_world_tracker_anchor_pose_set_from_camera_offset_raw:(e,t,r,i,a)=>{if(!this._instant_world_tracker_state_by_instance.get(e))throw Error("This object has been destroyed");this.serializer.sendMessage(7,s=>{s.type(e),s.float(t),s.float(r),s.float(i),s.instantTrackerTransformOrientation(a)})},zapcode_tracker_create:e=>{let t=this._latestId++;return this._zapcode_tracker_state_by_instance.set(t,{enabled:!0,target_loaded_version:-1,anchor_count:0,anchor_id:[],anchor_pose:[]}),this.serializer.sendMessage(42,r=>{r.type(t),r.type(e)}),t},zapcode_tracker_destroy:e=>{if(!this._zapcode_tracker_state_by_instance.get(e))throw Error("This object has been destroyed");this._zapcode_tracker_state_by_instance.delete(e),this.serializer.sendMessage(45,t=>{t.type(e)})},zapcode_tracker_target_load_from_memory:(e,t)=>{if(!this._zapcode_tracker_state_by_instance.get(e))throw Error("This object has been destroyed");this.serializer.sendMessage(44,r=>{r.type(e),r.dataWithLength(t)})},zapcode_tracker_target_loaded_version:e=>{let t=this._zapcode_tracker_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.target_loaded_version},zapcode_tracker_enabled:e=>{let t=this._zapcode_tracker_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.enabled},zapcode_tracker_enabled_set:(e,t)=>{let r=this._zapcode_tracker_state_by_instance.get(e);if(!r)throw Error("This object has been destroyed");this.serializer.sendMessage(43,r=>{r.type(e),r.bool(t)}),r.enabled=t},zapcode_tracker_anchor_count:e=>{let t=this._zapcode_tracker_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.anchor_count},zapcode_tracker_anchor_id:(e,t)=>{let r=this._zapcode_tracker_state_by_instance.get(e);if(!r)throw Error("This object has been destroyed");return r.anchor_id[t]},zapcode_tracker_anchor_pose_raw:(e,t)=>{let r=this._zapcode_tracker_state_by_instance.get(e);if(!r)throw Error("This object has been destroyed");return r.anchor_pose[t]},world_tracker_create:e=>{let t=this._latestId++,r={enabled:!0,session_number:0,horizontal_plane_detection_enabled:!0,vertical_plane_detection_enabled:!1,plane_anchor_count:0,plane_anchor_pose:[],plane_anchor_status:[],plane_anchor_polygon_version:[],plane_anchor_polygon_data:[],plane_anchor_polygon_data_size:[],plane_anchor_id:[],plane_anchor_orientation:[],world_anchor_status:0,world_anchor_pose:new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),world_anchor_id:"",ground_anchor_status:0,ground_anchor_pose:new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),ground_anchor_id:"",tracks_data_enabled:!1,tracks_data:new Float32Array([]),tracks_data_size:0,tracks_type_data:new Uint8Array([]),tracks_type_data_size:0,projections_data_enabled:!1,projections_data:new Float32Array([]),projections_data_size:0,quality:3};return this._world_tracker_state_by_instance.set(t,r),this.serializer.sendMessage(46,r=>{r.type(t),r.type(e)}),t},world_tracker_destroy:e=>{if(!this._world_tracker_state_by_instance.get(e))throw Error("This object has been destroyed");this._world_tracker_state_by_instance.delete(e),this.serializer.sendMessage(47,t=>{t.type(e)})},world_tracker_enabled:e=>{let t=this._world_tracker_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.enabled},world_tracker_enabled_set:(e,t)=>{let r=this._world_tracker_state_by_instance.get(e);if(!r)throw Error("This object has been destroyed");this.serializer.sendMessage(48,r=>{r.type(e),r.bool(t)}),r.enabled=t},world_tracker_session_number:e=>{let t=this._world_tracker_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.session_number},world_tracker_quality:e=>{let t=this._world_tracker_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.quality},world_tracker_horizontal_plane_detection_enabled:e=>{let t=this._world_tracker_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.horizontal_plane_detection_enabled},world_tracker_horizontal_plane_detection_enabled_set:(e,t)=>{let r=this._world_tracker_state_by_instance.get(e);if(!r)throw Error("This object has been destroyed");this.serializer.sendMessage(49,r=>{r.type(e),r.bool(t)}),r.horizontal_plane_detection_enabled=t},world_tracker_vertical_plane_detection_enabled:e=>{let t=this._world_tracker_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.vertical_plane_detection_enabled},world_tracker_vertical_plane_detection_enabled_set:(e,t)=>{let r=this._world_tracker_state_by_instance.get(e);if(!r)throw Error("This object has been destroyed");this.serializer.sendMessage(50,r=>{r.type(e),r.bool(t)}),r.vertical_plane_detection_enabled=t},world_tracker_plane_anchor_count:e=>{let t=this._world_tracker_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.plane_anchor_count},world_tracker_plane_anchor_id:(e,t)=>{let r=this._world_tracker_state_by_instance.get(e);if(!r)throw Error("This object has been destroyed");return r.plane_anchor_id[t]},world_tracker_plane_anchor_pose_raw:(e,t)=>{let r=this._world_tracker_state_by_instance.get(e);if(!r)throw Error("This object has been destroyed");return r.plane_anchor_pose[t]},world_tracker_plane_anchor_status:(e,t)=>{let r=this._world_tracker_state_by_instance.get(e);if(!r)throw Error("This object has been destroyed");return r.plane_anchor_status[t]},world_tracker_plane_anchor_polygon_data_size:(e,t)=>{let r=this._world_tracker_state_by_instance.get(e);if(!r)throw Error("This object has been destroyed");return r.plane_anchor_polygon_data_size[t]},world_tracker_plane_anchor_polygon_data:(e,t)=>{let r=this._world_tracker_state_by_instance.get(e);if(!r)throw Error("This object has been destroyed");return r.plane_anchor_polygon_data[t]},world_tracker_plane_anchor_polygon_version:(e,t)=>{let r=this._world_tracker_state_by_instance.get(e);if(!r)throw Error("This object has been destroyed");return r.plane_anchor_polygon_version[t]},world_tracker_plane_anchor_orientation:(e,t)=>{let r=this._world_tracker_state_by_instance.get(e);if(!r)throw Error("This object has been destroyed");return r.plane_anchor_orientation[t]},world_tracker_world_anchor_status:e=>{let t=this._world_tracker_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.world_anchor_status},world_tracker_world_anchor_id:e=>{let t=this._world_tracker_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.world_anchor_id},world_tracker_world_anchor_pose_raw:e=>{let t=this._world_tracker_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.world_anchor_pose},world_tracker_ground_anchor_id:e=>{let t=this._world_tracker_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.ground_anchor_id},world_tracker_ground_anchor_status:e=>{let t=this._world_tracker_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.ground_anchor_status},world_tracker_ground_anchor_pose_raw:e=>{let t=this._world_tracker_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.ground_anchor_pose},world_tracker_reset:e=>{if(!this._world_tracker_state_by_instance.get(e))throw Error("This object has been destroyed");this.serializer.sendMessage(51,t=>{t.type(e)})},world_tracker_tracks_data_enabled:e=>{let t=this._world_tracker_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.tracks_data_enabled},world_tracker_tracks_data_enabled_set:(e,t)=>{let r=this._world_tracker_state_by_instance.get(e);if(!r)throw Error("This object has been destroyed");this.serializer.sendMessage(52,r=>{r.type(e),r.bool(t)}),r.tracks_data_enabled=t},world_tracker_tracks_data_size:e=>{let t=this._world_tracker_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.tracks_data_size},world_tracker_tracks_data:e=>{let t=this._world_tracker_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.tracks_data},world_tracker_tracks_type_data_size:e=>{let t=this._world_tracker_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.tracks_type_data_size},world_tracker_tracks_type_data:e=>{let t=this._world_tracker_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.tracks_type_data},world_tracker_projections_data_enabled:e=>{let t=this._world_tracker_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.projections_data_enabled},world_tracker_projections_data_enabled_set:(e,t)=>{let r=this._world_tracker_state_by_instance.get(e);if(!r)throw Error("This object has been destroyed");this.serializer.sendMessage(53,r=>{r.type(e),r.bool(t)}),r.projections_data_enabled=t},world_tracker_projections_data_size:e=>{let t=this._world_tracker_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.projections_data_size},world_tracker_projections_data:e=>{let t=this._world_tracker_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.projections_data},custom_anchor_create:(e,t,r)=>{let i=this._latestId++,a={pose:new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),status:3,pose_version:0};return this._custom_anchor_state_by_instance.set(i,a),this.serializer.sendMessage(54,a=>{a.type(i),a.type(e),a.type(t),a.string(r)}),i},custom_anchor_destroy:e=>{if(!this._custom_anchor_state_by_instance.get(e))throw Error("This object has been destroyed");this._custom_anchor_state_by_instance.delete(e),this.serializer.sendMessage(55,t=>{t.type(e)})},custom_anchor_status:e=>{let t=this._custom_anchor_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.status},custom_anchor_pose_version:e=>{let t=this._custom_anchor_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.pose_version},custom_anchor_pose_raw:e=>{let t=this._custom_anchor_state_by_instance.get(e);if(!t)throw Error("This object has been destroyed");return t.pose},custom_anchor_pose_set_from_camera_offset_raw:(e,t,r,i,a)=>{if(!this._custom_anchor_state_by_instance.get(e))throw Error("This object has been destroyed");this.serializer.sendMessage(56,s=>{s.type(e),s.float(t),s.float(r),s.float(i),s.transformOrientation(a)})},custom_anchor_pose_set_from_anchor_offset:(e,t,r,i,a,s)=>{if(!this._custom_anchor_state_by_instance.get(e))throw Error("This object has been destroyed");this.serializer.sendMessage(57,n=>{n.type(e),n.string(t),n.float(r),n.float(i),n.float(a),n.transformOrientation(s)})},custom_anchor_pose_set:(e,t)=>{if(!this._custom_anchor_state_by_instance.get(e))throw Error("This object has been destroyed");this.serializer.sendMessage(58,r=>{r.type(e),r.matrix4x4(t)})},custom_anchor_pose_set_with_parent:(e,t,r)=>{if(!this._custom_anchor_state_by_instance.get(e))throw Error("This object has been destroyed");this.serializer.sendMessage(59,i=>{i.type(e),i.matrix4x4(t),i.string(r)})},d3_tracker_create:e=>{let t=this._latestId++;return this._d3_tracker_state_by_instance.set(t,{id:[],enabled:!0,count:0,qr:[],pose:[],type:[],dense:[],process_max_resolution:!1}),this.serializer.sendMessage(60,r=>{r.type(t),r.type(e)}),t},d3_tracker_destroy:e=>{if(!this._d3_tracker_state_by_instance.get(e))throw Error("This object has been destroyed");this._d3_tracker_state_by_instance.delete(e),this.serializer.sendMessage(61,t=>{t.type(e)})}}}processMessages(e){this.deserializer.setData(e),this.deserializer.forMessages((e,t)=>{switch(e){case 9:{let e=t.type(),r=this._pipeline_state_by_instance.get(e);if(!r)return;r.frame_number=t.int();break}case 6:{let e=t.type(),r=this._pipeline_state_by_instance.get(e);if(!r)return;r.camera_model=t.cameraModel();break}case 7:{let e=t.type(),r=this._pipeline_state_by_instance.get(e);if(!r)return;r.camera_data_width=t.int();break}case 8:{let e=t.type(),r=this._pipeline_state_by_instance.get(e);if(!r)return;r.camera_data_height=t.int();break}case 5:{let e=t.type(),r=this._pipeline_state_by_instance.get(e);if(!r)return;r.current_frame_user_data=t.int();break}case 13:{let e=t.type(),r=this._pipeline_state_by_instance.get(e);if(!r)return;r.camera_frame_camera_attitude=t.matrix4x4();break}case 14:{let e=t.type(),r=this._pipeline_state_by_instance.get(e);if(!r)return;r.camera_frame_device_attitude=t.matrix4x4();break}case 21:{let e=t.type(),r=this._image_tracker_state_by_instance.get(e);if(!r)return;r.target_loaded_version=t.int();break}case 1:{let e=t.type(),r=this._image_tracker_state_by_instance.get(e);if(!r)return;r.anchor_count=t.int();break}case 2:{let e=t.type(),r=this._image_tracker_state_by_instance.get(e);if(!r)return;let i=t.int();r.anchor_id[i]=t.string();break}case 3:{let e=t.type(),r=this._image_tracker_state_by_instance.get(e);if(!r)return;let i=t.int();r.anchor_pose[i]=t.matrix4x4();break}case 20:{let e=t.type(),r=this._face_tracker_state_by_instance.get(e);if(!r)return;r.model_loaded=t.int();break}case 15:{let e=t.type(),r=this._face_tracker_state_by_instance.get(e);if(!r)return;r.anchor_count=t.int();break}case 16:{let e=t.type(),r=this._face_tracker_state_by_instance.get(e);if(!r)return;let i=t.int();r.anchor_id[i]=t.string();break}case 17:{let e=t.type(),r=this._face_tracker_state_by_instance.get(e);if(!r)return;let i=t.int();r.anchor_pose[i]=t.matrix4x4();break}case 18:{let e=t.type(),r=this._face_tracker_state_by_instance.get(e);if(!r)return;let i=t.int();r.anchor_identity_coefficients[i]=t.identityCoefficients();break}case 19:{let e=t.type(),r=this._face_tracker_state_by_instance.get(e);if(!r)return;let i=t.int();r.anchor_expression_coefficients[i]=t.expressionCoefficients();break}case 10:{let e=t.type(),r=this._barcode_finder_state_by_instance.get(e);if(!r)return;r.number_found=t.int();break}case 11:{let e=t.type(),r=this._barcode_finder_state_by_instance.get(e);if(!r)return;let i=t.int();r.found_text[i]=t.string();break}case 12:{let e=t.type(),r=this._barcode_finder_state_by_instance.get(e);if(!r)return;let i=t.int();r.found_format[i]=t.barcodeFormat();break}case 4:{let e=t.type(),r=this._instant_world_tracker_state_by_instance.get(e);if(!r)return;r.pose=t.matrix4x4();break}case 26:{let e=t.type(),r=this._zapcode_tracker_state_by_instance.get(e);if(!r)return;r.target_loaded_version=t.int();break}case 23:{let e=t.type(),r=this._zapcode_tracker_state_by_instance.get(e);if(!r)return;r.anchor_count=t.int();break}case 24:{let e=t.type(),r=this._zapcode_tracker_state_by_instance.get(e);if(!r)return;let i=t.int();r.anchor_id[i]=t.string();break}case 25:{let e=t.type(),r=this._zapcode_tracker_state_by_instance.get(e);if(!r)return;let i=t.int();r.anchor_pose[i]=t.matrix4x4();break}case 27:{let e=t.type(),r=this._world_tracker_state_by_instance.get(e);if(!r)return;r.session_number=t.int();break}case 43:{let e=t.type(),r=this._world_tracker_state_by_instance.get(e);if(!r)return;r.quality=t.int();break}case 28:{let e=t.type(),r=this._world_tracker_state_by_instance.get(e);if(!r)return;r.plane_anchor_count=t.int();break}case 36:{let e=t.type(),r=this._world_tracker_state_by_instance.get(e);if(!r)return;let i=t.int();r.plane_anchor_id[i]=t.string();break}case 29:{let e=t.type(),r=this._world_tracker_state_by_instance.get(e);if(!r)return;let i=t.int();r.plane_anchor_pose[i]=t.matrix4x4();break}case 31:{let e=t.type(),r=this._world_tracker_state_by_instance.get(e);if(!r)return;let i=t.int();r.plane_anchor_status[i]=t.anchorStatus();break}case 32:{let e=t.type(),r=this._world_tracker_state_by_instance.get(e);if(!r)return;let i=t.int();r.plane_anchor_polygon_data_size[i]=t.int();break}case 33:{let e=t.type(),r=this._world_tracker_state_by_instance.get(e);if(!r)return;let i=t.int();r.plane_anchor_polygon_data[i]=t.floatArray();break}case 34:{let e=t.type(),r=this._world_tracker_state_by_instance.get(e);if(!r)return;let i=t.int();r.plane_anchor_polygon_version[i]=t.int();break}case 35:{let e=t.type(),r=this._world_tracker_state_by_instance.get(e);if(!r)return;let i=t.int();r.plane_anchor_orientation[i]=t.planeOrientation();break}case 39:{let e=t.type(),r=this._world_tracker_state_by_instance.get(e);if(!r)return;r.world_anchor_status=t.anchorStatus();break}case 38:{let e=t.type(),r=this._world_tracker_state_by_instance.get(e);if(!r)return;r.world_anchor_id=t.string();break}case 37:{let e=t.type(),r=this._world_tracker_state_by_instance.get(e);if(!r)return;r.world_anchor_pose=t.matrix4x4();break}case 41:{let e=t.type(),r=this._world_tracker_state_by_instance.get(e);if(!r)return;r.ground_anchor_id=t.string();break}case 42:{let e=t.type(),r=this._world_tracker_state_by_instance.get(e);if(!r)return;r.ground_anchor_status=t.anchorStatus();break}case 40:{let e=t.type(),r=this._world_tracker_state_by_instance.get(e);if(!r)return;r.ground_anchor_pose=t.matrix4x4();break}case 46:{let e=t.type(),r=this._world_tracker_state_by_instance.get(e);if(!r)return;r.tracks_data_size=t.int();break}case 45:{let e=t.type(),r=this._world_tracker_state_by_instance.get(e);if(!r)return;r.tracks_data=t.floatArray();break}case 48:{let e=t.type(),r=this._world_tracker_state_by_instance.get(e);if(!r)return;r.tracks_type_data_size=t.int();break}case 47:{let e=t.type(),r=this._world_tracker_state_by_instance.get(e);if(!r)return;r.tracks_type_data=t.ucharArray();break}case 51:{let e=t.type(),r=this._world_tracker_state_by_instance.get(e);if(!r)return;r.projections_data_size=t.int();break}case 50:{let e=t.type(),r=this._world_tracker_state_by_instance.get(e);if(!r)return;r.projections_data=t.floatArray();break}case 53:{let e=t.type(),r=this._custom_anchor_state_by_instance.get(e);if(!r)return;r.status=t.anchorStatus();break}case 54:{let e=t.type(),r=this._custom_anchor_state_by_instance.get(e);if(!r)return;r.pose_version=t.int();break}case 52:{let e=t.type(),r=this._custom_anchor_state_by_instance.get(e);if(!r)return;r.pose=t.matrix4x4()}}})}}var D=r(7896);let U={},P=`
#ifndef GL_ES
#define highp
#define mediump
#define lowp
#endif

uniform mat4 projMatrix;
uniform mat4 cameraMatrix;
uniform mat4 modelViewMatrix;
attribute vec4 position;
attribute vec2 textureCoord;

varying highp vec2 vTextureCoord;

void main()
{
    gl_Position = projMatrix * cameraMatrix * modelViewMatrix * position;
    vTextureCoord = textureCoord;
}`,L=`
#define highp mediump
#ifdef GL_ES
    // define default precision for float, vec, mat.
    precision highp float;
#else
#define highp
#define mediump
#define lowp
#endif

varying highp vec2 vTextureCoord;
uniform sampler2D skinSampler;

void main()
{
    gl_FragColor = texture2D(skinSampler, vTextureCoord);
}`;var z=r(6637),B=r(1142);function O(){var e=new B.tb(3);return B.tb!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function N(e,t,r){var i=t[0],a=t[1],s=t[2],n=r[3]*i+r[7]*a+r[11]*s+r[15];return n=n||1,e[0]=(r[0]*i+r[4]*a+r[8]*s+r[12])/n,e[1]=(r[1]*i+r[5]*a+r[9]*s+r[13])/n,e[2]=(r[2]*i+r[6]*a+r[10]*s+r[14])/n,e}O();var V=r(9682);function G(e,t,r,i,a,s=.01,n=100){let o=z.vt();z.$h(o,s*(-.5-e[2])/e[0],s*(t-.5-e[2])/e[0],s*(r-.5-e[3])/e[1],s*(-.5-e[3])/e[1],s,n),o[4]*=-1,o[5]*=-1,o[6]*=-1,o[7]*=-1;let l=z.vt();z.CV(l,[.5*t,.5*r,1]),z.lw(o,l,o),z.$0(l,W(!1)*Math.PI/180,[0,0,1]),z.lw(o,l,o);let _=O();_[0]=t,_[1]=r,_[2]=0,N(_,_,l);let c=Math.abs(_[0]),d=Math.abs(_[1]),h=1;return h=c/i>d/a?a/d:i/c,z.CV(l,[h,h,1]),z.lw(o,l,o),z.CV(l,[2/i,2/a,1]),z.lw(o,l,o),z.$0(l,-(W(!1)*Math.PI/180),[0,0,1]),z.lw(o,o,l),o}function W(e){if(window.screen.orientation&&!V.M.forceWindowOrientation)switch(window.screen.orientation.type){case"portrait-primary":return e?90:270;case"landscape-secondary":return 180;case"portrait-secondary":return e?270:90}else if(void 0!==window.orientation)switch(window.orientation){case 0:return e?90:270;case 90:break;case 180:return e?270:90;case -90:return 180}return 0}var q=r(1937),H=function(e,t,r,i){return new(r||(r=Promise))(function(a,s){function n(e){try{l(i.next(e))}catch(e){s(e)}}function o(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(n,o)}l((i=i.apply(e,t||[])).next())})};let j=new q.L,Y=parseInt(null!=(b=new URLSearchParams(window.location.search).get("_zrecorddata"))?b:"0"),X=H(void 0,void 0,void 0,function*(){let e=yield fetch(new r.U(r(6391)).toString());return yield WebAssembly.compileStreaming(e)});var Z=r(2401);!function(e){e[e.PermissionTitle=0]="PermissionTitle",e[e.PermissionDescription=1]="PermissionDescription",e[e.PermissionButton=2]="PermissionButton"}(y||(y={}));let[$,K]=function(e){let[t,r]=e.toLowerCase().split("-");return[t,r||""]}(navigator.language);function Q(e){switch($){case"es":switch(e){case y.PermissionTitle:return"Ya casi...";case y.PermissionDescription:return"Para brindar esta experiencia de realidad aumentada, necesitamos acceso a la c\xe1mara y los sensores de movimiento de su dispositivo.";case y.PermissionButton:return"Permitir acceso"}break;case"de":switch(e){case y.PermissionTitle:return"Fast am Ziel..";case y.PermissionDescription:return"Um dir dieses Augmented Reality Erlebnis zu liefern, brauchen wir Zugriff auf die Kamera und Bewegungssensoren deines Ger\xe4tes.";case y.PermissionButton:return"Gew\xe4hre Zugriff"}break;case"pt":switch(e){case y.PermissionTitle:return"Est\xe1 quase!";case y.PermissionDescription:return"Esta experi\xeancia de realidade aumentada precisa de acesso \xe0 c\xe2mera e aos sensores de movimento deste dispositivo.";case y.PermissionButton:return"Permitir acesso"}}switch(e){case y.PermissionTitle:return"Almost there...";case y.PermissionDescription:return"In order to provide this immersive experience, we need access to your device's camera and motion sensors.";case y.PermissionButton:return"Grant Access"}return""}let J=z.vt();class ee{constructor(e){this._gl=e}dispose(){this._vbo&&this._gl.deleteBuffer(this._vbo),this._vbo=void 0,this._shader&&this._gl.deleteProgram(this._shader.prog),this._shader=void 0}_generate(e,t){if(this._vbo)return this._vbo;if(this._vbo||(this._vbo=e.createBuffer()),!this._vbo)throw Error("Unable to create buffer object");let r=new Float32Array([-1,-1,0,0,0,-1,1,0,0,1,1,-1,0,1,0,1,-1,0,1,0,-1,1,0,0,1,1,1,0,1,1]);return e.bindBuffer(e.ARRAY_BUFFER,this._vbo),e.bufferData(e.ARRAY_BUFFER,new Float32Array(r),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),this._vbo}drawCameraFrame(e,t,r,i){if(!r.texture)return;let a=this._gl,s=a.isEnabled(a.DEPTH_TEST),n=a.isEnabled(a.SCISSOR_TEST),o=a.isEnabled(a.CULL_FACE),l=a.isEnabled(a.STENCIL_TEST),_=a.isEnabled(a.BLEND),c=a.getParameter(a.TEXTURE_BINDING_2D),d=a.getParameter(a.FRAMEBUFFER_BINDING),h=a.getParameter(a.CURRENT_PROGRAM),u=a.getParameter(a.ACTIVE_TEXTURE);a.disable(a.DEPTH_TEST),a.disable(a.SCISSOR_TEST),a.disable(a.CULL_FACE),a.disable(a.STENCIL_TEST),a.disable(a.BLEND);let m=this._getCameraShader(a),p=this._generate(a,r);a.activeTexture(a.TEXTURE0),a.useProgram(m.prog),a.uniformMatrix4fv(m.unif_skinTexTransform,!1,ei(r.dataWidth,r.dataHeight,e,t,r.uvTransform||J,i)),a.uniform1i(m.unif_skinSampler,0),a.bindTexture(a.TEXTURE_2D,r.texture),a.bindBuffer(a.ARRAY_BUFFER,p),a.vertexAttribPointer(m.attr_position,3,a.FLOAT,!1,20,0),a.enableVertexAttribArray(m.attr_position),a.vertexAttribPointer(m.attr_texCoord,2,a.FLOAT,!1,20,12),a.enableVertexAttribArray(m.attr_texCoord),a.drawArrays(a.TRIANGLES,0,6),a.disableVertexAttribArray(m.attr_position),a.disableVertexAttribArray(m.attr_texCoord),a.bindFramebuffer(a.FRAMEBUFFER,d),a.useProgram(h),a.bindTexture(a.TEXTURE_2D,c),a.activeTexture(u),_&&a.enable(a.BLEND),o&&a.enable(a.CULL_FACE),s&&a.enable(a.DEPTH_TEST),n&&a.enable(a.SCISSOR_TEST),l&&a.enable(a.STENCIL_TEST)}_getCameraShader(e){if(this._shader)return this._shader;let t=e.createProgram();if(!t)throw Error("Unable to create program");let r=(0,D.R)(e,e.VERTEX_SHADER,et),i=(0,D.R)(e,e.FRAGMENT_SHADER,er);e.attachShader(t,r),e.attachShader(t,i),(0,D.i)(e,t);let a=e.getUniformLocation(t,"skinTexTransform");if(!a)throw Error("Unable to get uniform location skinTexTransform");let s=e.getUniformLocation(t,"skinSampler");if(!s)throw Error("Unable to get uniform location skinSampler");return this._shader={prog:t,unif_skinTexTransform:a,unif_skinSampler:s,attr_position:e.getAttribLocation(t,"position"),attr_texCoord:e.getAttribLocation(t,"texCoord")},this._shader}}let et=`
#ifndef GL_ES
#define highp
#define mediump
#define lowp
#endif

attribute vec4 position;
attribute vec4 texCoord;
varying vec4 skinTexVarying;
uniform mat4 skinTexTransform;

void main()
{
    gl_Position = position;
    skinTexVarying = skinTexTransform * texCoord;
}`,er=`
#define highp mediump
#ifdef GL_ES
    // define default precision for float, vec, mat.
    precision highp float;
#else
#define highp
#define mediump
#define lowp
#endif

varying vec4 skinTexVarying;
uniform lowp sampler2D skinSampler;

void main()
{
    gl_FragColor = texture2DProj(skinSampler, skinTexVarying);
}`;function ei(e,t,r,i,a,s){let n=z.vt(),o=z.vt();z.kN(o,[-.5,-.5,0]),z.lw(n,o,n),s&&(z.CV(o,[-1,1,1]),z.lw(n,o,n)),z.$0(o,-1*function(){if(window.screen.orientation&&!V.M.forceWindowOrientation)switch(window.screen.orientation.type){case"portrait-primary":return 270;case"landscape-secondary":return 180;case"portrait-secondary":return 90}else if(void 0!==window.orientation)switch(window.orientation){case 0:return 270;case 90:break;case 180:return 90;case -90:return 180}return 0}()*Math.PI/180,[0,0,1]),z.lw(n,o,n);let l=O();l[0]=r,l[1]=i,l[2]=0,N(l,l,o);let _=Math.abs(l[0]),c=Math.abs(l[1]);z.CV(o,[1,-1,1]),z.lw(n,o,n);let d=_/c,h=e/t;return d>h?z.CV(o,[1,h/d,1]):z.CV(o,[d/h,1,1]),z.lw(n,o,n),z.kN(o,[.5,.5,0]),z.lw(n,o,n),z.lw(n,a,n),n}class ea{constructor(e){this._gl=e}dispose(){this._vbo&&this._gl.deleteBuffer(this._vbo),this._normalbo&&this._gl.deleteBuffer(this._normalbo),this._ibo&&this._gl.deleteBuffer(this._ibo),this._shader&&this._gl.deleteProgram(this._shader.prog),this._vbo=void 0,this._normalbo=void 0,this._ibo=void 0,this._shader=void 0}_generateIBO(e,t){if(this._ibo&&this._lastIndices===e)return this._ibo;if(this._lastIndices=e,this._ibo||(this._ibo=t.createBuffer()),!this._ibo)throw Error("Unable to create buffer object");return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._ibo),t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),this._ibo}_generateVBO(e,t){if(this._vbo||(this._vbo=t.createBuffer()),!this._vbo)throw Error("Unable to create buffer object");return t.bindBuffer(t.ARRAY_BUFFER,this._vbo),t.bufferData(t.ARRAY_BUFFER,e,t.STREAM_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),this._vbo}_generateNormalBO(e,t){if(this._normalbo||(this._normalbo=t.createBuffer()),!this._normalbo)throw Error("Unable to create buffer object");return t.bindBuffer(t.ARRAY_BUFFER,this._normalbo),t.bufferData(t.ARRAY_BUFFER,e,t.STREAM_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),this._normalbo}drawFace(e,t){let r=this._gl,i=this._getShader(r),a=this._generateVBO(t.getVertices(),r),s=this._generateNormalBO(t.getNormals(),r),n=this._generateIBO(t.getIndices(),r);r.enable(r.DEPTH_TEST),r.enable(r.CULL_FACE),r.useProgram(i.prog),r.uniformMatrix4fv(i.unif_matrix,!1,e),r.bindBuffer(r.ARRAY_BUFFER,a),r.vertexAttribPointer(i.attr_position,3,r.FLOAT,!1,12,0),r.enableVertexAttribArray(i.attr_position),r.bindBuffer(r.ARRAY_BUFFER,s),r.vertexAttribPointer(i.attr_normal,3,r.FLOAT,!1,12,0),r.enableVertexAttribArray(i.attr_normal),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,n),r.drawElements(r.TRIANGLES,t.getIndices().length,r.UNSIGNED_SHORT,0),r.disableVertexAttribArray(i.attr_position),r.disableVertexAttribArray(i.attr_normal),r.bindBuffer(r.ARRAY_BUFFER,null),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,null)}_getShader(e){if(this._shader)return this._shader;let t=e.createProgram();if(!t)throw Error("Unable to create program");let r=(0,D.R)(e,e.VERTEX_SHADER,es),i=(0,D.R)(e,e.FRAGMENT_SHADER,en);e.attachShader(t,r),e.attachShader(t,i),(0,D.i)(e,t);let a=e.getUniformLocation(t,"matrix");if(!a)throw Error("Unable to get uniform location mattrix");return this._shader={prog:t,unif_matrix:a,attr_position:e.getAttribLocation(t,"position"),attr_normal:e.getAttribLocation(t,"normal")},this._shader}}let es=`
#ifndef GL_ES
#define highp
#define mediump
#define lowp
#endif

uniform mat4 matrix;
attribute vec4 position;
attribute vec3 normal;
varying highp vec3 vnormal;

void main()
{
    gl_Position = matrix * position;
    vnormal = normal;
}`,en=`
#define highp mediump
#ifdef GL_ES
    // define default precision for float, vec, mat.
    precision highp float;
#else
#define highp
#define mediump
#define lowp
#endif

varying vec4 skinTexVarying;
varying highp vec3 vnormal;
uniform lowp sampler2D skinSampler;

void main()
{
    vec3 normal2 = 0.5 * vnormal + 0.5;
    gl_FragColor = vec4(normal2.x , normal2.y, normal2.z, 1.0);
}`;class eo{constructor(e){this._gl=e}dispose(){this._vbo&&this._gl.deleteBuffer(this._vbo),this._uvbo&&this._gl.deleteBuffer(this._uvbo),this._ibo&&this._gl.deleteBuffer(this._ibo),this._shader&&this._gl.deleteProgram(this._shader.prog),this._vbo=void 0,this._uvbo=void 0,this._ibo=void 0,this._shader=void 0}_generateIBO(e,t){if(this._ibo&&this._lastIndices===e)return this._ibo;if(this._lastIndices=e,this._ibo||(this._ibo=t.createBuffer()),!this._ibo)throw Error("Unable to create buffer object");return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._ibo),t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),this._ibo}_generateVBO(e,t){if(this._vbo||(this._vbo=t.createBuffer()),!this._vbo)throw Error("Unable to create buffer object");return t.bindBuffer(t.ARRAY_BUFFER,this._vbo),t.bufferData(t.ARRAY_BUFFER,e,t.STREAM_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),this._vbo}_generateUVBO(e,t){if(this._uvbo||(this._uvbo=t.createBuffer()),!this._uvbo)throw Error("Unable to create buffer object");return t.bindBuffer(t.ARRAY_BUFFER,this._uvbo),t.bufferData(t.ARRAY_BUFFER,e,t.STREAM_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),this._uvbo}drawFace(e,t,r,i,a,s){let n=this._gl,o=this._getShader(n),l=this._generateVBO(t,n),_=this._generateUVBO(i,n),c=this._generateIBO(a,n);n.enable(n.DEPTH_TEST),n.enable(n.CULL_FACE),n.useProgram(o.prog),n.uniformMatrix4fv(o.unif_matrix,!1,e),n.uniformMatrix4fv(o.unif_uvmatrix,!1,r),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,s),n.uniform1i(o.unif_sampler,0),n.bindBuffer(n.ARRAY_BUFFER,l),n.vertexAttribPointer(o.attr_position,3,n.FLOAT,!1,12,0),n.enableVertexAttribArray(o.attr_position),n.bindBuffer(n.ARRAY_BUFFER,_),n.vertexAttribPointer(o.attr_uv,3,n.FLOAT,!1,12,0),n.enableVertexAttribArray(o.attr_uv),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,c),n.drawElements(n.TRIANGLES,6912,n.UNSIGNED_SHORT,0),n.disableVertexAttribArray(o.attr_position),n.disableVertexAttribArray(o.attr_uv),n.bindBuffer(n.ARRAY_BUFFER,null),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null)}_getShader(e){if(this._shader)return this._shader;let t=e.createProgram();if(!t)throw Error("Unable to create program");let r=(0,D.R)(e,e.VERTEX_SHADER,el),i=(0,D.R)(e,e.FRAGMENT_SHADER,e_);e.attachShader(t,r),e.attachShader(t,i),(0,D.i)(e,t);let a=e.getUniformLocation(t,"matrix");if(!a)throw Error("Unable to get uniform location matrix");let s=e.getUniformLocation(t,"uvmatrix");if(!s)throw Error("Unable to get uniform location matrix");let n=e.getUniformLocation(t,"uSampler");if(!n)throw Error("Unable to get uniform location sampler");return this._shader={prog:t,unif_matrix:a,unif_sampler:n,unif_uvmatrix:s,attr_position:e.getAttribLocation(t,"position"),attr_uv:e.getAttribLocation(t,"uv"),attr_texturecoord:e.getAttribLocation(t,"aTextureCoord")},this._shader}}let el=`
#ifndef GL_ES
#define highp
#define mediump
#define lowp
#endif

uniform mat4 matrix;
uniform mat4 uvmatrix;
attribute vec4 position;
attribute vec3 normal;
attribute vec3 uv;

// varying highp vec3 vnormal;

varying highp vec2 vTextureCoord;
varying highp float vAlpha;

void main()
{
    gl_Position = matrix * position;
    vec4 ret = uvmatrix * vec4(uv.x, uv.y, uv.z, 1.0);
    ret.x /= ret.w * 2.0;
    ret.y /= ret.w * 2.0;
    ret.x += 0.5;
    ret.y += 0.0;
    vAlpha = 1.0;
    vTextureCoord = ret.xy;
}`,e_=`
#define highp mediump
#ifdef GL_ES
    // define default precision for float, vec, mat.
    precision highp float;
#else
#define highp
#define mediump
#define lowp
#endif

varying highp vec2 vTextureCoord;
varying highp vec3 vnormal;
varying highp float vAlpha;
uniform lowp sampler2D uSampler;

void main()
{
    // vec3 normal2 = 0.5 * vnormal + 0.5;
    vec4 p = texture2D(uSampler, vTextureCoord);
    p.a = vAlpha;
    gl_FragColor = p; // vec4(normal2.x , normal2.y, normal2.z, 1.0);
}`;var ec=r(3979);let ed=I.f_.LOG_LEVEL_ERROR;function eh(...e){ed>=I.f_.LOG_LEVEL_VERBOSE&&console.log("[Zappar] INFO",...e)}function eu(...e){ed>=I.f_.LOG_LEVEL_ERROR&&console.error("[Zappar] ERROR",...e)}function em(...e){ed>=I.f_.LOG_LEVEL_VERBOSE&&console.log("[Zappar] WARN",...e)}!function(e){e[e.CAMERA_FRAME=0]="CAMERA_FRAME",e[e.ACCELEROMETER=1]="ACCELEROMETER",e[e.ROTATION_RATE=2]="ROTATION_RATE",e[e.ATTITUDE=3]="ATTITUDE",e[e.ATTITUDE_MATRIX=4]="ATTITUDE_MATRIX",e[e.ACCELEROMETER_WO_GRAVITY_INT=5]="ACCELEROMETER_WO_GRAVITY_INT",e[e.ACCELEROMETER_W_GRAVITY_INT=6]="ACCELEROMETER_W_GRAVITY_INT",e[e.ROTATION_RATE_INT=7]="ROTATION_RATE_INT",e[e.ATTITUDE_INT=8]="ATTITUDE_INT"}(w||(w={}));class ep{constructor(e){this._insertionByte=0,this._numberPackets=0,this._started=!1,this._hasLoggedUnsuppored=!1,this._data=new ArrayBuffer(this._estimatedSize(e,320,240)),this._dataView=new DataView(this._data),this._dataUint8=new Uint8Array(this._data),this._dataFloat32=new Float32Array(this._data)}_estimatedSize(e,t,r){return ep.headerSizeBytes+(ep.psbPacketType+ep.cameraPacketSizeBytes+t*r)*e}start(){this._started=!0,this._insertionByte=0,this._numberPackets=0,this._growArrayBuffer(ep.headerSizeBytes);let e=new TextEncoder().encode("UAR1");this._dataUint8.set(e),this._dataView.setUint32(4,0,!0),this._insertionByte+=8}stop(){this._started=!1;let e=this._data.slice(0,this._insertionByte);this._data=e,this._dataUint8=new Uint8Array(this._data),this._dataFloat32=new Float32Array(this._data),this._dataView=new DataView(this._data)}data(){return this._dataUint8}appendCameraFrame(e){if(!this._started)return;if(!e.data){if(this._hasLoggedUnsuppored)return;this._hasLoggedUnsuppored=!0,eu("Unable to record frames from this camera source");return}if(e.data.byteLength!==e.dataWidth*e.dataHeight)return void eu("Unable to record frame to sequence: greyscale array doesn't match dimensions");let t=ep.psbPacketType+ep.cameraPacketSizeBytes+e.dataWidth*e.dataHeight;this._growArrayBuffer(t),this._dataView.setUint32(this._insertionByte,w.CAMERA_FRAME,!0),this._insertionByte+=ep.psbPacketType,this._dataView.setUint32(this._insertionByte,e.dataWidth,!0),this._insertionByte+=ep.psbCameraFrameWidth,this._dataView.setUint32(this._insertionByte,e.dataHeight,!0),this._insertionByte+=ep.psbCameraFrameHeight,this._dataFloat32.set(e.cameraToDevice,this._insertionByte/4),this._insertionByte+=ep.psbCameraToDeviceTransform,this._dataFloat32.set(e.cameraModel,this._insertionByte/4),this._insertionByte+=ep.psbCameraModel,this._dataView.setUint32(this._insertionByte,+!!e.userFacing,!0),this._insertionByte+=ep.psbFlags,this._dataUint8.set(new Uint8Array(e.data),this._insertionByte),this._insertionByte+=e.data.byteLength,this._numberPackets++,this._dataView.setUint32(4,this._numberPackets,!0)}appendAccelerometer(e,t,r,i){this._appendTimestampedVec3(w.ACCELEROMETER,e,t,r,i)}appendRotationRate(e,t,r,i){this._appendTimestampedVec3(w.ROTATION_RATE,e,t,r,i)}appendAttitude(e,t,r,i){this._appendTimestampedVec3(w.ATTITUDE,e,t,r,i)}appendAccelerometerWithoutGravityInt(e,t,r,i,a){this._appendSensorWithInterval(w.ACCELEROMETER_WO_GRAVITY_INT,e,t,r,i,a)}appendAccelerometerWithGravityInt(e,t,r,i,a){this._appendSensorWithInterval(w.ACCELEROMETER_W_GRAVITY_INT,e,t,r,i,a)}appendRotationRateInt(e,t,r,i,a){this._appendSensorWithInterval(w.ROTATION_RATE_INT,e,t,r,i,a)}appendAttitudeInt(e,t,r,i,a){this._appendSensorWithInterval(w.ATTITUDE_INT,e,t,r,i,a)}_appendSensorWithInterval(e,t,r,i,a,s){if(!this._started)return;let n=ep.psbPacketType+ep.sensorWithIntervalPacketSizeBytes;this._growArrayBuffer(n),this._dataView.setUint32(this._insertionByte,e,!0),this._insertionByte+=ep.psbPacketType,this._dataView.setUint32(this._insertionByte,t,!0),this._insertionByte+=4,this._dataView.setUint32(this._insertionByte,r,!0),this._insertionByte+=4,this._dataView.setFloat32(this._insertionByte,i,!0),this._insertionByte+=4,this._dataView.setFloat32(this._insertionByte,a,!0),this._insertionByte+=4,this._dataView.setFloat32(this._insertionByte,s,!0),this._insertionByte+=4,this._numberPackets++,this._dataView.setUint32(4,this._numberPackets,!0)}_appendTimestampedVec3(e,t,r,i,a){if(!this._started)return;let s=ep.psbPacketType+ep.accelerometerPacketSizeBytes;this._growArrayBuffer(s),this._dataView.setUint32(this._insertionByte,e,!0),this._insertionByte+=ep.psbPacketType,this._dataView.setUint32(this._insertionByte,t,!0),this._insertionByte+=4,this._dataView.setFloat32(this._insertionByte,r,!0),this._insertionByte+=4,this._dataView.setFloat32(this._insertionByte,i,!0),this._insertionByte+=4,this._dataView.setFloat32(this._insertionByte,a,!0),this._insertionByte+=4,this._numberPackets++,this._dataView.setUint32(4,this._numberPackets,!0)}appendAttitudeMatrix(e){if(!this._started)return;let t=ep.psbPacketType+ep.attitudeMatrixPacketSizeBytes;this._growArrayBuffer(t),this._dataView.setUint32(this._insertionByte,w.ATTITUDE_MATRIX,!0),this._insertionByte+=ep.psbPacketType,this._dataFloat32.set(e,this._insertionByte/4),this._insertionByte+=ep.attitudeMatrixPacketSizeBytes,this._numberPackets++,this._dataView.setUint32(4,this._numberPackets,!0)}_growArrayBuffer(e){for(;this._insertionByte+e>this._data.byteLength;){let e=new ArrayBuffer(Math.max(2*this._data.byteLength,this._estimatedSize(50,320,240))),t=new Uint8Array(e);t.set(this._dataUint8),this._data=e,this._dataUint8=t,this._dataFloat32=new Float32Array(this._data),this._dataView=new DataView(this._data)}}}ep.headerSizeBytes=8,ep.psbPacketType=4,ep.psbCameraFrameWidth=4,ep.psbCameraFrameHeight=4,ep.psbFlags=4,ep.psbCameraToDeviceTransform=64,ep.psbCameraModel=24,ep.cameraPacketSizeBytes=ep.psbCameraFrameWidth+ep.psbCameraFrameHeight+ep.psbCameraToDeviceTransform+ep.psbCameraModel+ep.psbFlags,ep.accelerometerPacketSizeBytes=16,ep.sensorWithIntervalPacketSizeBytes=20,ep.rotationRatePacketSizeBytes=16,ep.attitudePacketSizeBytes=16,ep.attitudeMatrixPacketSizeBytes=64;class ef{constructor(e){this._data=e,this.dataByPacket=new Map,this.dataByCameraFrame=new Map,this.numberPackets=0,this.numberCameraFrames=0,this.numberAccelerometerPackets=0,this.numberRotationRatePackets=0,this.numberAttitudePackets=0,this.numberAttitudeMatrixPackets=0;let t=new TextDecoder,r="";try{r=t.decode(this._data.slice(0,4))}catch(e){throw Error("Unable to decode header - perhaps this isn't a sequence file?")}if("UAR1"!==r)throw Error(`Invalid - perhaps this isn't a sequence file: ${r}`);let i=0,a=new DataView(this._data);this.numberPackets=a.getUint32(4,!0),i+=ep.headerSizeBytes;for(let e=0;e<this.numberPackets;e++){let t=a.getUint32(i,!0);switch(i+=ep.psbPacketType,t){case w.CAMERA_FRAME:{let t=a.getUint32(i,!0);i+=ep.psbCameraFrameWidth;let r=a.getUint32(i,!0);i+=ep.psbCameraFrameHeight;let s=new Float32Array(this._data,i,ep.psbCameraToDeviceTransform/4);i+=ep.psbCameraToDeviceTransform;let n=new Float32Array(this._data,i,ep.psbCameraModel/4);i+=ep.psbCameraModel;let o=a.getUint32(i,!0);i+=ep.psbFlags;let l=1===o,_=new Uint8Array(this._data,i,t*r);i+=t*r;let c={type:w.CAMERA_FRAME,width:t,height:r,cameraToDevice:s,cameraModel:n,userFacing:l,greyscale:_};this.dataByPacket.set(e,c),this.dataByCameraFrame.set(this.numberCameraFrames,c),this.numberCameraFrames++;break}case w.ACCELEROMETER:{let t=a.getUint32(i,!0);i+=4;let r=a.getFloat32(i,!0);i+=4;let s=a.getFloat32(i,!0);i+=4;let n=a.getFloat32(i,!0);i+=4,this.dataByPacket.set(e,{type:w.ACCELEROMETER,t,x:r,y:s,z:n}),this.numberAccelerometerPackets++;break}case w.ROTATION_RATE:{let t=a.getUint32(i,!0);i+=4;let r=a.getFloat32(i,!0);i+=4;let s=a.getFloat32(i,!0);i+=4;let n=a.getFloat32(i,!0);i+=4,this.dataByPacket.set(e,{type:w.ROTATION_RATE,t,x:r,y:s,z:n}),this.numberRotationRatePackets++;break}case w.ATTITUDE:{let t=a.getUint32(i,!0);i+=4;let r=a.getFloat32(i,!0);i+=4;let s=a.getFloat32(i,!0);i+=4;let n=a.getFloat32(i,!0);i+=4,this.dataByPacket.set(e,{type:w.ATTITUDE,t,x:r,y:s,z:n}),this.numberAttitudePackets++;break}case w.ATTITUDE_MATRIX:{let t=new Float32Array(this._data,i,ep.attitudeMatrixPacketSizeBytes/4);i+=ep.attitudeMatrixPacketSizeBytes,this.dataByPacket.set(e,{type:w.ATTITUDE_MATRIX,attitude:t}),this.numberAttitudeMatrixPackets++;break}case w.ACCELEROMETER_WO_GRAVITY_INT:case w.ACCELEROMETER_W_GRAVITY_INT:case w.ATTITUDE_INT:case w.ROTATION_RATE_INT:{let r=a.getUint32(i,!0);i+=4;let s=a.getUint32(i,!0);i+=4;let n=a.getFloat32(i,!0);i+=4;let o=a.getFloat32(i,!0);i+=4;let l=a.getFloat32(i,!0);i+=4,this.dataByPacket.set(e,{type:t,t:r,int:s,x:n,y:o,z:l}),this.numberAccelerometerPackets++}}}}}class eg{}var ev=r(2350);let eb=1,ey=new Map;class ew extends eg{constructor(e,t){super(),this._video=e,this._pipeline=t,this._isPaused=!0,this._hadFrames=!1,this._isUserFacing=!1,this._cameraToScreenRotation=0,this._isUploadFrame=!0,this._cameraToDeviceTransform=z.vt(),this._cameraToDeviceTransformUserFacing=z.vt(),this._cameraModel=new Float32Array([300,300,160,120,0,0]),this._profile=I.HE.DEFAULT,this._waitingForFrame=!1,this._rgbOffscreenContext=null,this._rgbDomContext=null,this._isVideoElement=!1,this._lastPresentedFrames=-1,z.CV(this._cameraToDeviceTransformUserFacing,[-1,1,-1]);let r=this._video;this._isVideoElement=r instanceof HTMLVideoElement,this._isVideoElement?r.addEventListener("loadedmetadata",()=>{this._hadFrames=!0}):this._hadFrames=!0,this._resetGLContext=this._resetGLContext.bind(this);let i=eN.get(this._pipeline);i&&i.onGLContextReset.bind(this._resetGLContext)}static createVideoElementSource(e,t){let r=eb++;return ey.set(r,new ew(t,e)),eh("html_element_source_t initialized"),r}static getVideoElementSource(e){return ey.get(e)}_resetGLContext(){var e,t;this._currentVideoTexture=void 0,null==(t=null==(e=this._imageProcessor)?void 0:e.resetGLContext)||t.call(e)}destroy(){let e=eN.get(this._pipeline);e&&e.onGLContextReset.unbind(this._resetGLContext),this.pause(),this._resetGLContext(),this._currentRgbFrame=void 0,this._rgbDomCanvas=void 0,this._rgbDomContext=null,this._rgbOffscreenCanvas=void 0,this._rgbOffscreenContext=null}pause(){this._isPaused=!0;let e=eN.get(this._pipeline);e&&e.currentCameraSource===this&&(e.currentCameraSource=void 0)}start(){var e;this._isPaused&&(this._isUploadFrame=!0,this._video instanceof HTMLVideoElement&&(this._hadFrames=!1)),this._isPaused=!1;let t=eN.get(this._pipeline);t&&t.currentCameraSource!==this&&(null==(e=t.currentCameraSource)||e.pause(),t.currentCameraSource=this)}getFrame(e){let t=eN.get(this._pipeline);if(!t)return;let r=t.glContext;if(r&&!this._isPaused&&this._hadFrames)try{let i=this._processFrame(r,this._cameraToScreenRotation,e);if(i){let e=t.registerToken(i);t.sendDataToWorker(i.data||new ArrayBuffer(0),e,i.dataWidth,i.dataHeight,i.userFacing,i.cameraToDevice,i.cameraModel,-1),i.data=void 0}}catch(e){console.log("Unable to process frame")}}_requestVideoFrameCallback(){let e=this._video;(null==e?void 0:e.requestVideoFrameCallback)&&(e.requestVideoFrameCallback((e,t)=>{if("object"==typeof t&&(this._frameTime=t.captureTime?1e3*t.captureTime:void 0),"object"==typeof t&&"number"==typeof t.presentedFrames)if(this._lastPresentedFrames===t.presentedFrames){console.log("Avoided identical frame"),this._requestVideoFrameCallback();return}else this._lastPresentedFrames=t.presentedFrames;this._waitingForFrame=!1}),this._waitingForFrame=!0)}_processFrame(e,t,r){let i=eN.get(this._pipeline);if(!i)return;if(this._imageProcessor||(this._imageProcessor=new ev.O(e)),this._isUploadFrame){if(this._waitingForFrame||(this._currentVideoTexture||(this._currentVideoTexture=i.getVideoTexture()),!this._currentVideoTexture))return;i.getCameraFrameDataRGBEnabled()&&(this._currentRgbFrame=this._generateRGBFrame()),this._imageProcessor.uploadFrame(this._currentVideoTexture,this._video,t,this._isUserFacing,this._profile),this._requestVideoFrameCallback(),this._isUploadFrame=!this._isUploadFrame;return}if(r||!this._currentVideoTexture)return;this._isUploadFrame=!this._isUploadFrame;let[a,s]=V.M.getDataSize(this._profile),n=a*s,o=i.cameraPixelArrays.pop();for(;o&&o.byteLength!==n;)o=i.cameraPixelArrays.pop();o||(o=new ArrayBuffer(n));let l=this._currentVideoTexture;this._currentVideoTexture=void 0;let _=(this._isUserFacing?300:240)*a/320;this._cameraModel[0]=_,this._cameraModel[1]=_,this._cameraModel[2]=.5*a,this._cameraModel[3]=.5*s;let c=Object.assign(Object.assign({},this._imageProcessor.readFrame(l,o,this._profile)),{cameraModel:this._cameraModel,cameraSource:this,cameraToDevice:this._isUserFacing?this._cameraToDeviceTransformUserFacing:this._cameraToDeviceTransform});return this._currentRgbFrame&&(c.rgbFrame=this._currentRgbFrame,this._currentRgbFrame=void 0),c}uploadGL(){}setProfile(e){this._profile=e}_generateRGBFrame(){let e=this._isVideoElement?this._video.videoWidth:this._video.naturalWidth,t=this._isVideoElement?this._video.videoHeight:this._video.naturalHeight;if(e>0&&t>0)return V.M.offscreenCanvasSupported?this._generateOffscreenRgbFrame(e,t):this._generateDomRgbFrame(e,t)}_generateOffscreenRgbFrame(e,t){var r;this._rgbOffscreenCanvas?(this._rgbOffscreenCanvas.width!==e||this._rgbOffscreenCanvas.height!==t)&&(this._rgbOffscreenCanvas.width=e,this._rgbOffscreenCanvas.height=t):(this._rgbOffscreenCanvas=new OffscreenCanvas(e,t),this._rgbOffscreenContext=this._rgbOffscreenCanvas.getContext("2d",{alpha:!1,willReadFrequently:!0})),null==(r=this._rgbOffscreenContext)||r.drawImage(this._video,0,0,e,t);try{return this._rgbOffscreenCanvas.transferToImageBitmap()}catch(e){eu(`Failed to generate RGB frame: ${e}`);return}}_generateDomRgbFrame(e,t){var r,i;this._rgbDomCanvas?(this._rgbDomCanvas.width!==e||this._rgbDomCanvas.height!==t)&&(this._rgbDomCanvas.width=e,this._rgbDomCanvas.height=t):(this._rgbDomCanvas=document.createElement("canvas"),this._rgbDomContext=this._rgbDomCanvas.getContext("2d",{alpha:!1,willReadFrequently:!0})),null==(r=this._rgbDomContext)||r.drawImage(this._video,0,0,e,t);try{return null==(i=this._rgbDomContext)?void 0:i.getImageData(0,0,e,t)}catch(e){eu(`Failed to generate RGB frame: ${e}`);return}}}var eA=function(e,t,r,i){return new(r||(r=Promise))(function(a,s){function n(e){try{l(i.next(e))}catch(e){s(e)}}function o(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(n,o)}l((i=i.apply(e,t||[])).next())})};let eT=document.createElement("video");eT.setAttribute("playsinline",""),eT.setAttribute("webkit-playsinline",""),V.M.videoElementInDOM&&(eT.style.width="0px",eT.style.height="0px",document.body.appendChild(eT));class eE extends ew{constructor(e,t,r){super(eT,t),this._impl=e,this._deviceId=r,this._currentStream=null,this._activeDeviceId=null,this._hasStartedOrientation=!1,this._lastTimestamp=-1,this._deviceMotionListener=e=>{let t=eN.get(this._pipeline);if(!t)return;let r=void 0!==e.timeStamp&&null!==e.timeStamp?e.timeStamp:performance.now(),i=e.interval*V.M.intervalMultiplier;V.M.trustSensorIntervals&&(-1===this._lastTimestamp?this._lastTimestamp=r:(this._lastTimestamp+=i,r=this._lastTimestamp)),null!==e.acceleration&&null!==e.acceleration.x&&null!==e.acceleration.y&&null!==e.acceleration.z&&t.motionAccelerometerWithoutGravitySubmitInt(r,i,e.acceleration.x*V.M.deviceMotionMutliplier,e.acceleration.y*V.M.deviceMotionMutliplier,e.acceleration.z*V.M.deviceMotionMutliplier),null!==e.accelerationIncludingGravity&&null!==e.accelerationIncludingGravity.x&&null!==e.accelerationIncludingGravity.y&&null!==e.accelerationIncludingGravity.z&&(t.motionAccelerometerSubmit(r,e.accelerationIncludingGravity.x*V.M.deviceMotionMutliplier,e.accelerationIncludingGravity.y*V.M.deviceMotionMutliplier,e.accelerationIncludingGravity.z*V.M.deviceMotionMutliplier),t.motionAccelerometerWithGravitySubmitInt(r,i,e.accelerationIncludingGravity.x*V.M.deviceMotionMutliplier,e.accelerationIncludingGravity.y*V.M.deviceMotionMutliplier,e.accelerationIncludingGravity.z*V.M.deviceMotionMutliplier)),null!==e.rotationRate&&null!==e.rotationRate.alpha&&null!==e.rotationRate.beta&&null!==e.rotationRate.gamma&&this._hasStartedOrientation?(t.motionRotationRateSubmit(r,-(e.rotationRate.alpha*Math.PI/180),-(e.rotationRate.beta*Math.PI/180),-(e.rotationRate.gamma*Math.PI/180)),t.motionRotationRateSubmitInt(r,i,e.rotationRate.alpha,e.rotationRate.beta,e.rotationRate.gamma)):this._hasStartedOrientation||this._startDeviceOrientation()}}destroy(){eD(this._impl),super.destroy()}_stop(){this._currentStream&&(this._currentStream.getTracks().forEach(e=>e.stop()),this._currentStream=null)}pause(){super.pause(),this._stopDeviceMotion(),this._syncCamera()}start(){super.start(),this._startDeviceMotion(),this._syncCamera()}_getConstraints(){return eA(this,void 0,void 0,function*(){let e,t;if(this._deviceId!==eE.DEFAULT_DEVICE_ID&&this._deviceId!==eE.USER_DEFAULT_DEVICE_ID)e=this._deviceId;else if(t=this._deviceId===eE.DEFAULT_DEVICE_ID?"environment":"user",V.M.ios164CameraSelection){if(!this._explicitEnvironmentCameraId||!this._explicitUserCameraId){(yield navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:t}})).getTracks().forEach(e=>e.stop());let e=yield navigator.mediaDevices.enumerateDevices();(e=e.filter(e=>"videoinput"===e.kind)).length>=2&&(this._explicitUserCameraId=e[0].deviceId,this._explicitEnvironmentCameraId=e[1].deviceId)}e="environment"===t?this._explicitEnvironmentCameraId:this._explicitUserCameraId}let r={audio:!1,video:{facingMode:t,width:V.M.videoWidth,height:V.M.videoHeight,frameRate:V.M.requestHighFrameRate?60:void 0,deviceId:e}};if(e||V.M.relyOnConstraintsForCameraSelection||!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return r;let i=yield navigator.mediaDevices.enumerateDevices(),a=!1;return i=i.filter(e=>{if("videoinput"!==e.kind)return!1;if(e.getCapabilities){a=!0;let r=e.getCapabilities();if(r&&r.facingMode&&0>r.facingMode.indexOf("user"===t?"user":"environment"))return!1}return!0}),a&&0!==i.length&&"object"==typeof r.video&&(eh("choosing device ID",i[i.length-1].deviceId),r.video.deviceId=i[i.length-1].deviceId),r})}getFrame(e){this._cameraToScreenRotation=W(!1),super.getFrame(e)}_getUserMedia(){return eA(this,void 0,void 0,function*(){let e=yield this._getConstraints();return navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?yield navigator.mediaDevices.getUserMedia(e):yield new Promise((t,r)=>{navigator.getUserMedia(e,t,r)})})}_syncCamera(){return eA(this,void 0,void 0,function*(){if(this._currentStream&&this._isPaused)return void this._stop();if(this._currentStream&&this._activeDeviceId!==this._deviceId&&this._stop(),!this._isPaused){if(this._activeDeviceId=this._deviceId,this._currentStream=yield this._getUserMedia(),this._isPaused)return void(yield this._syncCamera());if(this._isUserFacing=!1,this._currentStream){let e=this._currentStream.getVideoTracks();e.length>0&&(this._isUserFacing="user"===e[0].getSettings().facingMode)}if(!(this._video instanceof HTMLVideoElement))return;this._video.src="",this._video.loop=!1,this._video.muted=!0,this._video.srcObject=this._currentStream,this._video.play()}})}_startDeviceOrientation(){this._hasStartedOrientation||(this._hasStartedOrientation=!0,this._deviceOrientationListener=e=>{let t=eN.get(this._pipeline);if(!t)return;let r=void 0!==e.timeStamp&&null!==e.timeStamp?e.timeStamp:performance.now();null!==e.alpha&&null!==e.beta&&null!==e.gamma&&t.motionAttitudeSubmitInt(r,0,e.alpha,e.beta,e.gamma)},window.addEventListener("deviceorientation",this._deviceOrientationListener))}_startDeviceMotion(){window.addEventListener("devicemotion",this._deviceMotionListener,!1),this._startDeviceOrientation()}_stopDeviceMotion(){window.removeEventListener("devicemotion",this._deviceMotionListener),this._deviceOrientationListener&&window.removeEventListener("deviceorientation",this._deviceOrientationListener)}}eE.USER_DEFAULT_DEVICE_ID="Simulated User Default Device ID: a908df7f-5661-4d20-b227-a1c15d2fdb4b",eE.DEFAULT_DEVICE_ID="Simulated Default Device ID: a908df7f-5661-4d20-b227-a1c15d2fdb4b";var eR=function(e,t,r,i){return new(r||(r=Promise))(function(a,s){function n(e){try{l(i.next(e))}catch(e){s(e)}}function o(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(n,o)}l((i=i.apply(e,t||[])).next())})};class ex extends eg{constructor(e,t,r){super(),this._impl=e,this._pipeline=t,this._deviceId=r,this._currentStream=null,this._activeDeviceId=null,this._isPaused=!0,this._isUserFacing=!1,this._hadFrames=!1,this._canvas=new OffscreenCanvas(640,480),this._context=this._canvas.getContext("2d"),this._lastFrameTime=-1,this._video=document.createElement("video"),this._cameraToDeviceTransform=z.vt(),this._cameraToDeviceTransformUserFacing=z.vt(),this._cameraModel=new Float32Array([300,300,160,120,0,0]),this._profile=I.HE.DEFAULT,this._hasStartedOrientation=!1,this._lastTimestamp=-1,this._deviceMotionListener=e=>{let t=eN.get(this._pipeline);if(!t)return;let r=void 0!==e.timeStamp&&null!==e.timeStamp?e.timeStamp:performance.now(),i=e.interval;this._lastTimestamp>-1&&!V.M.trustSensorIntervals&&(i=Math.max(r-this._lastTimestamp,i)),this._lastTimestamp=r,i*=V.M.intervalMultiplier,null!==e.acceleration&&null!==e.acceleration.x&&null!==e.acceleration.y&&null!==e.acceleration.z&&t.motionAccelerometerWithoutGravitySubmitInt(r,i,e.acceleration.x*V.M.deviceMotionMutliplier,e.acceleration.y*V.M.deviceMotionMutliplier,e.acceleration.z*V.M.deviceMotionMutliplier),null!==e.accelerationIncludingGravity&&null!==e.accelerationIncludingGravity.x&&null!==e.accelerationIncludingGravity.y&&null!==e.accelerationIncludingGravity.z&&(t.motionAccelerometerSubmit(r,e.accelerationIncludingGravity.x*V.M.deviceMotionMutliplier,e.accelerationIncludingGravity.y*V.M.deviceMotionMutliplier,e.accelerationIncludingGravity.z*V.M.deviceMotionMutliplier),t.motionAccelerometerWithGravitySubmitInt(r,i,e.accelerationIncludingGravity.x*V.M.deviceMotionMutliplier,e.accelerationIncludingGravity.y*V.M.deviceMotionMutliplier,e.accelerationIncludingGravity.z*V.M.deviceMotionMutliplier)),null!==e.rotationRate&&null!==e.rotationRate.alpha&&null!==e.rotationRate.beta&&null!==e.rotationRate.gamma&&this._hasStartedOrientation?(t.motionRotationRateSubmit(r,-(e.rotationRate.alpha*Math.PI/180),-(e.rotationRate.beta*Math.PI/180),-(e.rotationRate.gamma*Math.PI/180)),t.motionRotationRateSubmitInt(r,i,e.rotationRate.alpha,e.rotationRate.beta,e.rotationRate.gamma)):this._hasStartedOrientation||this._startDeviceOrientation()},eh("Using ImageBitmap camera source"),z.CV(this._cameraToDeviceTransformUserFacing,[-1,1,-1]),this._video.muted=!0,this._video.setAttribute("playsinline",""),this._video.setAttribute("webkit-playsinline",""),V.M.videoElementInDOM&&(this._video.style.width="0px",this._video.style.height="0px",document.body.appendChild(this._video)),this._video.addEventListener("loadedmetadata",()=>{this._hadFrames=!0})}destroy(){this.pause(),eD(this._impl)}setProfile(e){this._profile=e}_stop(){this._currentStream&&(this._currentStream.getTracks().forEach(e=>e.stop()),this._currentStream=null)}pause(){this._isPaused=!0;let e=eN.get(this._pipeline);e&&e.currentCameraSource===this&&(e.currentCameraSource=void 0),this._stopDeviceMotion(),this._syncCamera()}start(){var e;let t=eN.get(this._pipeline);t&&t.currentCameraSource!==this&&(null==(e=t.currentCameraSource)||e.pause(),t.currentCameraSource=this),this._isPaused=!1,this._startDeviceMotion(),this._syncCamera()}_getConstraints(){return eR(this,void 0,void 0,function*(){let e,t;this._deviceId!==ex.DEFAULT_DEVICE_ID&&this._deviceId!==ex.USER_DEFAULT_DEVICE_ID?e=this._deviceId:t=this._deviceId===ex.DEFAULT_DEVICE_ID?"environment":"user";let r={audio:!1,video:{facingMode:t,width:V.M.videoWidth,height:V.M.videoHeight,frameRate:V.M.requestHighFrameRate?60:void 0,deviceId:e}};if(e||!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return r;let i=yield navigator.mediaDevices.enumerateDevices(),a=!1;return i=i.filter(e=>{if("videoinput"!==e.kind)return!1;if(e.getCapabilities){a=!0;let r=e.getCapabilities();if(r&&r.facingMode&&0>r.facingMode.indexOf("user"===t?"user":"environment"))return!1}return!0}),a&&0!==i.length&&"object"==typeof r.video&&(eh("choosing device ID",i[i.length-1].deviceId),r.video.deviceId=i[i.length-1].deviceId),r})}getFrame(e){var t,r;if(!this._context||!this._hadFrames||e)return;let i=performance.now();if(i<this._lastFrameTime+25)return;this._lastFrameTime=i,this._canvas.width!==this._video.videoWidth&&(this._canvas.width=this._video.videoWidth),this._canvas.height!==this._video.videoHeight&&(this._canvas.height=this._video.videoHeight),this._context.drawImage(this._video,0,0);let a=this._canvas.transferToImageBitmap(),s=W(!1),n=eN.get(this._pipeline);if(!n)return;let[o,l]=V.M.getDataSize(this._profile),_=300*o/320;this._cameraModel[0]=_,this._cameraModel[1]=_,this._cameraModel[2]=.5*o,this._cameraModel[3]=.5*l;let c=n.registerToken({dataWidth:this._canvas.width,dataHeight:this._canvas.height,texture:void 0,userFacing:this._isUserFacing,cameraSource:this,cameraModel:this._cameraModel.slice(),cameraToDevice:this._isUserFacing?this._cameraToDeviceTransformUserFacing:this._cameraToDeviceTransform});null==(r=null==(t=eN.get(this._pipeline))?void 0:t.sendImageBitmapToWorker)||r.call(t,a,s,this._isUserFacing,c,this._cameraModel,this._isUserFacing?this._cameraToDeviceTransformUserFacing:this._cameraToDeviceTransform,this._profile)}_getUserMedia(){return eR(this,void 0,void 0,function*(){let e=yield this._getConstraints();return navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?yield navigator.mediaDevices.getUserMedia(e):yield new Promise((t,r)=>{navigator.getUserMedia(e,t,r)})})}_syncCamera(){return eR(this,void 0,void 0,function*(){if(this._currentStream&&this._isPaused)return void this._stop();if(this._currentStream&&this._activeDeviceId!==this._deviceId&&this._stop(),!this._isPaused){if(this._activeDeviceId=this._deviceId,this._currentStream=yield this._getUserMedia(),this._isPaused)return void(yield this._syncCamera());if(this._isUserFacing=!1,this._currentStream){let e=this._currentStream.getVideoTracks();e.length>0&&(this._isUserFacing="user"===e[0].getSettings().facingMode)}this._video.src="",this._video.loop=!1,this._video.muted=!0,this._video.srcObject=this._currentStream,this._video.play()}})}_startDeviceOrientation(){this._hasStartedOrientation||(this._hasStartedOrientation=!0,window.addEventListener("deviceorientation",e=>{let t=eN.get(this._pipeline);if(!t)return;let r=void 0!==e.timeStamp&&null!==e.timeStamp?e.timeStamp:performance.now();null!==e.alpha&&null!==e.beta&&null!==e.gamma&&t.motionAttitudeSubmitInt(r,0,e.alpha,e.beta,e.gamma)}))}_startDeviceMotion(){window.addEventListener("devicemotion",this._deviceMotionListener,!1)}_stopDeviceMotion(){window.removeEventListener("devicemotion",this._deviceMotionListener)}uploadGL(e){let t=eN.get(this._pipeline),r=null==t?void 0:t.glContext;if(!e||e.texture||!e.frame||!t||!r)return;let i=t.getVideoTexture();i&&(r.bindTexture(r.TEXTURE_2D,i),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e.frame),r.bindTexture(r.TEXTURE_2D,null),e.texture=i)}}ex.USER_DEFAULT_DEVICE_ID="Simulated User Default Device ID: a908df7f-5661-4d20-b227-a1c15d2fdb4b",ex.DEFAULT_DEVICE_ID="Simulated Default Device ID: a908df7f-5661-4d20-b227-a1c15d2fdb4b";var eM=function(e,t,r,i){return new(r||(r=Promise))(function(a,s){function n(e){try{l(i.next(e))}catch(e){s(e)}}function o(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(n,o)}l((i=i.apply(e,t||[])).next())})};class ek extends eg{constructor(e,t,r){super(),this._impl=e,this._pipeline=t,this._deviceId=r,this._currentStream=null,this._activeDeviceId=null,this._isPaused=!0,this._isUserFacing=!1,this._cameraToScreenRotation=0,this._hasStartedOrientation=!1,this._lastTimestamp=-1,this._deviceMotionListener=e=>{let t=eN.get(this._pipeline);if(!t)return;let r=void 0!==e.timeStamp&&null!==e.timeStamp?e.timeStamp:performance.now(),i=e.interval*V.M.intervalMultiplier;V.M.trustSensorIntervals&&(-1===this._lastTimestamp?this._lastTimestamp=r:(this._lastTimestamp+=i,r=this._lastTimestamp)),null!==e.acceleration&&null!==e.acceleration.x&&null!==e.acceleration.y&&null!==e.acceleration.z&&t.motionAccelerometerWithoutGravitySubmitInt(r,i,e.acceleration.x*V.M.deviceMotionMutliplier,e.acceleration.y*V.M.deviceMotionMutliplier,e.acceleration.z*V.M.deviceMotionMutliplier),null!==e.accelerationIncludingGravity&&null!==e.accelerationIncludingGravity.x&&null!==e.accelerationIncludingGravity.y&&null!==e.accelerationIncludingGravity.z&&(t.motionAccelerometerSubmit(r,e.accelerationIncludingGravity.x*V.M.deviceMotionMutliplier,e.accelerationIncludingGravity.y*V.M.deviceMotionMutliplier,e.accelerationIncludingGravity.z*V.M.deviceMotionMutliplier),t.motionAccelerometerWithGravitySubmitInt(r,i,e.accelerationIncludingGravity.x*V.M.deviceMotionMutliplier,e.accelerationIncludingGravity.y*V.M.deviceMotionMutliplier,e.accelerationIncludingGravity.z*V.M.deviceMotionMutliplier)),null!==e.rotationRate&&null!==e.rotationRate.alpha&&null!==e.rotationRate.beta&&null!==e.rotationRate.gamma&&this._hasStartedOrientation?(t.motionRotationRateSubmit(r,-(e.rotationRate.alpha*Math.PI/180),-(e.rotationRate.beta*Math.PI/180),-(e.rotationRate.gamma*Math.PI/180)),t.motionRotationRateSubmitInt(r,i,e.rotationRate.alpha,e.rotationRate.beta,e.rotationRate.gamma)):this._hasStartedOrientation||this._startDeviceOrientation()},this._lastAccelerometerTimestamp=-1,this._accelerometerReading=()=>{var e;if(!this._accelerometer||void 0===this._accelerometer.x||void 0===this._accelerometer.y||void 0===this._accelerometer.z)return;let t=eN.get(this._pipeline);if(!t)return;let r=null!=(e=this._accelerometer.timestamp)?e:performance.now(),i=this._lastAccelerometerTimestamp>-1?r-this._lastAccelerometerTimestamp:30;this._lastAccelerometerTimestamp=r,t.motionAccelerometerSubmit(r,this._accelerometer.x*V.M.deviceMotionMutliplier,this._accelerometer.y*V.M.deviceMotionMutliplier,this._accelerometer.z*V.M.deviceMotionMutliplier),t.motionAccelerometerWithGravitySubmitInt(r,i,this._accelerometer.x*V.M.deviceMotionMutliplier,this._accelerometer.y*V.M.deviceMotionMutliplier,this._accelerometer.z*V.M.deviceMotionMutliplier)},this._lastLinearAccelerationTimestamp=-1,this._linearAccelerationReading=()=>{var e;if(!this._linearAcceleration||void 0===this._linearAcceleration.x||void 0===this._linearAcceleration.y||void 0===this._linearAcceleration.z)return;let t=eN.get(this._pipeline);if(!t)return;let r=null!=(e=this._linearAcceleration.timestamp)?e:performance.now(),i=this._lastLinearAccelerationTimestamp>-1?r-this._lastLinearAccelerationTimestamp:30;this._lastLinearAccelerationTimestamp=r,t.motionAccelerometerWithoutGravitySubmitInt(r,i,this._linearAcceleration.x*V.M.deviceMotionMutliplier,this._linearAcceleration.y*V.M.deviceMotionMutliplier,this._linearAcceleration.z*V.M.deviceMotionMutliplier)},this._lastGyroscopeReading=-1,this._gyroscopeReading=()=>{var e;if(!this._gyroscope||void 0===this._gyroscope.x||void 0===this._gyroscope.y||void 0===this._gyroscope.z)return;let t=eN.get(this._pipeline);if(!t)return;let r=null!=(e=this._gyroscope.timestamp)?e:performance.now(),i=this._lastGyroscopeReading>-1?r-this._lastGyroscopeReading:30;this._lastGyroscopeReading=r,t.motionRotationRateSubmit(r,-this._gyroscope.x,-this._gyroscope.y,-this._gyroscope.z),t.motionRotationRateSubmitInt(r,i,180*this._gyroscope.x/Math.PI,180*this._gyroscope.y/Math.PI,180*this._gyroscope.z/Math.PI)},this._lastReleativeOrientationReading=-1,this._relativeOrientationReading=()=>{var e;if(!this._relativeOrientation||void 0===this._relativeOrientation.quaternion)return;let t=eN.get(this._pipeline);if(!t)return;let r=null!=(e=this._relativeOrientation.timestamp)?e:performance.now(),i=this._lastReleativeOrientationReading>-1?r-this._lastReleativeOrientationReading:30;this._lastReleativeOrientationReading=r,t.motionRelativeOrientationSubmitInt(r,i,this._relativeOrientation.quaternion[0],this._relativeOrientation.quaternion[1],this._relativeOrientation.quaternion[2],this._relativeOrientation.quaternion[3])},eh("Using MSTP camera source")}destroy(){this.pause(),eD(this._impl)}_stop(){this._currentStream&&(this._currentStream.getTracks().forEach(e=>e.stop()),this._currentStream=null)}pause(){this._isPaused=!0;let e=eN.get(this._pipeline);e&&e.currentCameraSource===this&&(e.currentCameraSource=void 0),this._stopDeviceMotion(),this._syncCamera()}start(){var e;let t=eN.get(this._pipeline);t&&t.currentCameraSource!==this&&(null==(e=t.currentCameraSource)||e.pause(),t.currentCameraSource=this),this._isPaused=!1,this._startDeviceMotion(),this._syncCamera()}_getConstraints(){return eM(this,void 0,void 0,function*(){let e,t;this._deviceId!==ek.DEFAULT_DEVICE_ID&&this._deviceId!==ek.USER_DEFAULT_DEVICE_ID?e=this._deviceId:t=this._deviceId===ek.DEFAULT_DEVICE_ID?"environment":"user";let r={audio:!1,video:{facingMode:t,width:V.M.videoWidth,height:V.M.videoHeight,frameRate:V.M.requestHighFrameRate?60:30,deviceId:e}};if(e||!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return r;let i=yield navigator.mediaDevices.enumerateDevices(),a=!1;return i=i.filter(e=>{if("videoinput"!==e.kind)return!1;if(e.getCapabilities){a=!0;let r=e.getCapabilities();if(r&&r.facingMode&&0>r.facingMode.indexOf("user"===t?"user":"environment"))return!1}return!0}),a&&0!==i.length&&"object"==typeof r.video&&(eh("choosing device ID",i[i.length-1].deviceId),r.video.deviceId=i[i.length-1].deviceId),r})}getFrame(e){var t,r;let i=W(!1);i!=this._cameraToScreenRotation&&(null==(r=null==(t=eN.get(this._pipeline))?void 0:t.sendCameraToScreenRotationToWorker)||r.call(t,i),this._cameraToScreenRotation=i)}_getUserMedia(){return eM(this,void 0,void 0,function*(){let e=yield this._getConstraints();return navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?yield navigator.mediaDevices.getUserMedia(e):yield new Promise((t,r)=>{navigator.getUserMedia(e,t,r)})})}streamEnded(){console.log("MSTP stream ended"),this._stop(),this._syncCamera()}_syncCamera(){return eM(this,void 0,void 0,function*(){if(this._currentStream&&this._isPaused)return void this._stop();if(this._currentStream&&this._activeDeviceId!==this._deviceId&&this._stop(),!this._isPaused){if(this._activeDeviceId=this._deviceId,this._currentStream=yield this._getUserMedia(),this._isPaused)return void(yield this._syncCamera());if(this._isUserFacing=!1,this._currentStream){let e=this._currentStream.getVideoTracks();if(e.length>0){this._isUserFacing="user"===e[0].getSettings().facingMode;let t=new MediaStreamTrackProcessor({track:e[0],maxBufferSize:1}),r=this._currentStream;if(yield new Promise(e=>{setTimeout(e,1e3)}),r!==this._currentStream)return;let i=eN.get(this._pipeline);i&&i.sendCameraStreamToWorker(this._impl,t.readable,this._isUserFacing)}}}})}setProfile(e){let t=eN.get(this._pipeline);t&&t.sendCameraProfileToWorker(this._impl,e)}_startDeviceOrientation(){this._hasStartedOrientation||(this._hasStartedOrientation=!0,window.addEventListener("deviceorientation",e=>{let t=eN.get(this._pipeline);if(!t)return;let r=void 0!==e.timeStamp&&null!==e.timeStamp?e.timeStamp:performance.now();null!==e.alpha&&null!==e.beta&&null!==e.gamma&&t.motionAttitudeSubmitInt(r,0,e.alpha,e.beta,e.gamma)}))}_startDeviceMotion(){try{this._accelerometer=new Accelerometer({frequency:60}),this._linearAcceleration=new LinearAccelerationSensor({frequency:60}),this._gyroscope=new Gyroscope({frequency:60}),this._relativeOrientation=new RelativeOrientationSensor({frequency:60}),this._accelerometer.addEventListener("reading",this._accelerometerReading),this._accelerometer.start(),this._linearAcceleration.addEventListener("reading",this._linearAccelerationReading),this._linearAcceleration.start(),this._gyroscope.addEventListener("reading",this._gyroscopeReading),this._gyroscope.start(),this._relativeOrientation.addEventListener("reading",this._relativeOrientationReading),this._relativeOrientation.start()}catch(e){window.addEventListener("devicemotion",this._deviceMotionListener,!1)}}_stopDeviceMotion(){this._accelerometer&&(this._accelerometer.stop(),this._accelerometer.removeEventListener("reading",this._accelerometerReading),delete this._accelerometer),this._linearAcceleration&&(this._linearAcceleration.stop(),this._linearAcceleration.removeEventListener("reading",this._linearAccelerationReading),delete this._linearAcceleration),this._gyroscope&&(this._gyroscope.stop(),this._gyroscope.removeEventListener("reading",this._gyroscopeReading),delete this._gyroscope),this._relativeOrientation&&(this._relativeOrientation.stop(),this._relativeOrientation.removeEventListener("reading",this._relativeOrientationReading),delete this._relativeOrientation),window.removeEventListener("devicemotion",this._deviceMotionListener)}uploadGL(e){let t=eN.get(this._pipeline),r=null==t?void 0:t.glContext;if(!e||e.texture||!e.frame||!t||!r)return;let i=t.getVideoTexture();if(!i)return;let a=r.getParameter(r.TEXTURE_BINDING_2D);r.bindTexture(r.TEXTURE_2D,i),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e.frame),r.bindTexture(r.TEXTURE_2D,a),e.texture=i}}ek.USER_DEFAULT_DEVICE_ID="Simulated User Default Device ID: a908df7f-5661-4d20-b227-a1c15d2fdb4b",ek.DEFAULT_DEVICE_ID="Simulated Default Device ID: a908df7f-5661-4d20-b227-a1c15d2fdb4b";let eI=1,eS=new Map;function eF(e,t){eS.set(e,t)}function eC(e){return eS.get(e)}function eD(e){eS.delete(e)}class eU{constructor(e){this._gl=e}dispose(){this._vbo&&this._gl.deleteBuffer(this._vbo),this._uvbo&&this._gl.deleteBuffer(this._uvbo),this._ibo&&this._gl.deleteBuffer(this._ibo),this._shader&&this._gl.deleteProgram(this._shader.prog),this._vbo=void 0,this._uvbo=void 0,this._ibo=void 0,this._shader=void 0}_generateIBO(e,t){if(this._ibo&&this._lastIndices===e)return this._ibo;if(this._lastIndices=e,this._ibo||(this._ibo=t.createBuffer()),!this._ibo)throw Error("Unable to create buffer object");return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._ibo),t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),this._ibo}_generateVBO(e,t){if(this._vbo||(this._vbo=t.createBuffer()),!this._vbo)throw Error("Unable to create buffer object");return t.bindBuffer(t.ARRAY_BUFFER,this._vbo),t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),this._vbo}_generateUVBO(e,t){if(this._uvbo||(this._uvbo=t.createBuffer()),!this._uvbo)throw Error("Unable to create buffer object");return t.bindBuffer(t.ARRAY_BUFFER,this._uvbo),t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),this._uvbo}draw(e,t,r){var i;let a=t.getPreviewMesh(r),s=null==(i=t.getTargetInfo(r).preview)?void 0:i.image;if(!a||!s||!s.complete)return;let n=this._gl,o=this._getShader(n),l=this._generateVBO(a.vertices,n),_=this._generateUVBO(a.uvs,n),c=this._generateIBO(a.indices,n);n.enable(n.DEPTH_TEST),n.enable(n.CULL_FACE),n.useProgram(o.prog),n.uniformMatrix4fv(o.unif_matrix,!1,e),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,function(e,t){let r=eP.get(t);if(r)return r;if(!(r=e.createTexture()||void 0))throw Error("Unable to create texture");eP.set(t,r),e.bindTexture(e.TEXTURE_2D,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);let i=e.RGBA,a=e.RGBA,s=e.UNSIGNED_BYTE;return e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.texImage2D(e.TEXTURE_2D,0,i,a,s,t),t.addEventListener("load",()=>{if(!r)return;e.bindTexture(e.TEXTURE_2D,r);let i=e.RGBA,a=e.RGBA,s=e.UNSIGNED_BYTE;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.texImage2D(e.TEXTURE_2D,0,i,a,s,t)}),r}(n,s)),n.uniform1i(o.unif_skinSampler,0),n.bindBuffer(n.ARRAY_BUFFER,l),n.vertexAttribPointer(o.attr_position,3,n.FLOAT,!1,0,0),n.enableVertexAttribArray(o.attr_position),n.bindBuffer(n.ARRAY_BUFFER,_),n.vertexAttribPointer(o.attr_textureCoord,2,n.FLOAT,!1,0,0),n.enableVertexAttribArray(o.attr_textureCoord),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,c),n.drawElements(n.TRIANGLES,a.indices.length,n.UNSIGNED_SHORT,0),n.disableVertexAttribArray(o.attr_position),n.disableVertexAttribArray(o.attr_textureCoord),n.bindBuffer(n.ARRAY_BUFFER,null),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null)}_getShader(e){if(this._shader)return this._shader;let t=e.createProgram();if(!t)throw Error("Unable to create program");let r=(0,D.R)(e,e.VERTEX_SHADER,eL),i=(0,D.R)(e,e.FRAGMENT_SHADER,ez);e.attachShader(t,r),e.attachShader(t,i),(0,D.i)(e,t);let a=e.getUniformLocation(t,"matrix");if(!a)throw Error("Unable to get uniform location mattrix");let s=e.getUniformLocation(t,"skinSampler");if(!s)throw Error("Unable to get uniform location skinSampler");return this._shader={prog:t,unif_matrix:a,unif_skinSampler:s,attr_position:e.getAttribLocation(t,"position"),attr_textureCoord:e.getAttribLocation(t,"textureCoord")},this._shader}}let eP=new Map,eL=`
#ifndef GL_ES
#define highp
#define mediump
#define lowp
#endif

uniform mat4 matrix;
attribute vec4 position;
attribute vec2 textureCoord;

varying highp vec2 vTextureCoord;

void main()
{
    gl_Position = matrix * position;
    vTextureCoord = textureCoord;
}`,ez=`
#define highp mediump
#ifdef GL_ES
    // define default precision for float, vec, mat.
    precision highp float;
#else
#define highp
#define mediump
#define lowp
#endif

varying highp vec2 vTextureCoord;
uniform sampler2D skinSampler;

void main()
{
    gl_FragColor = texture2D(skinSampler, vTextureCoord);
}`,eB=new Map,eO=z.vt();class eN{constructor(e,t,r){this._client=e,this._impl=t,this._mgr=r,this.pendingMessages=[],this.cameraTokens=new Map,this.nextCameraToken=1,this.tokensInFlight=0,this.videoTextures=[],this.cameraPixelArrays=[],this._sequenceRecordDeviceAttitudeMatrices=!0,this._sequenceRecorderFirstCameraToken=0,this._cameraFrameDataPromises=new Map,this._cameraFrameDataResolves=new Map,this._cameraFrameDataRejects=new Map,this._cameraFrameDataEnabled=!1,this._cameraFrameDataRGBEnabled=!1,this.onGLContextReset=new ec.Jh}static create(e,t){let r=e.pipeline_create();return eB.set(r,new eN(e,r,t)),r}static get(e){return eB.get(e)}frameUpdate(e){for(let t of this.pendingMessages)e.processMessages(t),this._mgr.postOutgoingMessage({t:"buf",p:this._impl,d:t},[t]);this.pendingMessages=[],this.cleanOldFrames()}cleanOldFrames(){var e,t,r,i,a,s;let n=this._client.pipeline_camera_frame_user_data(this._impl);if(n)for(let o of this.cameraTokens)o[0]<n&&(o[1].texture&&this.videoTextures.push(o[1].texture),null==(t=null==(e=o[1].frame)?void 0:e.close)||t.call(e),o[1].frame!==o[1].rgbFrame&&(o[1].rgbFrame instanceof ImageData||null==(i=null==(r=o[1].rgbFrame)?void 0:r.close)||i.call(r)),o[1].frame=void 0,o[1].rgbFrame=void 0,null==(s=(a=o[1].cameraSource).recycle)||s.call(a,o[1]),o[1].data&&(this.cameraPixelArrays.push(o[1].data),o[1].data=void 0),this.cameraTokens.delete(o[0]))}cameraFrameDataRawResult(e){var t,r;let i=this.cameraTokens.get(e.token);i&&(null===e.data?null==(t=this._cameraFrameDataRejects.get(i))||t(Error("Raw camera data not available")):(i.data=e.data.data,null==(r=this._cameraFrameDataResolves.get(i))||r(e.data)),this._cameraFrameDataRejects.delete(i),this._cameraFrameDataResolves.delete(i),this._cameraFrameDataPromises.delete(i))}cameraTokenReturn(e){let t=this.cameraTokens.get(e.token);if(this._sequenceRecorder&&this._sequenceRecordDeviceAttitudeMatrices&&e.token>=this._sequenceRecorderFirstCameraToken&&t&&(e.att&&this._sequenceRecorder.appendAttitudeMatrix(e.att),t.data=e.d,this._sequenceRecorder.appendCameraFrame(t)),t&&!t.data&&e.d){t.data=e.d;let r=this._cameraFrameDataResolves.get(t);r&&r({data:t.data,width:t.dataWidth,height:t.dataHeight}),this._cameraFrameDataRejects.delete(t),this._cameraFrameDataResolves.delete(t),this._cameraFrameDataPromises.delete(t)}this.tokensInFlight--}sequenceRecordStart(e){this._sequenceRecorder||(this._sequenceRecorder=new ep(e)),this._sequenceRecorder.start(),this._sequenceRecorderFirstCameraToken=this.nextCameraToken}sequenceRecordStop(){var e;null==(e=this._sequenceRecorder)||e.stop()}sequenceRecordData(){var e;return(null==(e=this._sequenceRecorder)?void 0:e.data())||new Uint8Array(0)}sequenceRecordClear(){delete this._sequenceRecorder}sequenceRecordDeviceAttitudeMatrices(e){this._sequenceRecordDeviceAttitudeMatrices=e}getVideoTexture(){return this.videoTextures.pop()}getCameraFrameDataRGB(){if(!this._cameraFrameDataRGBEnabled)return;let e=this.getCurrentCameraInfo();if(!e||!e.rgbFrame)return;let t=0,r=0;return e.rgbFrame instanceof VideoFrame?(t=e.rgbFrame.displayWidth,r=e.rgbFrame.displayHeight):(t=e.rgbFrame.width,r=e.rgbFrame.height),{frame:e.rgbFrame,width:t,height:r}}setCameraFrameDataRGBEnabled(e){this._cameraFrameDataRGBEnabled=e}getCameraFrameDataRGBEnabled(){return this._cameraFrameDataRGBEnabled}getCameraFrameDataRaw(){if(!this._cameraFrameDataEnabled)throw Error("Raw camera frame data is not enabled.");let e=this.getCurrentCameraInfo();if(!e)return Promise.resolve(void 0);if(e.data)return Promise.resolve({data:e.data.slice(0),width:e.dataWidth,height:e.dataHeight});let t=this._cameraFrameDataPromises.get(e);return t||(t=new Promise((t,r)=>{if(void 0!==e.remoteToken){let t={t:"rawrequest",token:e.remoteToken,p:this._impl};this._mgr.postOutgoingMessage(t,[])}this._cameraFrameDataResolves.set(e,t),this._cameraFrameDataRejects.set(e,r)}),this._cameraFrameDataPromises.set(e,t)),t}setCameraFrameDataRawEnabled(e){this._cameraFrameDataEnabled=e,this._mgr.postOutgoingMessage({t:"rawenabled",v:e},[])}destroy(){this._client.pipeline_destroy(this._impl),eB.delete(this._impl)}getCurrentCameraInfo(){let e=this._client.pipeline_camera_frame_user_data(this._impl);if(e)return this.cameraTokens.get(e)}cameraFrameDrawGL(e,t,r){if(!this.glContext)return;let i=this.getCurrentCameraInfo();i&&(this._cameraDraw||(this._cameraDraw=new ee(this.glContext)),this._cameraDraw.drawCameraFrame(e,t,i,!0===r))}glContextLost(){for(let e of(this._cameraDraw&&this._cameraDraw.dispose(),this._faceDraw&&this._faceDraw.dispose(),this._imageTargetPreviewDraw&&this._imageTargetPreviewDraw.dispose(),this._faceProjectDraw&&this._faceProjectDraw.dispose(),delete this._cameraDraw,delete this._faceDraw,delete this._imageTargetPreviewDraw,delete this._faceProjectDraw,i=void 0,a=void 0,s=void 0,U={},this.onGLContextReset.emit(),this.videoTextures))this.glContext&&this.glContext.deleteTexture(e);for(let e of(this.videoTextures=[],this.cameraTokens))this.glContext&&e[1].texture&&this.glContext.deleteTexture(e[1].texture),e[1].texture=void 0;this.glContext=void 0}glContextSet(e,t){this.glContextLost(),this.glContext=e,t=t||[];for(let r=0;r<4;r++){let i=t[r]||e.createTexture();i&&(e.bindTexture(e.TEXTURE_2D,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),this.videoTextures.push(i))}e.bindTexture(e.TEXTURE_2D,null)}drawFace(e,t,r,i){if(!this.glContext)return;this._faceDraw||(this._faceDraw=new ea(this.glContext));let a=z.vt();z.lw(a,e,t),z.lw(a,a,r),this._faceDraw.drawFace(a,i)}drawImageTargetPreview(e,t,r,i,a){if(!this.glContext)return;this._imageTargetPreviewDraw||(this._imageTargetPreviewDraw=new eU(this.glContext));let s=z.vt();z.lw(s,e,t),z.lw(s,s,r),this._imageTargetPreviewDraw.draw(s,a,i)}drawFaceProject(e,t,r,i,a,s){this.glContext&&(this._faceProjectDraw||(this._faceProjectDraw=new eo(this.glContext)),this._faceProjectDraw.drawFace(e,t,r,i,a,s))}cameraFrameTexture(){var e;return null==(e=this.getCurrentCameraInfo())?void 0:e.texture}cameraFrameTextureMatrix(e,t,r){let i=this.getCurrentCameraInfo();return i?ei(i.dataWidth,i.dataHeight,e,t,i.uvTransform||eO,r):z.vt()}cameraFrameUserFacing(){var e;return(null==(e=this.getCurrentCameraInfo())?void 0:e.userFacing)||!1}cameraPoseWithAttitude(e){let t=eV(this.getCurrentCameraInfo(),this._client.pipeline_camera_frame_camera_attitude(this._impl));if(e){let e=z.vt();z.CV(e,[-1,1,1]),z.lw(t,e,t),z.lw(t,t,e)}return z.B8(t,t),t}videoFrameFromWorker(e){let t=this.nextCameraToken++,r=eC(e.source);r&&(this.cameraTokens.set(t,{dataWidth:e.w,dataHeight:e.h,texture:void 0,frame:e.d,userFacing:e.userFacing,uvTransform:e.uvTransform,cameraModel:e.cameraModel,cameraToDevice:e.cameraToDevice,cameraSource:r,remoteToken:e.token,rgbFrame:this._cameraFrameDataRGBEnabled?e.d:void 0}),this.cleanOldFrames())}imageBitmapFromWorker(e){let t=this.cameraTokens.get(e.tokenId);t&&(t.dataWidth=e.dataWidth,t.dataHeight=e.dataHeight,t.frame=e.frame,t.userFacing=e.userFacing,t.uvTransform=e.uvTransform,this._cameraFrameDataRGBEnabled&&(t.rgbFrame=e.frame),this.tokensInFlight--,this.cleanOldFrames())}uploadGL(){var e,t;let r=this.getCurrentCameraInfo();null==(t=null==(e=null==r?void 0:r.cameraSource)?void 0:e.uploadGL)||t.call(e,r)}registerToken(e){let t=this.nextCameraToken++;return this.cameraTokens.set(t,e),this.tokensInFlight++,t}processGL(){if(!this.glContext)return void eu("no GL context for camera frames - please call pipeline_gl_context_set");if(this.currentCameraSource){if(this.tokensInFlight>0)return void this.currentCameraSource.getFrame(!0);this.currentCameraSource.getFrame(!1)}}motionAccelerometerSubmit(e,t,r,i){var a;this._sequenceRecordDeviceAttitudeMatrices||null==(a=this._sequenceRecorder)||a.appendAccelerometer(e,t,r,i);let s={t:"sensorDataC2S",sensor:"accel",interval:0,timestamp:e,x:t,y:r,z:i,p:this._impl};this._mgr.postOutgoingMessage(s,[])}motionAccelerometerWithoutGravitySubmitInt(e,t,r,i,a){var s;null==(s=this._sequenceRecorder)||s.appendAccelerometerWithoutGravityInt(e,t,r,i,a);let n={t:"sensorDataC2S",sensor:"accel_wo_gravity_int",interval:t,timestamp:e,x:r,y:i,z:a,p:this._impl};this._mgr.postOutgoingMessage(n,[])}motionAccelerometerWithGravitySubmitInt(e,t,r,i,a){var s;null==(s=this._sequenceRecorder)||s.appendAccelerometerWithGravityInt(e,t,r,i,a);let n={t:"sensorDataC2S",sensor:"accel_w_gravity_int",interval:t,timestamp:e,x:r,y:i,z:a,p:this._impl};this._mgr.postOutgoingMessage(n,[])}motionRotationRateSubmitInt(e,t,r,i,a){var s;null==(s=this._sequenceRecorder)||s.appendRotationRateInt(e,t,r,i,a);let n={t:"sensorDataC2S",sensor:"rotation_rate_int",interval:t,timestamp:e,x:r,y:i,z:a,p:this._impl};this._mgr.postOutgoingMessage(n,[])}motionAttitudeSubmitInt(e,t,r,i,a){var s;null==(s=this._sequenceRecorder)||s.appendAttitudeInt(e,t,r,i,a);let n={t:"sensorDataC2S",sensor:"attitude_int",interval:t,timestamp:e,x:r,y:i,z:a,p:this._impl};this._mgr.postOutgoingMessage(n,[])}motionRelativeOrientationSubmitInt(e,t,r,i,a,s){var n;null==(n=this._sequenceRecorder)||n.appendAttitudeInt(e,t,r,i,a);let o={t:"sensorDataC2S",sensor:"relative_orientation",interval:t,timestamp:e,x:r,y:i,z:a,w:s,p:this._impl};this._mgr.postOutgoingMessage(o,[])}motionRotationRateSubmit(e,t,r,i){var a;this._sequenceRecordDeviceAttitudeMatrices||null==(a=this._sequenceRecorder)||a.appendRotationRate(e,t,r,i);let s={t:"sensorDataC2S",sensor:"rotation_rate",interval:0,timestamp:e,x:t,y:r,z:i,p:this._impl};this._mgr.postOutgoingMessage(s,[])}motionAttitudeSubmit(e,t,r,i){var a;this._sequenceRecordDeviceAttitudeMatrices||null==(a=this._sequenceRecorder)||a.appendAttitude(e,t,r,i);let s={t:"sensorDataC2S",sensor:"attitude",interval:0,timestamp:e,x:t,y:r,z:i,p:this._impl};this._mgr.postOutgoingMessage(s,[])}motionAttitudeMatrix(e){let t={t:"attitudeMatrixC2S",p:this._impl,m:e};this._mgr.postOutgoingMessage(t,[])}sendCameraStreamToWorker(e,t,r){let i={t:"streamC2S",p:this._impl,s:t,userFacing:r,source:e};this._mgr.postOutgoingMessage(i,[i.s])}sendCameraProfileToWorker(e,t){let r={t:"cameraProfileC2S",p:this._impl,source:e,profile:t};this._mgr.postOutgoingMessage(r,[])}sendCameraToScreenRotationToWorker(e){let t={p:this._impl,t:"cameraToScreenC2S",r:e};this._mgr.postOutgoingMessage(t,[])}sendImageBitmapToWorker(e,t,r,i,a,s,n){let o={p:this._impl,t:"imageBitmapC2S",i:e,r:t,tokenId:i,userFacing:r,cameraModel:a,cameraToDevice:s,cp:n};this._mgr.postOutgoingMessage(o,[e])}sendDataToWorker(e,t,r,i,a,s,n,o){let l={d:e,p:this._impl,width:r,height:i,token:t,userFacing:a,c2d:s,cm:n,t:"cameraFrameC2S",captureTime:o};this._mgr.postOutgoingMessage(l,[e])}}function eV(e,t){let r=!1;r=!!e&&e.userFacing;let i=z.vt();return z.$0(i,W(r)*Math.PI/180,[0,0,1]),z.lw(i,i,t),i}function eG(e,t){var r=new Uint16Array(e);let i=Math.min(t.length,r.length),a=0;for(a=0;a+31<i;a+=32)r[a]=t.charCodeAt(a),r[a+1]=t.charCodeAt(a+1),r[a+2]=t.charCodeAt(a+2),r[a+3]=t.charCodeAt(a+3),r[a+4]=t.charCodeAt(a+4),r[a+5]=t.charCodeAt(a+5),r[a+6]=t.charCodeAt(a+6),r[a+7]=t.charCodeAt(a+7),r[a+8]=t.charCodeAt(a+8),r[a+9]=t.charCodeAt(a+9),r[a+10]=t.charCodeAt(a+10),r[a+11]=t.charCodeAt(a+11),r[a+12]=t.charCodeAt(a+12),r[a+13]=t.charCodeAt(a+13),r[a+14]=t.charCodeAt(a+14),r[a+15]=t.charCodeAt(a+15),r[a+16]=t.charCodeAt(a+16),r[a+17]=t.charCodeAt(a+17),r[a+18]=t.charCodeAt(a+18),r[a+19]=t.charCodeAt(a+19),r[a+20]=t.charCodeAt(a+20),r[a+21]=t.charCodeAt(a+21),r[a+22]=t.charCodeAt(a+22),r[a+23]=t.charCodeAt(a+23),r[a+24]=t.charCodeAt(a+24),r[a+25]=t.charCodeAt(a+25),r[a+26]=t.charCodeAt(a+26),r[a+27]=t.charCodeAt(a+27),r[a+28]=t.charCodeAt(a+28),r[a+29]=t.charCodeAt(a+29),r[a+30]=t.charCodeAt(a+30),r[a+31]=t.charCodeAt(a+31);for(;a<i;a++)r[a]=t.charCodeAt(a)}var eW=r(4880);let eq=e=>{},eH=()=>{};!function(e){e[e.INTERLEAVED_UV=0]="INTERLEAVED_UV",e[e.INTERLEAVED_VU=1]="INTERLEAVED_VU",e[e.PLANAR_UV=2]="PLANAR_UV"}(A||(A={}));class ej{constructor(e){this._gl=e,this._yTexture=null,this._uvTexture=null,this._uvTextureSinglePlane=!1,this._vTexture=null,this._framebufferId=null,this._vao=null,this._conversionShaders=[],this._isWebGL2=!1,this._useVao=!1,this._isWebGL2=e.getParameter(e.VERSION).indexOf("WebGL 2")>=0,this._useVao=!0,this._isWebGL2||(this._vaoExtension=this._gl.getExtension("OES_vertex_array_object"),null==this._vaoExtension&&(this._useVao=!1,this._instancedArraysExtension=this._gl.getExtension("ANGLE_instanced_arrays"))),this._oneComponentInternalFormat=this._isWebGL2?e.R8:e.ALPHA,this._oneComponentFormat=this._isWebGL2?e.RED:e.ALPHA,this._twoComponentInternalFormat=this._isWebGL2?e.RG8:e.LUMINANCE_ALPHA,this._twoComponentFormat=this._isWebGL2?e.RG:e.LUMINANCE_ALPHA}resetGLContext(){this._yTexture=null,this._uvTexture=null,this._vTexture=null,this._framebufferId=null,this._vao=null,this._vertexBuffer=void 0,this._conversionShaders=[]}destroy(){this.resetGLContext()}yuvToTexture(e,t,r,i){let a,s,n=this._gl,o=eW._.get(n);o.push();let l=n.isEnabled(n.SCISSOR_TEST),_=n.isEnabled(n.DEPTH_TEST),c=n.isEnabled(n.BLEND),d=n.isEnabled(n.CULL_FACE),h=n.isEnabled(n.STENCIL_TEST),u=n.getParameter(n.UNPACK_FLIP_Y_WEBGL),m=n.getParameter(n.ACTIVE_TEXTURE),p=n.getParameter(n.CURRENT_PROGRAM),f=n.getParameter(n.FRAMEBUFFER_BINDING),g=n.getParameter(n.ARRAY_BUFFER_BINDING),v=null;this._isWebGL2?v=n.getParameter(n.VERTEX_ARRAY_BINDING):this._vaoExtension&&(v=n.getParameter(this._vaoExtension.VERTEX_ARRAY_BINDING_OES)),n.activeTexture(n.TEXTURE0);let b=n.getParameter(n.TEXTURE_BINDING_2D);this._framebufferId||this._prepareContext();let y=r===A.PLANAR_UV&&!!t.dataVPlane;this._prepareTextures(e,t,y);let w=this._conversionShaders[r];if(w||(eq("YUV: Prepare conversion shader"),this._prepareConversionShader(r),w=this._conversionShaders[r],eH()),!w||!this._vertexBuffer||!this._yTexture||!this._uvTexture||y&&!this._vTexture){n.bindTexture(n.TEXTURE_2D,b),n.activeTexture(m),n.bindBuffer(n.ARRAY_BUFFER,g),this._isWebGL2?n.bindVertexArray(v):this._vaoExtension&&this._vaoExtension.bindVertexArrayOES(v),n.useProgram(p),o.pop();return}let T=w.aPositionLoc;this._useVao||(eq("getVertexAttribState"),s=this._getVertexAttribState(n,T),eH()),n.disable(n.SCISSOR_TEST),n.disable(n.DEPTH_TEST),n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.STENCIL_TEST),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1),n.bindTexture(n.TEXTURE_2D,this._yTexture.texture),n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.width,e.height,this._yTexture.format,n.UNSIGNED_BYTE,e.data),n.activeTexture(n.TEXTURE1);let E=n.getParameter(n.TEXTURE_BINDING_2D);n.bindTexture(n.TEXTURE_2D,this._uvTexture.texture),n.texSubImage2D(n.TEXTURE_2D,0,0,0,t.width,t.height,this._uvTexture.format,n.UNSIGNED_BYTE,t.data),y&&(n.activeTexture(n.TEXTURE2),a=n.getParameter(n.TEXTURE_BINDING_2D),n.bindTexture(n.TEXTURE_2D,this._vTexture.texture),n.texSubImage2D(n.TEXTURE_2D,0,0,0,t.width,t.height,this._vTexture.format,n.UNSIGNED_BYTE,t.dataVPlane)),n.bindFramebuffer(n.FRAMEBUFFER,this._framebufferId),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,i,0),n.viewport(0,0,e.width,e.height),n.clear(n.COLOR_BUFFER_BIT),this._useVao?this._isWebGL2?n.bindVertexArray(this._vao):this._vaoExtension&&this._vaoExtension.bindVertexArrayOES(this._vao):(n.bindBuffer(n.ARRAY_BUFFER,this._vertexBuffer),n.vertexAttribPointer(T,2,n.FLOAT,!1,0,0),s&&0!=s.divisor&&(this._isWebGL2?n.vertexAttribDivisor(T,0):this._instancedArraysExtension&&this._instancedArraysExtension.vertexAttribDivisorANGLE(T,0)),n.enableVertexAttribArray(T)),n.useProgram(w.program),n.drawArrays(n.TRIANGLE_STRIP,0,4),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,null,0),c&&n.enable(n.BLEND),d&&n.enable(n.CULL_FACE),_&&n.enable(n.DEPTH_TEST),l&&n.enable(n.SCISSOR_TEST),h&&n.enable(n.STENCIL_TEST),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,u),n.bindFramebuffer(n.FRAMEBUFFER,f),y&&(n.bindTexture(n.TEXTURE_2D,a),n.activeTexture(n.TEXTURE1)),n.bindTexture(n.TEXTURE_2D,E),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,b),n.activeTexture(m),this._useVao?this._isWebGL2?n.bindVertexArray(v):this._vaoExtension&&this._vaoExtension.bindVertexArrayOES(v):s&&(n.bindBuffer(n.ARRAY_BUFFER,s.bufferBinding),n.vertexAttribPointer(T,s.size,s.type,s.normalized,s.stride,s.offset),0!=s.divisor&&(this._isWebGL2?n.vertexAttribDivisor(T,s.divisor):this._instancedArraysExtension&&this._instancedArraysExtension.vertexAttribDivisorANGLE(T,s.divisor)),s.enabled||n.disableVertexAttribArray(T)),n.bindBuffer(n.ARRAY_BUFFER,g),n.useProgram(p),o.pop()}_getVertexAttribState(e,t){let r=0;return this._isWebGL2?(eq("getWebGL2Divisor"),r=e.getVertexAttrib(t,e.VERTEX_ATTRIB_ARRAY_DIVISOR),eH()):this._instancedArraysExtension&&(eq("getExtDivisor"),r=e.getVertexAttrib(t,this._instancedArraysExtension.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE),eH()),{size:e.getVertexAttrib(t,e.VERTEX_ATTRIB_ARRAY_SIZE),type:e.getVertexAttrib(t,e.VERTEX_ATTRIB_ARRAY_TYPE),normalized:e.getVertexAttrib(t,e.VERTEX_ATTRIB_ARRAY_NORMALIZED),stride:e.getVertexAttrib(t,e.VERTEX_ATTRIB_ARRAY_STRIDE),offset:e.getVertexAttribOffset(t,e.VERTEX_ATTRIB_ARRAY_POINTER),bufferBinding:e.getVertexAttrib(t,e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING),enabled:e.getVertexAttrib(t,e.VERTEX_ATTRIB_ARRAY_ENABLED),divisor:r}}_prepareContext(){eq("YUV: prepareContext");let e=this._gl;this._framebufferId=e.createFramebuffer();let t=new Float32Array([-1,-1,-1,1,1,-1,1,1]);this._vertexBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this._vertexBuffer),e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW),this._useVao&&(this._isWebGL2?(this._vao=e.createVertexArray(),e.bindVertexArray(this._vao)):this._vaoExtension&&(this._vao=this._vaoExtension.createVertexArrayOES(),this._vaoExtension.bindVertexArrayOES(this._vao)),e.vertexAttribPointer(0,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(0)),eH()}_prepareConversionShader(e){let t,r=this._gl,i=e===A.PLANAR_UV,a=r.createProgram();if(!a)throw Error("Couldn't create program");let s=(0,D.R)(r,r.VERTEX_SHADER,eY),n=this._isWebGL2?"r":"a",o=this._isWebGL2?"g":"a";switch(e){case A.INTERLEAVED_UV:t=eX(n,"r",o);break;case A.INTERLEAVED_VU:t=eX(n,o,"r");break;case A.PLANAR_UV:t=eZ(n)}let l=(0,D.R)(r,r.FRAGMENT_SHADER,t);r.attachShader(a,s),r.attachShader(a,l),r.bindAttribLocation(a,0,"aPosition"),(0,D.i)(r,a);let _=r.getUniformLocation(a,"uYSampler"),c=i?null:r.getUniformLocation(a,"uUVSampler"),d=i?r.getUniformLocation(a,"uUSampler"):null,h=i?r.getUniformLocation(a,"uVSampler"):null,u=r.getError();u!=r.NO_ERROR&&eh(`YUVConversion: Error before setting uniforms: 0x${u.toString(16)}`),r.useProgram(a),r.uniform1i(_,0),r.uniform1i(i?d:c,1),i&&r.uniform1i(h,2),(u=r.getError())!=r.NO_ERROR&&eh(`YUVConversion: Error after setting uniforms: 0x${u.toString(16)}`),this._conversionShaders[e]={program:a,aPositionLoc:r.getAttribLocation(a,"aPosition")}}_prepareTextures(e,t,r){let i=this._gl;if(this._yTexture&&this._yTexture.width==e.width&&this._yTexture.height==e.height||(eq("YUV: Creating Y texture"),this._yTexture&&i.deleteTexture(this._yTexture.texture),this._yTexture=this._createSizedTexture(e.width,e.height,this._oneComponentInternalFormat,this._oneComponentFormat),eH()),!this._uvTexture||this._uvTexture.width!=t.width||this._uvTexture.height!=t.height||this._uvTextureSinglePlane!=r){eq("YUV: Creating UV texture"),this._uvTexture&&i.deleteTexture(this._uvTexture.texture);let e=r?this._oneComponentInternalFormat:this._twoComponentInternalFormat,a=r?this._oneComponentFormat:this._twoComponentFormat;this._uvTexture=this._createSizedTexture(t.width,t.height,e,a),this._uvTextureSinglePlane=r,eH()}r&&(this._vTexture&&this._vTexture.width==t.width&&this._vTexture.height==t.height||(eq("YUV: Creating V texture"),this._vTexture&&i.deleteTexture(this._vTexture.texture),this._vTexture=this._createSizedTexture(t.width,t.height,this._oneComponentInternalFormat,this._oneComponentFormat),eH()))}_createSizedTexture(e,t,r,i){let a=this._gl,s=a.createTexture();return s?(a.bindTexture(a.TEXTURE_2D,s),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),this._isWebGL2?a.texStorage2D(a.TEXTURE_2D,1,r,e,t):a.texImage2D(a.TEXTURE_2D,0,r,e,t,0,i,a.UNSIGNED_BYTE,null),{texture:s,width:e,height:t,format:i,internalFormat:r}):null}}let eY=`
    attribute vec4 aPosition;
    varying highp vec2 vUV;

    void main(void) {
      gl_Position = aPosition;
      vUV = 0.5 * (aPosition.xy + vec2(1.0, 1.0));
    }
`,eX=(e,t,r)=>`
  varying highp vec2 vUV;

  uniform sampler2D uYSampler;
  uniform sampler2D uUVSampler;

  void main(void) {
    mediump vec4 uv = texture2D(uUVSampler, vUV);
    mediump vec3 ycbcr = vec3(texture2D(uYSampler, vUV).${e}, uv.${t} - 0.5, uv.${r} - 0.5);
    const mediump mat3 ycbcrToRgb = mat3(1.0000,  1.0000, 1.0000,
                                         0.0000, -0.3441, 1.7720,
                                         1.4020, -0.7141, 0.0000);

    gl_FragColor = vec4(ycbcrToRgb * ycbcr, 1.0);
  }
`,eZ=e=>`
  varying highp vec2 vUV;

  uniform sampler2D uYSampler;
  uniform sampler2D uUSampler;
  uniform sampler2D uVSampler;

  void main(void) {
    mediump vec3 ycbcr = vec3(
        texture2D(uYSampler, vUV).${e},
        texture2D(uUSampler, vUV).${e} - 0.5,
        texture2D(uVSampler, vUV).${e} - 0.5);
    const mediump mat3 ycbcrToRgb = mat3(1.0000,  1.0000, 1.0000,
                                         0.0000, -0.3441, 1.7720,
                                         1.4020, -0.7141, 0.0000);

    gl_FragColor = vec4(ycbcrToRgb * ycbcr, 1.0);
  }
`,e$=new TextDecoder,eK=new Uint8Array([90,80,82,77]),eQ=new Uint16Array(eK.buffer),eJ=new Uint32Array(eK.buffer)[0];function e0(e){return!(e.length<16)&&e.charCodeAt(0)===eQ[0]&&e.charCodeAt(1)===eQ[1]}let e1=new Uint32Array(1),e4=new Uint16Array(e1.buffer),e2=e=>{},e3=()=>{},e5=/^zprreply:(\d{1,12}):(?:0:|(1):(?:(\d{1,12}):|$))/;class e7{constructor(){this._messageId=0,this._replyResolvers=new Map,this._queuedMessages=[],this._processMessage=e=>{if("string"==typeof e.data){e2("ABMH: processStringMessage"),this._processStringMessage(e.data),e3();return}"object"==typeof e.data&&e.data instanceof ArrayBuffer&&(e2("ABMH: processArrayBufferMessage"),this._processArrayBufferMessage(e.data),e3())},this._initRequested=!1}static IsSupported(){return!!globalThis.zprCameraBridge}static SharedInstance(){return null==e7._instance&&(e7._instance=new e7),e7._instance}postMessage(e){var t,r,i,a;return t=this,r=void 0,i=void 0,a=function*(){e2("ABMH: postMessage");let t=`zpr:${this._messageId}:${e}`,r=new Promise((e,t)=>{this._replyResolvers.set(this._messageId,{resolve:e,reject:t})});return this._nativePort?this._nativePort.postMessage(t):(this._queuedMessages.push(t),this._initPort()),this._messageId++,e3(),r},new(i||(i=Promise))(function(e,s){function n(e){try{l(a.next(e))}catch(e){s(e)}}function o(e){try{l(a.throw(e))}catch(e){s(e)}}function l(t){var r;t.done?e(t.value):((r=t.value)instanceof i?r:new i(function(e){e(r)})).then(n,o)}l((a=a.apply(t,r||[])).next())})}_processStringMessage(e){if(e0(e)){let t=e.length<16?0xffffffff:(e4[0]=e.charCodeAt(2),e4[1]=e.charCodeAt(3),e1[0]),r=this._replyResolvers.get(t);if(!r)return;this._replyResolvers.delete(t),r.resolve(e);return}let t=e.match(e5);if(!t)return;let r=t[0].length,i=Number.parseInt(t[1]),a=this._replyResolvers.get(i);if(!a)return;if(this._replyResolvers.delete(i),"1"!==t[2])return void a.reject(Error(e.substring(r)));if(void 0===t[3])return void a.resolve();let s=r+Number.parseInt(t[3]);if(s==e.length)return void a.resolve(e.substring(r));let n=e.substring(r,s);e2("ABMH: ArrayBufferFromString");let o=new ArrayBuffer(2*e.length);eG(o,e),e3();let l=2*s,_={stringData:n,arrayBuffer:o,byteDataOffset:l=l+15>>4<<4};a.resolve(_)}_processArrayBufferMessage(e){if(e.byteLength<32)return;let t=new Uint32Array(e,0,2);if(t[0]!==eJ)return;let r=t[1],i=this._replyResolvers.get(r);i&&(this._replyResolvers.delete(r),i.resolve(e))}_initPort(){if(this._initRequested)return;this._initRequested=!0;let e=t=>{if("zprCameraBridgePort"===t.data&&t.ports.length>0){for(let e of(this._nativePort=t.ports[0],this._queuedMessages))this._nativePort.postMessage(e);this._queuedMessages=[],window.removeEventListener("message",e),window.addEventListener("message",this._processMessage)}};window.addEventListener("message",e);let t=window.origin||document.location.origin;window.zprCameraBridge.requestMessageChannel(t)}}e7._instance=null;let e6=new Uint8Array(0);class e8{constructor(){this._latestId=1,this._wtStateById=new Map,this._anchorStateById=new Map,this._identityPose=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this._emptyArray=new Float32Array([]),this.impl={world_tracker_create:e=>{let t=eN.get(e);if(!t)throw Error("Invalid pipeline in world_tracker_create");let r=this._latestId++,i={pipeline:t,enabled:!0,horizontal_plane_detection_enabled:!0,vertical_plane_detection_enabled:!1,world_anchor_id:"world",ground_anchor_id:"ground",tracks_data_enabled:!1,projections_data_enabled:!1,mesh_anchors_enabled:!1};return this._wtStateById.set(r,i),this._notifyOptionsUpdated(i.pipeline),r},world_tracker_destroy:e=>{this._getWtState(e),this._wtStateById.delete(e)},world_tracker_enabled:e=>this._getWtState(e).enabled,world_tracker_enabled_set:(e,t)=>{let r=this._getWtState(e);r.enabled=t,this._notifyOptionsUpdated(r.pipeline)},world_tracker_session_number:e=>{let t=this._getWtData(e),r=null==t?void 0:t.session_number;return void 0===r?0:r},world_tracker_quality:e=>{let t=this._getWtData(e);return t?t.quality:3},world_tracker_horizontal_plane_detection_enabled:e=>this._getWtState(e).horizontal_plane_detection_enabled,world_tracker_horizontal_plane_detection_enabled_set:(e,t)=>{let r=this._getWtState(e);r.horizontal_plane_detection_enabled=t,this._notifyOptionsUpdated(r.pipeline)},world_tracker_vertical_plane_detection_enabled:e=>this._getWtState(e).vertical_plane_detection_enabled,world_tracker_vertical_plane_detection_enabled_set:(e,t)=>{let r=this._getWtState(e);r.vertical_plane_detection_enabled=t,this._notifyOptionsUpdated(r.pipeline)},world_tracker_plane_anchor_count:e=>{let t=this._getWtData(e),r=null==t?void 0:t.plane_anchors;return r?r.length:0},world_tracker_plane_anchor_id:(e,t)=>{var r,i,a;let s=this._getWtData(e);return null!=(a=null==(i=null==(r=null==s?void 0:s.plane_anchors)?void 0:r[t])?void 0:i.id)?a:""},world_tracker_plane_anchor_pose_raw:(e,t)=>{var r,i;let a=this._getWtData(e),s=null==(i=null==(r=null==a?void 0:a.plane_anchors)?void 0:r[t])?void 0:i.pose;return void 0===s?this._identityPose:(Array.isArray(s)&&(s=new Float32Array(s),a.plane_anchors[t].pose=s),s)},world_tracker_plane_anchor_status:(e,t)=>{var r,i,a,s;return null!=(s=null==(a=null==(i=null==(r=this._getWtData(e))?void 0:r.plane_anchors)?void 0:i[t])?void 0:a.status)?s:I.uI.ANCHOR_STATUS_STOPPED},world_tracker_plane_anchor_polygon_data_size:(e,t)=>{var r,i,a,s,n;return null!=(n=null==(s=null==(a=null==(i=null==(r=this._getWtData(e))?void 0:r.plane_anchors)?void 0:i[t])?void 0:a.boundary)?void 0:s.length)?n:0},world_tracker_plane_anchor_polygon_data:(e,t)=>{var r,i,a;let s=null==(a=null==(i=null==(r=this._getWtData(e))?void 0:r.plane_anchors)?void 0:i[t])?void 0:a.boundary;return s?(Array.isArray(s)&&(s=new Float32Array(s),this._getWtData(e).plane_anchors[t].boundary=s),s):this._emptyArray},world_tracker_plane_anchor_polygon_version:(e,t)=>{var r,i,a,s;return null!=(s=null==(a=null==(i=null==(r=this._getWtData(e))?void 0:r.plane_anchors)?void 0:i[t])?void 0:a.boundaryVersion)?s:0},world_tracker_plane_anchor_orientation:(e,t)=>{var r,i,a,s;return null==(s=null==(a=null==(i=null==(r=this._getWtData(e))?void 0:r.plane_anchors)?void 0:i[t])?void 0:a.horizontal)||s?I.z0.PLANE_ORIENTATION_HORIZONTAL:I.z0.PLANE_ORIENTATION_VERTICAL},world_tracker_world_anchor_status:e=>{var t,r;return null!=(r=null==(t=this._getWtData(e))?void 0:t.world_anchor_status)?r:I.uI.ANCHOR_STATUS_INITIALIZING},world_tracker_world_anchor_id:e=>this._getWtState(e).world_anchor_id,world_tracker_world_anchor_pose_raw:e=>{let t=this._getWtData(e),r=null==t?void 0:t.world_anchor_pose;return void 0===r?this._identityPose:(Array.isArray(r)&&(t.world_anchor_pose=r=new Float32Array(r)),r)},world_tracker_ground_anchor_status:e=>{var t,r;return null!=(r=null==(t=this._getWtData(e))?void 0:t.ground_anchor_status)?r:I.uI.ANCHOR_STATUS_INITIALIZING},world_tracker_ground_anchor_id:e=>this._getWtState(e).ground_anchor_id,world_tracker_ground_anchor_pose_raw:e=>{let t=this._getWtData(e),r=null==t?void 0:t.ground_anchor_pose;return void 0===r?this._identityPose:(Array.isArray(r)&&(t.ground_anchor_pose=r=new Float32Array(r)),r)},world_tracker_reset:e=>{let t=this._getWtState(e).pipeline.currentCameraSource;t instanceof tr&&t.resetTracking()},world_tracker_tracks_data_enabled:e=>this._getWtState(e).tracks_data_enabled,world_tracker_tracks_data_enabled_set:(e,t)=>{let r=this._getWtState(e);r.tracks_data_enabled=t,this._notifyOptionsUpdated(r.pipeline)},world_tracker_tracks_data_size:e=>(this._getWtState(e),0),world_tracker_tracks_data:e=>(this._getWtState(e),this._emptyArray),world_tracker_tracks_type_data_size:e=>(this._getWtState(e),0),world_tracker_tracks_type_data:e=>e6,world_tracker_projections_data_enabled:e=>this._getWtState(e).projections_data_enabled,world_tracker_projections_data_enabled_set:(e,t)=>{let r=this._getWtState(e);r.projections_data_enabled=t,this._notifyOptionsUpdated(r.pipeline)},world_tracker_projections_data_size:e=>(this._getWtState(e),0),world_tracker_projections_data:e=>(this._getWtState(e),this._emptyArray),custom_anchor_create:(e,t,r)=>{let i=this._latestId++,a={pipeline:this._getWtState(t).pipeline,wt:t,pose_version:0,anchor_id:r};return this._anchorStateById.set(i,a),i},custom_anchor_destroy:e=>{this._getAnchorState(e),this._anchorStateById.delete(e)},custom_anchor_status:e=>{var t,r;let i=this._getAnchorState(e),a=this._getWtDataFromPipeline(i.pipeline),s=(null!=(t=null==a?void 0:a.custom_anchors)?t:[]).find(t=>t.id===e);return null!=(r=null==s?void 0:s.status)?r:I.uI.ANCHOR_STATUS_INITIALIZING},custom_anchor_pose_version:e=>{var t,r;let i=this._getAnchorState(e),a=this._getWtDataFromPipeline(i.pipeline),s=(null!=(t=null==a?void 0:a.custom_anchors)?t:[]).find(t=>t.id===e);return null!=(r=null==s?void 0:s.poseVersion)?r:-1},custom_anchor_pose_raw:e=>{var t;let r=this._getAnchorState(e),i=this._getWtDataFromPipeline(r.pipeline),a=(null!=(t=null==i?void 0:i.custom_anchors)?t:[]).find(t=>t.id===e);if(!a)return this._identityPose;let s=null==a?void 0:a.pose;return void 0===s?this._identityPose:(Array.isArray(s)&&(a.pose=s=new Float32Array(s)),s)},custom_anchor_pose_set:(e,t)=>{var r,i;let a=this._getAnchorState(e);a.pose_version++;let s=null==(i=null==(r=a.pipeline)?void 0:r.getCurrentCameraInfo())?void 0:i.cameraSource;s instanceof tr&&s.setCustomAnchorPose(e,a.pose_version,t)},custom_anchor_pose_set_with_parent:(e,t,r)=>{var i,a;null==(a=(i=this.impl).custom_anchor_pose_set)||a.call(i,e,t)},world_tracker_mesh_anchor_count:e=>{var t,r;let i=this._getWtData(e);return null!=(r=null==(t=null==i?void 0:i.mesh_anchors)?void 0:t.length)?r:0},world_tracker_mesh_anchor_id:(e,t)=>{var r,i,a;let s=this._getWtData(e);return null!=(a=null==(i=null==(r=null==s?void 0:s.mesh_anchors)?void 0:r[t])?void 0:i.id)?a:""},world_tracker_mesh_anchor_indices:(e,t)=>{var r,i;let a=this._getWtData(e),{binaryLength:s,binaryOffset:n}=null==(i=null==(r=null==a?void 0:a.mesh_anchors)?void 0:r[t])?void 0:i.indices;if(void 0===s||void 0===n)return new Uint32Array;let o=this._getFrameData(e);return o?o.uint32ArrayForBinaryBufferOffset(n,s):new Uint32Array},world_tracker_mesh_anchor_indices_count:(e,t)=>{var r,i,a;let s=this._getWtData(e);return null!=(a=null==(i=null==(r=null==s?void 0:s.mesh_anchors)?void 0:r[t])?void 0:i.indices.count)?a:0},world_tracker_mesh_anchor_indices_size:(e,t)=>{var r,i,a;return null!=(a=null==(i=(r=this.impl).world_tracker_mesh_anchor_indices)?void 0:i.call(r,e,t).byteLength)?a:0},world_tracker_mesh_anchor_vertices:(e,t)=>{var r,i;let a=this._getWtData(e),{binaryLength:s,binaryOffset:n}=null==(i=null==(r=null==a?void 0:a.mesh_anchors)?void 0:r[t])?void 0:i.vertices;if(void 0===s||void 0===n)return new Float32Array;let o=this._getFrameData(e);return o?o.floatArrayForBinaryBufferOffset(n,s):new Float32Array},world_tracker_mesh_anchor_vertices_count:(e,t)=>{var r,i,a;let s=this._getWtData(e);return null!=(a=null==(i=null==(r=null==s?void 0:s.mesh_anchors)?void 0:r[t])?void 0:i.vertices.count)?a:0},world_tracker_mesh_anchor_vertices_size:(e,t)=>{var r,i,a;return null!=(a=null==(i=(r=this.impl).world_tracker_mesh_anchor_vertices)?void 0:i.call(r,e,t).byteLength)?a:0},world_tracker_mesh_anchor_vertices_offset:(e,t)=>{var r,i,a;let s=this._getWtData(e);return null!=(a=null==(i=null==(r=null==s?void 0:s.mesh_anchors)?void 0:r[t])?void 0:i.vertices.offset)?a:0},world_tracker_mesh_anchor_vertices_stride:(e,t)=>{var r,i,a;let s=this._getWtData(e);return null!=(a=null==(i=null==(r=null==s?void 0:s.mesh_anchors)?void 0:r[t])?void 0:i.vertices.stride)?a:0},world_tracker_mesh_anchor_pose_raw:(e,t)=>{var r,i;let a=this._getWtData(e),s=null==(i=null==(r=null==a?void 0:a.mesh_anchors)?void 0:r[t])?void 0:i.pose;return void 0===s?this._identityPose:(Array.isArray(s)&&(s=new Float32Array(s),a.mesh_anchors[t].pose=s),s)},world_tracker_mesh_anchor_status:(e,t)=>{var r,i,a;let s=this._getWtData(e);return null!=(a=null==(i=null==(r=null==s?void 0:s.mesh_anchors)?void 0:r[t])?void 0:i.status)?a:I.uI.ANCHOR_STATUS_STOPPED},world_tracker_mesh_anchors_enabled:e=>this._getWtState(e).mesh_anchors_enabled,world_tracker_mesh_anchors_enabled_set:(e,t)=>{let r=this._getWtState(e);r.mesh_anchors_enabled=t,this._notifyOptionsUpdated(r.pipeline)}}}static IsSupported(){return tr.IsSupported()}static SharedInstance(){return this._sharedInstance||(this._sharedInstance=new e8),this._sharedInstance}_getWtState(e){let t=this._wtStateById.get(e);if(!t)throw Error("This object has been destroyed");return t}_getAnchorState(e){let t=this._anchorStateById.get(e);if(!t)throw Error("This object has been destroyed");return t}_getWtDataFromPipeline(e){var t,r,i;return null==(i=null==(r=null==(t=null==e?void 0:e.getCurrentCameraInfo())?void 0:t.cameraSourceData)?void 0:r.frameInfo)?void 0:i.wtData}_getWtData(e){let t=this._getWtState(e);return this._getWtDataFromPipeline(t.pipeline)}_getFrameData(e){var t,r,i;let a=this._getWtState(e);return null==(i=null==(r=null==(t=null==a?void 0:a.pipeline)?void 0:t.getCurrentCameraInfo())?void 0:r.cameraSourceData)?void 0:i.frameData}_notifyOptionsUpdated(e){e.currentCameraSource instanceof tr&&e.currentCameraSource.optionsUpdated(this.getCombinedOptionsForPipeline(e))}getCombinedOptionsForPipeline(e){let t={};for(let r of this._wtStateById.values())r.pipeline==e&&r.enabled&&(t.worldTracking=!0,r.horizontal_plane_detection_enabled&&(t.horizontalPlaneDetection=!0),r.vertical_plane_detection_enabled&&(t.verticalPlaneDetection=!0),r.tracks_data_enabled&&(t.tracksData=!0),r.projections_data_enabled&&(t.projectionsData=!0),r.mesh_anchors_enabled&&(t.meshAnchors=!0));return t}}e8._sharedInstance=null;class e9{constructor(){this._latestId=1,this._d3StateById=new Map,this._identityPose=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this._emptyArray=new Float32Array([]),this.impl={d3_tracker_create:e=>{let t=eN.get(e);if(!t)throw Error("Invalid pipeline in d3_tracker_create");let r=this._latestId++,i={pipeline:t,enabled:!0,sizeById:Object.create(null),maxResolution:!1};return this._d3StateById.set(r,i),this._notifyOptionsUpdated(i.pipeline),r},d3_tracker_destroy:e=>{this._getD3State(e),this._d3StateById.delete(e)},d3_tracker_enabled:e=>this._getD3State(e).enabled,d3_tracker_enabled_set:(e,t)=>{let r=this._getD3State(e);r.enabled=t,this._notifyOptionsUpdated(r.pipeline)},d3_tracker_process_max_resolution_set:(e,t)=>{let r=this._getD3State(e);r.maxResolution=t,this._notifyOptionsUpdated(r.pipeline)},d3_tracker_count:e=>{var t,r;let i=this._getD3Data(e);return Array.isArray(null==i?void 0:i.detections)&&null!=(r=null==(t=null==i?void 0:i.detections)?void 0:t.length)?r:0},d3_tracker_id:(e,t)=>{var r,i,a;let s=this._getD3Data(e);return null!=(a=null==(i=null==(r=null==s?void 0:s.detections)?void 0:r[t])?void 0:i.id)?a:""},d3_tracker_qr:(e,t)=>{var r,i,a;let s=this._getD3Data(e);return null!=(a=null==(i=null==(r=null==s?void 0:s.detections)?void 0:r[t])?void 0:i.qr)?a:""},d3_tracker_pose_raw:(e,t)=>this.impl.d3_tracker_pose0_raw(e,t),d3_tracker_pose0_raw:(e,t)=>{var r,i,a,s,n,o;let l=this._getD3Data(e),_=null==(a=null==(i=null==(r=null==l?void 0:l.detections)?void 0:r[t])?void 0:i.worldPoses)?void 0:a[0];if(!_)return this._identityPose;Array.isArray(_)&&(_=new Float32Array(_));let c=null==l?void 0:l.worldToCamera;c||this._identityPose,Array.isArray(c)&&(c=new Float32Array(c),l&&(l.worldToCamera=c));let d=z.vt();z.lw(d,c,_);let h=this._getD3State(e),u=null==(n=null==(s=null==l?void 0:l.detections)?void 0:s[t])?void 0:n.id;if(u&&u.length>0){let e=.5*(null!=(o=h.sizeById[u])?o:2);d[12]*=e,d[13]*=e,d[14]*=e}return d},d3_tracker_pose1_raw:(e,t)=>{var r,i,a,s,n,o;let l=this._getD3Data(e),_=null==(a=null==(i=null==(r=null==l?void 0:l.detections)?void 0:r[t])?void 0:i.worldPoses)?void 0:a[1];if(!_)return this._identityPose;Array.isArray(_)&&(_=new Float32Array(_));let c=null==l?void 0:l.worldToCamera;c||this._identityPose,Array.isArray(c)&&(c=new Float32Array(c),l&&(l.worldToCamera=c));let d=z.vt();z.lw(d,c,_);let h=this._getD3State(e),u=null==(n=null==(s=null==l?void 0:l.detections)?void 0:s[t])?void 0:n.id;if(u&&u.length>0){let e=.5*(null!=(o=h.sizeById[u])?o:2);d[12]*=e,d[13]*=e,d[14]*=e}return d},d3_tracker_landmarks_data:(e,t)=>{var r,i;let a=this._getD3Data(e),s=null==(i=null==(r=null==a?void 0:a.detections)?void 0:r[t])?void 0:i.landmarks;return s?(Array.isArray(s)&&(s=new Float32Array(s),a.detections[t].landmarks=s),s):this._emptyArray},d3_tracker_landmarks_data_size:(e,t)=>{var r,i,a,s;let n=this._getD3Data(e);return null!=(s=null==(a=null==(i=null==(r=null==n?void 0:n.detections)?void 0:r[t])?void 0:i.landmarks)?void 0:a.length)?s:0},d3_tracker_type:(e,t)=>{var r,i,a;let s=this._getD3Data(e);return null!=(a=null==(i=null==(r=null==s?void 0:s.detections)?void 0:r[t])?void 0:i.type)?a:0},d3_tracker_dense:(e,t)=>{var r,i,a;let s=this._getD3Data(e);return null!=(a=null==(i=null==(r=null==s?void 0:s.detections)?void 0:r[t])?void 0:i.dense)?a:0},d3_tracker_size_for_id_set:(e,t,r)=>{this._getD3State(e).sizeById[t]=r}}}static IsSupported(){return tr.IsSupported()}static SharedInstance(){return this._sharedInstance||(this._sharedInstance=new e9),this._sharedInstance}_getD3State(e){let t=this._d3StateById.get(e);if(!t)throw Error("This object has been destroyed");return t}_getD3DataFromPipeline(e){var t,r,i;return null==(i=null==(r=null==(t=null==e?void 0:e.getCurrentCameraInfo())?void 0:t.cameraSourceData)?void 0:r.frameInfo)?void 0:i.d3Data}_getD3Data(e){let t=this._getD3State(e);return this._getD3DataFromPipeline(t.pipeline)}_notifyOptionsUpdated(e){e.currentCameraSource instanceof tr&&e.currentCameraSource.optionsUpdated(this.getCombinedOptionsForPipeline(e))}getCombinedOptionsForPipeline(e){let t={};for(let r of this._d3StateById.values())r.pipeline===e&&r.enabled&&(t.d3=!0,r.maxResolution&&(t.d3MaxResolution=!0));return t}}e9._sharedInstance=null;let te=e=>{},tt=()=>{};class tr extends eg{constructor(e,t,r){var i,a;if(super(),this._impl=e,this._pipeline=t,this._deviceId=r,this._isPaused=!0,this._cameraToScreenRotation=0,this._cameraToDeviceTransform=z.vt(),this._cameraModel=new Float32Array([1200,1200,639.5,359.5,0,0]),this._profile=I.HE.DEFAULT,this._textureSizes=new Map,this._decodeBuffers=[],this._options={},this._isAndroid=!1,this._frameInFlight=!1,this._anchorPoseFloat32=new Float32Array(16),this._anchorPoseUint16=new Uint16Array(this._anchorPoseFloat32.buffer),this._lastTimestamp=-1,this._deviceMotionListener=e=>{let t=eN.get(this._pipeline);if(!t)return;let r=void 0!==e.timeStamp&&null!==e.timeStamp?e.timeStamp:performance.now(),i=e.interval*V.M.intervalMultiplier;V.M.trustSensorIntervals&&(-1===this._lastTimestamp?this._lastTimestamp=r:(this._lastTimestamp+=i,r=this._lastTimestamp)),null!==e.acceleration&&null!==e.acceleration.x&&null!==e.acceleration.y&&null!==e.acceleration.z&&t.motionAccelerometerWithoutGravitySubmitInt(r,i,e.acceleration.x*V.M.deviceMotionMutliplier,e.acceleration.y*V.M.deviceMotionMutliplier,e.acceleration.z*V.M.deviceMotionMutliplier),null!==e.accelerationIncludingGravity&&null!==e.accelerationIncludingGravity.x&&null!==e.accelerationIncludingGravity.y&&null!==e.accelerationIncludingGravity.z&&(t.motionAccelerometerSubmit(r,e.accelerationIncludingGravity.x*V.M.deviceMotionMutliplier,e.accelerationIncludingGravity.y*V.M.deviceMotionMutliplier,e.accelerationIncludingGravity.z*V.M.deviceMotionMutliplier),t.motionAccelerometerWithGravitySubmitInt(r,i,e.accelerationIncludingGravity.x*V.M.deviceMotionMutliplier,e.accelerationIncludingGravity.y*V.M.deviceMotionMutliplier,e.accelerationIncludingGravity.z*V.M.deviceMotionMutliplier)),null!==e.rotationRate&&null!==e.rotationRate.alpha&&null!==e.rotationRate.beta&&null!==e.rotationRate.gamma&&(t.motionRotationRateSubmit(r,-(e.rotationRate.alpha*Math.PI/180),-(e.rotationRate.beta*Math.PI/180),-(e.rotationRate.gamma*Math.PI/180)),t.motionRotationRateSubmitInt(r,i,e.rotationRate.alpha,e.rotationRate.beta,e.rotationRate.gamma))},this._deviceOrientationListener=e=>{let t=eN.get(this._pipeline);if(!t)return;let r=void 0!==e.timeStamp&&null!==e.timeStamp?e.timeStamp:performance.now();null!==e.alpha&&null!==e.beta&&null!==e.gamma&&t.motionAttitudeSubmitInt(r,0,e.alpha,e.beta,e.gamma)},e7.IsSupported()?(this._messageHandler=e7.SharedInstance(),this._isAndroid=!0):this._messageHandler=null==(a=null==(i=window.webkit)?void 0:i.messageHandlers)?void 0:a.bridgedCamera,!this._messageHandler)throw Error("bridgedCamera message handler not found");eh("Using bridged camera source")}static IsSupported(){var e,t;let r=!!(null==(t=null==(e=window.webkit)?void 0:e.messageHandlers)?void 0:t.bridgedCamera),i=e7.IsSupported();return r||i}destroy(){this.pause(),eD(this._impl)}pause(){this._isPaused=!0;let e=eN.get(this._pipeline);e&&e.currentCameraSource===this&&(e.currentCameraSource=void 0),this._decodeBuffers=[],this._stopDeviceMotion(),this._isAndroid&&tr._resetCount++,this._messageHandler.postMessage("stop")}start(){var e;let t=eN.get(this._pipeline);t&&t.currentCameraSource!==this&&(null==(e=t.currentCameraSource)||e.pause(),t.currentCameraSource=this),this._textureSizes.clear(),this._isPaused=!1,this._startDeviceMotion();let r={};t&&(r=Object.assign(Object.assign({},e8.SharedInstance().getCombinedOptionsForPipeline(t)),e9.SharedInstance().getCombinedOptionsForPipeline(t))),!this._isAndroid&&tr._resetCount++,this._messageHandler.postMessage(`start${this._convertToBitmask(r)}:${this._profile}`)}getFrame(e){var t,r;let i=W(!1);i!=this._cameraToScreenRotation&&(null==(r=null==(t=eN.get(this._pipeline))?void 0:t.sendCameraToScreenRotationToWorker)||r.call(t,i),this._cameraToScreenRotation=i),e||this._processFrame()}_processFrame(){var e,t,r,i;return e=this,t=void 0,r=void 0,i=function*(){let e,t,r,i,a,s;if(this._frameInFlight)return;te("BCS: processFrame - request frameData"),this._frameInFlight=!0;let n=this._messageHandler.postMessage("frameData");tt();try{e=yield n}catch(e){this._frameInFlight=!1;return}if(this._frameInFlight=!1,!e)return;if("object"==typeof e&&e instanceof ArrayBuffer)r=e;else{if(!("string"==typeof e&&e0(e)))return void eh("BridgedCameraSource: Unexpected reply to frameData message");for(te("BCS: processFrame - convert string to ArrayBuffer"),t=this._decodeBuffers.pop();t&&!(2*e.length<=t.byteLength);)t=this._decodeBuffers.pop();t||(t=new ArrayBuffer(2*e.length+1024)),eG(r=t,e),tt()}if(this._isPaused)return void eh("BridgedCameraSource: Dropping frame - source paused");let o=eN.get(this._pipeline);if(!o)return;te("BCS: processFrame - frameData received"),te("parseBridgeArrayBuffer");let l=function(e){if(e.byteLength<32)return;let t=0,r=new Uint32Array(e);if(r[0]!==eJ)return;let i=r[(t+=4)>>2],a=r[(t+=4)>>2],s=new Uint8Array(e,t+=4,a),n=JSON.parse(e$.decode(s));return t+=a,r[(t=t+15>>4<<4)>>2],t+=4,t+=12,{replyID:i,json:n,uint8ArrayForBinaryBufferOffset:(r,i)=>new Uint8Array(e,t+r,i),floatArrayForBinaryBufferOffset:(r,i)=>new Float32Array(e,t+r,i/4),uint32ArrayForBinaryBufferOffset:(r,i)=>new Uint32Array(e,t+r,i/4)}}(r);if(tt(),!l){eh("BridgedCameraSource: Failed to parse frameData reply ArrayBuffer"),tt();return}let _=l.json;_.cameraModel&&this._cameraModel.set(_.cameraModel),"session_number"in _.wtData||(_.wtData.session_number=tr._resetCount),te(`Prepare CameraFrameInfo ${_.frameNo||0}`);let c=_.dataWidth*_.dataHeight,d=o.cameraPixelArrays.pop();for(;d&&d.byteLength!==c;)d=o.cameraPixelArrays.pop();d||(d=new ArrayBuffer(c)),new Uint8Array(d).set(l.uint8ArrayForBinaryBufferOffset(_.dataBinaryBufferOffset,_.dataBinaryBufferLength));let h=_.previewBinaryBufferOffset;if(_.dataWidth===_.yWidth&&_.dataHeight===_.yHeight)i=l.uint8ArrayForBinaryBufferOffset(_.dataBinaryBufferOffset,_.dataBinaryBufferLength);else{let e=_.yWidth*_.yHeight;i=l.uint8ArrayForBinaryBufferOffset(_.previewBinaryBufferOffset,e),h+=e}if(_.uvLayout===A.PLANAR_UV){let e=h,t=_.uvWidth*_.uvHeight,r=h+t;a=l.uint8ArrayForBinaryBufferOffset(e,t),s=l.uint8ArrayForBinaryBufferOffset(r,t)}else{let e=_.uvWidth*_.uvHeight*2;a=l.uint8ArrayForBinaryBufferOffset(h,e)}let u={data:d,texture:void 0,dataWidth:_.dataWidth,dataHeight:_.dataHeight,cameraModel:this._cameraModel,cameraToDevice:this._cameraToDeviceTransform,cameraSource:this,cameraSourceData:{decodeBuffer:t,frameData:l,frameInfo:_,yData:i,uvData:a,vData:s},userFacing:!1};tt(),te("Send to worker");let m=o.registerToken(u);o.sendDataToWorker(u.data,m,u.dataWidth,u.dataHeight,u.userFacing,u.cameraToDevice,u.cameraModel,performance.now()/1e3),u.data=void 0,tt(),tt()},new(r||(r=Promise))(function(a,s){function n(e){try{l(i.next(e))}catch(e){s(e)}}function o(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(n,o)}l((i=i.apply(e,t||[])).next())})}uploadGL(e){if(!e||!e.data||!e.cameraSourceData)return;let t=e.cameraSourceData;if(e.texture)return;let r=eN.get(this._pipeline);if(!r)return;let i=null==r?void 0:r.glContext;if(!i)return;let a=r.getVideoTexture();if(!a)return;let{yWidth:s,yHeight:n,uvWidth:o,uvHeight:l,uvLayout:_}=t.frameInfo;if(!s||!n||!o||!l)return;void 0===_&&(_=0);let c={width:s,height:n,data:t.yData},d={width:o,height:l,data:t.uvData,dataVPlane:t.vData},h=this._textureSizes.get(a);if(!h||h[0]!=c.width||h[1]!=c.height){te("Resize camera texture");let e=i.getParameter(i.TEXTURE_BINDING_2D);i.bindTexture(i.TEXTURE_2D,a),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,c.width,c.height,0,i.RGBA,i.UNSIGNED_BYTE,null),i.bindTexture(i.TEXTURE_2D,e),this._textureSizes.set(a,[c.width,c.height]),tt(),eh(`BridgedCameraSource: Resized a texture, elements in map ${this._textureSizes.size}`)}te("YUV to Texture"),this._yuvConversion||(this._yuvConversion=new ej(i)),this._yuvConversion.yuvToTexture(c,d,_,a),tt(),e.texture=a}recycle(e){var t;if(this._isPaused||this._decodeBuffers.length>=2)return;let r=null==(t=e.cameraSourceData)?void 0:t.decodeBuffer;r&&this._decodeBuffers.push(r)}setProfile(e){this._profile!==e&&(this._profile=e,this._isPaused||this._messageHandler.postMessage(`setProfile${this._profile}`))}setCustomAnchorPose(e,t,r){let i=`setCustomAnchorPose${e}:${t}:`;this._anchorPoseFloat32.set(r),i+=String.fromCharCode(...this._anchorPoseUint16),this._messageHandler.postMessage(i)}resetTracking(){tr._resetCount++,this._messageHandler.postMessage("resetTracking")}_convertToBitmask(e){let t=0;return e.worldTracking&&(t|=1),e.horizontalPlaneDetection&&(t|=2),e.verticalPlaneDetection&&(t|=4),e.tracksData&&(t|=8),e.projectionsData&&(t|=16),e.meshAnchors&&(t|=32),e.d3&&(t|=64),e.d3MaxResolution&&(t|=128),t}optionsUpdated(e){this._messageHandler.postMessage(`setOptions${this._convertToBitmask(e)}`)}_startDeviceMotion(){window.addEventListener("devicemotion",this._deviceMotionListener),window.addEventListener("deviceorientation",this._deviceOrientationListener)}_stopDeviceMotion(){window.removeEventListener("devicemotion",this._deviceMotionListener),window.removeEventListener("deviceorientation",this._deviceOrientationListener)}}tr.DEFAULT_DEVICE_ID="Simulated Default Device ID: a908df7f-5661-4d20-b227-a1c15d2fdb4b",tr._resetCount=0;var ti=function(e,t,r,i){return new(r||(r=Promise))(function(a,s){function n(e){try{l(i.next(e))}catch(e){s(e)}}function o(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(n,o)}l((i=i.apply(e,t||[])).next())})};let ta=new Z.UAParser,ts=!1,tn=!1,to=!1,tl=!1;function t_(){return ti(this,void 0,void 0,function*(){if(navigator.permissions&&navigator.permissions.query)try{let e=yield navigator.permissions.query({name:"camera"});to="denied"===e.state,ts="granted"===e.state}catch(e){}})}function tc(){return ts}function td(){return tn}function th(){return to}function tu(){return tl}function tm(){return to||tl}function tp(){return ts&&tn}function tf(){return ti(this,void 0,void 0,function*(){yield tv(),yield tg()})}function tg(){return ti(this,void 0,void 0,function*(){try{(yield navigator.mediaDevices.getUserMedia({video:!0})).getTracks().forEach(e=>e.stop()),ts=!0,to=!1}catch(e){ts=!1,to=!0}})}function tv(){return ti(this,void 0,void 0,function*(){if(tr.IsSupported()){tn=!0,tl=!1;return}if(window.DeviceOrientationEvent&&window.DeviceOrientationEvent.requestPermission&&"granted"!==(yield window.DeviceOrientationEvent.requestPermission()))return tn=!1,tl=!0,!1;tn=!0,tl=!1})}function tb(e){var t,r,i;return ti(this,void 0,void 0,function*(){if(yield t_(),tp())return!0;let a=document.createElement("div");function s(){return ti(this,void 0,void 0,function*(){for(yield tf(),a.remove();yield new Promise(e=>requestAnimationFrame(()=>e())),!tm();)if(tp())return!0;return!1})}a.classList.add("zappar-permission-request"),a.classList.add("zappar-permission-request-without-button"),a.innerHTML=`
    <style>
        .zappar-permission-request {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0px;
            left: 0px;
            z-index: 1000;
            background-color: rgba(0, 0, 0, 0.9);
            font-family: sans-serif;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .zappar-permission-request-without-button {
            justify-content: flex-start;
        }

        .zappar-permission-request-without-button #zappar-permission-request-button {
            display: none;
        }

        .zappar-permission-request-without-button .zappar-inner {
            max-width: 300px;
        }

        .zappar-inner {
            margin-top: 30%;
            margin-bottom: 30%;
            max-width: 400px;
            text-align: center;
        }
        .zappar-title {
            font-size: 20px;
        }
        .zappar-text {
            font-size: 14px;
            padding: 15px;
        }
        .zappar-inner > button {
            background: none;
            outline: none;
            border: 2px solid white;
            border-radius: 10px;
            color: white;
            padding: 10px 40px;
            text-transform: uppercase;
        }
    </style>
    <div class="zappar-inner">
        <div class="zappar-title">${null!=(t=null==e?void 0:e.title)?t:Q(y.PermissionTitle)}</div>
        <div class="zappar-text">${null!=(r=null==e?void 0:e.description)?r:Q(y.PermissionDescription)}</div>
        <button id="zappar-permission-request-button">${null!=(i=null==e?void 0:e.button)?i:Q(y.PermissionButton)}</button>
    </div>
`,document.body.append(a);try{return yield s()}catch(t){a.classList.remove("zappar-permission-request-without-button");let e=a.querySelector("#zappar-permission-request-button");return yield new Promise(t=>ti(this,void 0,void 0,function*(){null==e||e.addEventListener("click",()=>ti(this,void 0,void 0,function*(){t((yield s()))}))}))}})}function ty(e){var t,r,i,a,s,n,o,l,_,c;let d,h,u,m;"Chrome"===ta.getBrowser().name?(t=e,(d=document.createElement("div")).classList.add("zappar-permission-request"),d.innerHTML=`
    <style>
        .zappar-permission-request {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0px;
            left: 0px;
            z-index: 1000;
            background-color: rgba(0, 0, 0, 0.9);
            font-family: sans-serif;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .zappar-inner {
            width: 400px;
            text-align: center;
        }
        .zappar-title {
            font-size: 20px;
        }
        .zappar-text {
            font-size: 14px;
            padding: 15px;
        }
        .zappar-inner > button {
            background: none;
            outline: none;
            border: 2px solid white;
            border-radius: 10px;
            color: white;
            padding: 10px 40px;
            text-transform: uppercase;
        }
    </style>
    <div class="zappar-inner">
        <div class="zappar-title">${null!=(r=null==t?void 0:t.title)?r:"Permission is Needed"}</div>
        <div class="zappar-text">${null!=(a=null!=(i=null==t?void 0:t.descriptionChrome)?i:null==t?void 0:t.description)?a:'Permission to access your device\'s camera and motion sensors is necessary for this experience.<br/><br/>To grant access, please tap the <svg xmlns="http://www.w3.org/2000/svg" height="16px" viewBox="0 -960 960 960" width="16px" fill="white"><path d="M696-144q-60.48 0-102.24-41.76T552-288q0-60.48 41.76-102.24T696-432q60.48 0 102.24 41.76T840-288q0 60.48-41.76 102.24T696-144Zm.12-72Q726-216 747-237.12q21-21.12 21-51T746.88-339q-21.12-21-51-21T645-338.88q-21 21.12-21 51T645.12-237q21.12 21 51 21ZM168-252v-72h312v72H168Zm96-276q-60.48 0-102.24-41.76T120-672q0-60.48 41.76-102.24T264-816q60.48 0 102.24 41.76T408-672q0 60.48-41.76 102.24T264-528Zm.12-72Q294-600 315-621.12q21-21.12 21-51T314.88-723q-21.12-21-51-21T213-722.88q-21 21.12-21 51T213.12-621q21.12 21 51 21ZM480-636v-72h312v72H480Zm216 348ZM264-672Z"/></svg> button in the address bar of your browser, then "Permissions", and finally "Reset permissions". You can then reload the page to try again.'}</div>
        <button id="zappar-permission-reload-button">${null!=(s=null==t?void 0:t.button)?s:"Reload"}</button>
    </div>
`,document.body.append(d),null==(h=d.querySelector("#zappar-permission-reload-button"))||h.addEventListener("click",()=>window.location.reload())):(n=e,(u=document.createElement("div")).classList.add("zappar-permission-request"),u.innerHTML=`
    <style>
        .zappar-permission-request {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0px;
            left: 0px;
            z-index: 1000;
            background-color: rgba(0, 0, 0, 0.9);
            font-family: sans-serif;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .zappar-inner {
            max-width: 400px;
            text-align: center;
        }
        .zappar-title {
            font-size: 20px;
        }
        .zappar-text {
            font-size: 14px;
            padding: 15px;
        }
        .zappar-inner > button {
            background: none;
            outline: none;
            border: 2px solid white;
            border-radius: 10px;
            color: white;
            padding: 10px 40px;
            text-transform: uppercase;
        }
    </style>
    <div class="zappar-inner">
        <div class="zappar-title">${null!=(o=null==n?void 0:n.title)?o:"Permission is Needed"}</div>
        <div class="zappar-text">${null!=(_=null!=(l=null==n?void 0:n.descriptionIOS)?l:null==n?void 0:n.description)?_:"Permission to access your device's camera and motion sensors is necessary for this experience. Please reload the page to try again."}</div>
        <button id="zappar-permission-reload-button">${null!=(c=null==n?void 0:n.button)?c:"Reload"}</button>
    </div>
`,document.body.append(u),null==(m=u.querySelector("#zappar-permission-reload-button"))||m.addEventListener("click",()=>window.location.reload()))}window.DeviceOrientationEvent&&window.DeviceOrientationEvent.requestPermission||(tn=!0),t_();let tw=1,tA=new Map;function tT(e){return tA.get(e)}class tE{constructor(){this.render_mean_=new Float32Array,this.render_identity_=new Float32Array(50),this.render_expression_=new Float32Array(29),this.render_uvs_=new Float32Array,this.render_indices_=new Uint16Array,this.vertices_=new Float32Array,this.normals_=new Float32Array,this.normalsCalculated_=!1,this.modelVersion_=-1,this.mirrored_=!1}loadFromMemory(e,t,r,i,a){let s=0,n=new Uint16Array(e),o=new Int32Array(e),l=new Float32Array(e),_=()=>{let e=o[s++]*o[s++],t=l.subarray(s,s+e);return s+=e,t},c=()=>{let e=o[s++],t=n.subarray(2*s,2*s+e);return s+=e/2,t};this.render_mean_=_(),this.render_identity_=_(),this.render_expression_=_(),this.render_uvs_=_();let d=c(),h=s<o.length?c():new Uint16Array,u=s<o.length?c():new Uint16Array,m=s<o.length?c():new Uint16Array,p=s<o.length?c():new Uint16Array;if(t||r||i||a){let e=d.length;t&&(e+=h.length),r&&(e+=u.length),i&&(e+=m.length),a&&(e+=p.length),this.render_indices_=new Uint16Array(e),this.render_indices_.set(d,0);let s=d.length;t&&(this.render_indices_.set(h,s),s+=h.length),r&&(this.render_indices_.set(u,s),s+=u.length),i&&(this.render_indices_.set(m,s),s+=m.length),a&&(this.render_indices_.set(p,s),s+=p.length)}else this.render_indices_=d;this.vertices_=new Float32Array(this.render_mean_),this.normals_=new Float32Array(this.vertices_.length),this.modelVersion_++}getVertices(){return this.vertices_}getUVs(){return this.render_uvs_}getIndices(){if(this.mirrored_){if(!this.render_indices_reversed){this.render_indices_reversed=new Uint16Array(this.render_indices_.length);for(let e=0;e<this.render_indices_.length;e+=3)this.render_indices_reversed[e]=this.render_indices_[e+2],this.render_indices_reversed[e+1]=this.render_indices_[e+1],this.render_indices_reversed[e+2]=this.render_indices_[e]}return this.render_indices_reversed}return this.render_indices_}getNormals(){return this.normalsCalculated_||this.calculateNormals(),this.normals_}getModelVersion(){return this.modelVersion_}getLandmarkDataForVertex(e){let t=[this.render_mean_[3*e],this.render_mean_[3*e+1],this.render_mean_[3*e+2]],r=[];for(let t=0;t<50;t++)r.push(this.render_identity_[3*e*50+t]),r.push(this.render_identity_[(3*e+1)*50+t]),r.push(this.render_identity_[(3*e+2)*50+t]);let i=[];for(let t=0;t<29;t++)i.push(this.render_expression_[3*e*29+t]),i.push(this.render_expression_[(3*e+1)*29+t]),i.push(this.render_expression_[(3*e+2)*29+t]);return{mean:t,identity:r,expression:i}}update(e,t,r){if(0!==this.render_mean_.length&&0!==this.render_identity_.length&&0!==this.render_expression_.length){this.mirrored_=r,this.vertices_.set(this.render_mean_);for(let t=0;t<e.length;t++)for(let r=0;r<this.vertices_.length;r++)this.vertices_[r]+=e[t]*this.render_identity_[r*e.length+t];for(let e=0;e<t.length;e++)for(let r=0;r<this.vertices_.length;r++)this.vertices_[r]+=t[e]*this.render_expression_[r*t.length+e];if(r)for(let e=0;e<this.vertices_.length;e+=3)this.vertices_[e]*=-1;this.normalsCalculated_=!1}}calculateNormals(){let e=this.getIndices(),t=this.vertices_,r=new Float32Array(e.length);if(!t)return;let i=e.length,a=this.normals_,s=new Float32Array([0,0,0]),n=new Float32Array([0,0,0]),o=new Float32Array([0,0,0]);for(let a=0;a<i;a+=3){let i=3*e[a],l=3*e[a+1],_=3*e[a+2];s[0]=t[l]-t[i],s[1]=t[l+1]-t[i+1],s[2]=t[l+2]-t[i+2],n[0]=t[_]-t[i],n[1]=t[_+1]-t[i+1],n[2]=t[_+2]-t[i+2],function(e,t,r){var i=t[0],a=t[1],s=t[2],n=r[0],o=r[1],l=r[2];e[0]=a*l-s*o,e[1]=s*n-i*l,e[2]=i*o-a*n}(o,s,n);let c=Math.hypot(o[0],o[1],o[2]);r[a]=o[0]/c,r[a+1]=o[1]/c,r[a+2]=o[2]/c}a.fill(0);for(let t=0;t<i;t+=3){let i=3*e[t],s=3*e[t+1],n=3*e[t+2];a[i]+=r[t],a[i+1]+=r[t+1],a[i+2]+=r[t+2],a[s]+=r[t],a[s+1]+=r[t+1],a[s+2]+=r[t+2],a[n]+=r[t],a[n+1]+=r[t+1],a[n+2]+=r[t+2]}let l=a.length/3;for(let e=0;e<l;e++){let t=3*e;s[0]=a[t],s[1]=a[t+1],s[2]=a[t+2],function(e,t){var r=t[0],i=t[1],a=t[2],s=r*r+i*i+a*a;s>0&&(s=1/Math.sqrt(s)),e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s}(n,s),a[t]=n[0],a[t+1]=n[1],a[t+2]=n[2]}this.normalsCalculated_=!0}}let tR={0:[{mean:[.235,.2344,.7305],identity:[.008,.0087,.0024,-.0026,6e-4,-.0022,5e-4,.0033,.0026,.0017,-.0055,-8e-4,.0011,.0059,0,2e-4,.001,-.001,-.0044,-.0011,-1e-4,.0024,.0019,-9e-4,4e-4,-.0015,0,.0038,.0013,3e-4,.002,-.0021,.0018,.0023,.0011,.0012,-.0011,-.0017,9e-4,-.0012,-8e-4,7e-4,-.0017,.0029,-.0029,8e-4,-.0027,8e-4,-.0017,4e-4,9e-4,-.001,-3e-4,8e-4,-.0016,-3e-4,-7e-4,.0016,-9e-4,.0021,-5e-4,.0011,-.0024,-1e-4,6e-4,1e-4,-.0026,-4e-4,-3e-4,-9e-4,5e-4,3e-4,-8e-4,-.001,-4e-4,-8e-4,.0022,-.0014,-1e-4,-.0023,0,-.0018,7e-4,-.0036,.0017,.0017,-.0018,-2e-4,-4e-4,-9e-4,-8e-4,3e-4,.0012,9e-4,-4e-4,-.0016,5e-4,-.0013,.0011,.0023,.0029,.0024,.0017,-.0027,-4e-4,-.001,-.0018,-.0015,-.001,.001,-.0013,-1e-4,-2e-4,7e-4,3e-4,3e-4,-.0016,9e-4,-.0021,4e-4,.0014,.002,-7e-4,-4e-4,2e-4,-4e-4,-6e-4,-9e-4,.0015,4e-4,-4e-4,5e-4,-.0015,9e-4,3e-4,3e-4,-2e-4,-8e-4,-9e-4,.0023,4e-4,1e-4,-4e-4,-1e-4,7e-4,2e-4,.001,1e-4,-.0029,-5e-4],expression:[0,3e-4,.0052,-7e-4,-.0051,-.0103,0,.0019,.0027,-.0054,.0135,.035,-5e-4,-6e-4,.0025,-.0045,-.0557,-.003,-.0191,-.1199,.0548,-.0036,-.0682,-.0167,2e-4,-.0085,-.0085,.0044,.0041,-.0568,.0044,.179,.0065,-.0017,-.1006,.0036,-.0267,-.3279,.0301,-.0011,-.0173,-.001,.0046,.2808,.0207,.0162,.238,-.0225,.0017,.1041,.0203,5e-4,.0161,.0031,-.0436,.6504,.0873,-.0099,.1039,.0048,-.0254,.2534,-.0042,.003,-.0106,-.0153,-.0118,.0252,9e-4,-.0071,.0099,.007,-.0724,.0461,-.0235,.0833,.004,.0141,-.0219,.0132,-.0042,-.0179,.0045,-.0215,.3638,.0054,-.0445]},{mean:[.2358,.1466,.7183],identity:[.0077,.0093,1e-4,-.0022,0,-.0041,5e-4,.0022,.0028,.0018,-.0038,-.0013,.001,.0044,-2e-4,0,.0017,-.0016,-.0043,-2e-4,-1e-4,.0023,9e-4,5e-4,-7e-4,-4e-4,-.0017,.003,7e-4,6e-4,.0011,-.0018,5e-4,.0018,-8e-4,4e-4,-.0023,-6e-4,-3e-4,-.0015,-.0014,-1e-4,-.0018,.0027,-.0026,3e-4,-.0031,.0011,-.0026,-.0011,.0012,-.0013,-2e-4,7e-4,-.0021,.0021,4e-4,.0012,-.001,.002,-3e-4,2e-4,-.0026,-3e-4,.001,1e-4,-.0018,-.001,9e-4,-.0011,.001,4e-4,-8e-4,-7e-4,-.001,-3e-4,7e-4,-5e-4,-6e-4,-.0019,-5e-4,-.002,7e-4,-.0027,.0014,.0013,6e-4,-5e-4,-3e-4,-3e-4,-.001,0,.0019,1e-4,6e-4,-.0012,4e-4,-9e-4,4e-4,.0025,3e-4,.0024,.0017,-9e-4,-.0015,-.0015,-.001,-.0023,-.001,-5e-4,-4e-4,8e-4,9e-4,7e-4,2e-4,7e-4,-9e-4,9e-4,-.0013,1e-4,9e-4,2e-4,6e-4,-6e-4,-8e-4,-4e-4,-7e-4,8e-4,.0019,3e-4,.0015,2e-4,-.0015,-3e-4,0,6e-4,3e-4,6e-4,-6e-4,2e-4,5e-4,-4e-4,.0012,-4e-4,2e-4,-8e-4,6e-4,-4e-4,2e-4,-.0021],expression:[-.0034,.0054,.0069,.004,6e-4,-.0104,-3e-4,.0036,.0025,.0065,.0296,.0208,-9e-4,.0154,.0029,-.0167,.0124,.004,-.0102,.0351,.028,-.019,.0146,-.0035,-.0023,-.0069,-.0051,-.01,.0262,-.028,.0112,.082,.023,-.0019,-.066,-.0104,-.0408,.0164,.0075,-.0074,.0367,.0041,.0517,-.0207,.0045,.0291,-.0672,-.0129,.0345,-.1558,-.0106,.0037,-.0437,-.0021,.0854,-.1121,.0187,.0041,.0072,.0011,.0193,-.0143,-.0119,.005,-.02,-.0122,-.008,.0527,.0036,-.006,.0222,.007,-.0429,.046,-.0046,.0226,-.0059,.0202,-.0173,.0087,0,-.0067,-.0095,-.0153,.1506,-.0017,.0021]}],1:[{mean:[-.2271,.2323,.7319],identity:[-.0084,.0097,.0018,.0041,2e-4,-.002,-.0012,.0036,.0019,-9e-4,-.0063,-.001,-3e-4,.0053,6e-4,1e-4,5e-4,-.0015,.0044,-.0025,-.0015,-.002,.0016,-6e-4,2e-4,-.0013,0,-.0022,2e-4,2e-4,-.0025,-.0014,.0015,8e-4,2e-4,.0012,6e-4,-6e-4,.0017,0,3e-4,-1e-4,.0024,.0025,-.0029,-.0015,-.0015,1e-4,.0031,-.0016,7e-4,.0019,6e-4,.002,9e-4,.001,-.0014,-.002,-.0015,.0029,1e-4,5e-4,-.0023,8e-4,-.0011,.0019,.0017,-3e-4,-.0011,-3e-4,.0011,-8e-4,.0019,-.0022,1e-4,.0015,.0017,-8e-4,-.0011,-.0022,3e-4,.0022,6e-4,-.003,-2e-4,0,-.0017,-2e-4,0,1e-4,4e-4,.0012,.0019,-.0014,4e-4,-.0017,-.0012,-.0011,.0021,-.0029,.0026,.0018,-.0023,-.0029,1e-4,.0014,-.0019,-4e-4,-4e-4,.0023,-.0016,0,-9e-4,.0014,-.0015,.0015,-.0016,-.0011,-.0022,1e-4,-.0018,.0027,-.0013,4e-4,-1e-4,-5e-4,.0011,-2e-4,.0015,5e-4,-9e-4,-1e-4,.0029,6e-4,0,-3e-4,7e-4,-8e-4,-5e-4,.0025,3e-4,2e-4,-8e-4,-1e-4,3e-4,0,.0014,2e-4,-.0024,1e-4],expression:[-.0025,-9e-4,.006,.004,-.0027,-.0113,-8e-4,.001,.0031,-.0016,.0144,.0382,-3e-4,-5e-4,.0035,-.0044,-.0511,-.0014,-7e-4,-.1007,.0582,-6e-4,-.0606,-.0165,5e-4,-.0087,-.0093,.0036,.0057,-.0576,-.0039,.1488,.0127,.0016,-.0666,-9e-4,-.0153,.3162,-.0445,-.0021,.0023,.0043,-.0033,.2382,.0063,-.0217,.167,-.039,.0097,-.1144,-.0189,-.0145,.6831,.0632,-.0012,-.1959,-.0133,4e-4,.1108,-3e-4,.0062,.2593,-.0161,-.0018,-.0051,-.012,.0162,.016,-.0022,-.0052,-.0201,.0101,.0115,.0365,-.024,-.0059,.0188,-.0336,.0352,.0224,-.0229,.0146,.0086,-.0273,-.0032,.0103,-.0112]},{mean:[-.2288,.1541,.7202],identity:[-.0082,.0101,2e-4,.0036,-7e-4,-.0037,-8e-4,.0024,.0022,-.0013,-.0045,-.0013,-6e-4,.0045,-4e-4,4e-4,.0012,-.0014,.0042,-.001,-7e-4,-.0019,3e-4,-2e-4,.0012,-4e-4,-.0012,-.0018,-4e-4,-1e-4,-.0014,-.0012,1e-4,1e-4,-.0017,.001,.0015,-1e-4,6e-4,1e-4,0,-6e-4,.0028,.0021,-.0025,-.002,-.0015,7e-4,.0028,-.0023,9e-4,.0013,1e-4,.0016,.0012,.0032,-6e-4,-.0013,-.0011,.0021,3e-4,-5e-4,-.0024,4e-4,-4e-4,.0014,.0015,-8e-4,-3e-4,3e-4,.0017,-6e-4,.002,-.0018,-3e-4,9e-4,1e-4,2e-4,-6e-4,-.0015,-4e-4,.0022,7e-4,-.0023,0,-2e-4,-2e-4,-3e-4,-1e-4,6e-4,-2e-4,6e-4,.0022,-3e-4,.0013,-.0014,-5e-4,-3e-4,.0013,-.0027,6e-4,.0025,-.0023,-8e-4,-.0013,.0017,-9e-4,-.0019,1e-4,8e-4,-7e-4,-4e-4,0,.001,-.001,.0019,-8e-4,-.0015,-6e-4,-2e-4,-.0011,8e-4,1e-4,9e-4,-8e-4,-4e-4,6e-4,7e-4,.0021,-4e-4,7e-4,-5e-4,.0021,-7e-4,-4e-4,-9e-4,8e-4,3e-4,1e-4,3e-4,1e-4,9e-4,.001,-5e-4,5e-4,-.001,.001,4e-4,-5e-4,-.0012],expression:[8e-4,.0037,.0078,-4e-4,5e-4,-.012,-2e-4,-.0046,.0033,-.0089,.0295,.0221,-.0024,-.0084,.0013,.0057,.0125,.0049,-.0036,.0373,.0285,.0115,.0135,-.0035,.0048,.0108,-.0033,.0106,.0281,-.0301,-.0082,.0803,.0244,-7e-4,-.0725,-.0105,-.0247,-.0036,-.0143,-.0045,-.029,2e-4,-.0303,.0093,-.0021,-.0196,-.0754,-.0211,.0326,.1246,.006,-.0804,-.1499,.0109,.0182,-.0029,-.0014,-.0035,.0072,-8e-4,-.0152,-.0108,-.0166,-.0073,-.0144,-.0095,.0101,.047,-.0018,-.004,-.0189,.0027,.0104,.0298,-.0042,-.0096,.0191,-.0217,.0228,.0226,-.0105,.0047,-.0048,-.0172,.0061,-.0043,-.0016]}],2:{mean:[.5396,.2028,.2496],identity:[.0204,.0146,-.0182,-.0052,.0158,-.0038,-.0025,-.0108,-.006,.0085,-.0044,.0029,.0042,.001,.0095,.0015,-.0034,-.0064,-.0057,7e-4,.0026,7e-4,.0037,-6e-4,.0037,.0026,.0024,5e-4,-.0019,-.0013,.003,-.0028,.0018,-9e-4,.002,-.0047,.004,-.003,.0031,-.0027,-.0026,-.0017,.0016,.0014,-4e-4,.0021,-.002,0,.0017,7e-4,-4e-4,-7e-4,-.0018,-9e-4,2e-4,-.0012,1e-4,-5e-4,-.0011,4e-4,2e-4,.0011,1e-4,8e-4,.0017,-.0013,.0025,.0017,.001,2e-4,3e-4,5e-4,-4e-4,-1e-4,-5e-4,7e-4,-.0022,-.0029,6e-4,-8e-4,-6e-4,6e-4,-5e-4,5e-4,.0013,3e-4,-5e-4,-.003,7e-4,2e-4,.0016,-4e-4,0,0,4e-4,1e-4,.0014,.0012,1e-4,4e-4,-1e-4,8e-4,9e-4,4e-4,-4e-4,9e-4,-2e-4,.001,9e-4,4e-4,1e-4,7e-4,7e-4,.001,-.0017,-8e-4,2e-4,.0017,-3e-4,-1e-4,4e-4,5e-4,7e-4,5e-4,-1e-4,-6e-4,-1e-4,1e-4,-3e-4,-7e-4,-2e-4,-5e-4,0,-3e-4,3e-4,8e-4,-2e-4,-3e-4,5e-4,1e-4,-7e-4,-.001,-2e-4,3e-4,4e-4,-1e-4,7e-4,0,4e-4,4e-4],expression:[1e-4,-4e-4,1e-4,0,5e-4,2e-4,0,0,3e-4,-2e-4,3e-4,5e-4,-1e-4,2e-4,8e-4,1e-4,-2e-4,-5e-4,-3e-4,6e-4,5e-4,0,1e-4,2e-4,1e-4,-1e-4,-6e-4,-2e-4,5e-4,0,-4e-4,4e-4,.0016,4e-4,-4e-4,-.0015,0,1e-4,1e-4,-3e-4,3e-4,.0019,-2e-4,7e-4,4e-4,4e-4,-8e-4,-.0015,.0013,-.0016,-.0069,4e-4,-6e-4,-.0019,0,-1e-4,5e-4,-3e-4,2e-4,.0014,-3e-4,6e-4,.0011,4e-4,-3e-4,-.0032,-6e-4,8e-4,.0025,-3e-4,3e-4,.0015,-1e-4,1e-4,3e-4,-1e-4,0,0,-3e-4,4e-4,.0019,1e-4,0,-8e-4,-1e-4,1e-4,5e-4]},3:{mean:[-.5464,.2141,.26],identity:[-.0207,.0172,-.0176,.0068,.0148,-.0051,.0042,-.0101,-.0058,-.0087,-.0059,.0045,-.0056,.0017,.0097,-.0048,-.004,-.0044,.0019,2e-4,.0041,-.0052,.0041,2e-4,-.0027,6e-4,.002,-.0027,-.0033,-6e-4,-.004,9e-4,-.0012,-1e-4,-.0026,.0021,-.003,-.0025,.0052,.0025,.0022,-1e-4,-8e-4,.0013,.001,4e-4,.0018,.0014,6e-4,-5e-4,-.0015,-.0039,.0014,-1e-4,8e-4,-2e-4,6e-4,-5e-4,-.0038,-.0012,-.0018,-3e-4,.001,9e-4,.0012,.0024,-.0024,-7e-4,-.0016,-.0016,3e-4,-.001,-.0014,-.0014,.001,-3e-4,-7e-4,-.0012,3e-4,6e-4,3e-4,-5e-4,3e-4,.0012,6e-4,-8e-4,4e-4,4e-4,8e-4,-2e-4,-.0014,3e-4,0,.0023,-3e-4,-.0012,-.0013,.0011,-2e-4,-.0014,-1e-4,.0014,0,3e-4,3e-4,-8e-4,-5e-4,-7e-4,-7e-4,-2e-4,3e-4,5e-4,2e-4,-1e-4,.0011,-.0014,1e-4,-.0015,-1e-4,-3e-4,0,-.001,-1e-4,-8e-4,8e-4,-8e-4,-2e-4,-.0011,-3e-4,-4e-4,1e-4,-2e-4,3e-4,-7e-4,0,3e-4,1e-4,-8e-4,5e-4,1e-4,4e-4,.0014,-6e-4,-.001,-3e-4,-2e-4,1e-4,-1e-4,-1e-4,7e-4],expression:[-3e-4,-1e-4,6e-4,4e-4,0,-7e-4,0,-3e-4,-2e-4,-4e-4,.0012,8e-4,1e-4,-5e-4,-7e-4,-4e-4,0,1e-4,-4e-4,.0017,7e-4,0,1e-4,3e-4,0,4e-4,4e-4,5e-4,1e-4,-.001,-7e-4,.0022,.0026,5e-4,-.0024,-.0023,0,1e-4,3e-4,0,-.0013,-.0015,6e-4,.0014,8e-4,-2e-4,-.0025,-.0023,-3e-4,.0049,.006,-2e-4,-7e-4,-2e-4,0,-.0019,-.0018,-2e-4,.0017,.0017,3e-4,.0015,7e-4,1e-4,-.0023,-.0036,2e-4,.0023,.0017,0,-5e-4,-3e-4,-3e-4,4e-4,2e-4,-1e-4,-3e-4,-5e-4,1e-4,.0018,.0025,1e-4,-6e-4,-.0011,0,1e-4,1e-4]},4:{mean:[.0018,.1864,.853],identity:[-.0011,.0134,.0085,9e-4,-.0025,-7e-4,-3e-4,.0033,4e-4,-5e-4,-.0047,-.002,7e-4,.0026,-.0069,-1e-4,.0036,.0072,5e-4,-8e-4,-.0047,4e-4,-8e-4,-.001,0,2e-4,-.0036,-2e-4,-.001,-.0048,-1e-4,.0018,.0044,-7e-4,-2e-4,.0043,3e-4,.002,-.0031,0,-7e-4,.0013,0,.0037,.0033,-.0016,-.0012,.002,-1e-4,-.0027,.0051,5e-4,8e-4,7e-4,-.0017,.0054,.0023,-3e-4,.0032,1e-4,0,7e-4,-5e-4,-.0011,2e-4,8e-4,0,-.0033,-8e-4,-7e-4,7e-4,.0033,5e-4,-3e-4,.0029,-1e-4,-.0024,-.0011,-.002,-.0015,-.0019,2e-4,7e-4,.0031,6e-4,.0012,0,0,-.0021,0,-9e-4,-.0011,-.0011,-2e-4,.0015,.001,.0013,8e-4,.001,-3e-4,9e-4,.0027,-2e-4,-.0011,-.0011,6e-4,7e-4,2e-4,1e-4,-5e-4,-.0022,.0011,-.0014,9e-4,3e-4,2e-4,0,-6e-4,-4e-4,-.0011,-7e-4,.001,-.0012,6e-4,-.0012,-.0015,3e-4,-9e-4,-.0013,-.0013,7e-4,.001,-.0011,-.0013,.0015,4e-4,1e-4,4e-4,-1e-4,-.0016,-.0016,9e-4,-7e-4,-.0024,5e-4,-1e-4,-.0017,-2e-4,3e-4,-9e-4],expression:[-.0017,.0019,.0097,.003,-.0103,-.0093,9e-4,6e-4,.0023,-.0017,-.0204,.0376,.0033,-.0034,.0033,-.0026,-.0322,.0396,-.0032,-.0947,.0942,-7e-4,-.0175,.0266,-.001,-6e-4,.0016,.0025,.0157,-.0142,-.0022,.037,.015,.0021,-.0102,-.0107,.0036,.0055,-.0051,.0021,3e-4,-3e-4,4e-4,-.0177,.0074,-6e-4,-.0357,.0149,-.0066,9e-4,.0013,-.0031,.0016,.0095,.002,.0052,.0035,-3e-4,.0053,-.0082,.002,.0022,-.0071,-.0011,5e-4,.0055,.0011,3e-4,-.0126,-4e-4,3e-4,-.0023,-.0015,.0059,.0063,-.0042,-.0023,.0055,.0019,.0017,-.0075,6e-4,-8e-4,.0018,.0012,.0012,-5e-4]},5:{mean:[-.002,-.0469,1.0039],identity:[-.0017,.0018,.0156,6e-4,-.0038,5e-4,4e-4,.0013,.002,-4e-4,-.0015,-.0051,5e-4,-7e-4,-.0055,-1e-4,-9e-4,.008,-2e-4,.0036,-.0053,4e-4,-.0026,-.0016,7e-4,9e-4,-.009,-3e-4,7e-4,-.0084,.0015,.0021,.0032,-.0015,.0018,.0046,-3e-4,-4e-4,-1e-4,8e-4,-.0044,-7e-4,-8e-4,7e-4,.0048,-.0024,-3e-4,.0024,2e-4,-.0051,.0058,-6e-4,.0028,.0018,-.0021,.0035,.0057,.0011,.0065,0,-2e-4,.0011,.003,-.0027,8e-4,7e-4,3e-4,-.0039,-.002,-2e-4,-.0015,.0034,.0012,-.0025,.0024,-2e-4,4e-4,-.0042,-.0024,-.001,-.0023,.0016,-7e-4,.0039,1e-4,-5e-4,.0018,3e-4,-2e-4,-9e-4,-.0015,3e-4,-7e-4,-1e-4,-2e-4,.0023,.0032,.002,-.0013,.0013,-.0038,.0045,1e-4,-.0031,1e-4,.0019,-1e-4,.0016,.0013,0,-.002,.0023,2e-4,.0011,.0018,-.0024,6e-4,-.0017,.002,-8e-4,-.0021,7e-4,.0011,8e-4,4e-4,-.001,.0012,2e-4,-6e-4,-.0027,-5e-4,.001,-9e-4,1e-4,-1e-4,8e-4,-.0011,.0022,-.001,-5e-4,-.0011,.0016,-.0015,8e-4,-3e-4,9e-4,.0013,-7e-4,-7e-4,-2e-4],expression:[-.0018,-.0168,.0088,.0389,.1026,.0414,.2201,-.0262,-.0016,-.0017,.0612,-.0298,-.0323,.0093,.0013,-.005,.2207,.1315,-4e-4,.0858,-.0303,-.0133,.015,-.008,.1454,.0114,.0177,-.0077,.1022,.0356,-.0023,.1088,.0232,.003,-.0706,.0347,-1e-4,.004,-.0011,.0397,-.0096,-.0033,.0029,-.01,-.0083,-6e-4,-.0135,.0016,-.0087,-.0019,.0022,-.004,-.0087,.0105,8e-4,-.005,.0069,.0028,.0409,-.0391,.003,.0103,.0051,.0026,.0776,-.0083,-.0062,-.0567,.0268,.0175,.0017,.0156,-.0043,.0299,-.0395,-.0015,.0051,-.0148,.0125,.0035,.0603,.0109,-.0645,-.0257,.002,6e-4,-8e-4]},6:{mean:[-6e-4,-.1542,.8789],identity:[-7e-4,-.0032,.01,0,-.0027,.0031,6e-4,5e-4,-6e-4,-3e-4,.0013,-.0049,-2e-4,-.002,-.0046,8e-4,-.0011,.0054,2e-4,.0043,-.0027,3e-4,-.0022,-.0019,8e-4,.0032,-.0069,0,4e-4,-.0071,.0016,.0027,.0039,-.0017,9e-4,.0031,-1e-4,-5e-4,-4e-4,7e-4,-.0026,-.0012,-5e-4,6e-4,2e-4,-.0014,-.0013,.0019,-2e-4,-.0053,.0031,-6e-4,.0016,.0023,-.0013,.0021,.0029,8e-4,.0052,0,4e-4,0,.0037,-.0026,3e-4,.002,-2e-4,-.0024,4e-4,-4e-4,-.0012,8e-4,7e-4,-.0023,5e-4,0,.0014,-.0022,-.0016,0,-.0012,8e-4,-7e-4,.0014,-6e-4,-.0012,-3e-4,2e-4,.0012,-3e-4,-.002,-1e-4,1e-4,-2e-4,-.0016,9e-4,.002,.0019,0,6e-4,-.0022,.0016,1e-4,-.0017,-.0013,.001,9e-4,-1e-4,.0011,3e-4,-7e-4,.0014,8e-4,.0013,.0011,-.002,0,-.0015,.0014,.001,-.0015,7e-4,3e-4,.001,-1e-4,.0012,7e-4,6e-4,-4e-4,-.0013,-.0012,-9e-4,-.0011,2e-4,-5e-4,5e-4,4e-4,2e-4,1e-4,0,5e-4,5e-4,-.0014,.0015,-9e-4,5e-4,.0014,-8e-4,-8e-4,.0012],expression:[8e-4,.0481,.1653,.0784,.1008,-.3992,.5088,-.02,.0542,.001,.3723,-.0151,-.0986,.0283,-.0033,-.0121,.2634,.1202,.0036,-.0529,-.0245,-.0297,-.1085,.0495,.3264,.0083,4e-4,-.0314,.1459,-.1142,-.003,1e-4,.1154,-.0035,-.0285,-.0184,-1e-4,.0012,.0035,.079,-.0103,.0043,.011,-.004,-.0774,-.0047,-.023,.0284,-.0048,-.001,.0149,-.0039,.0046,.0528,-6e-4,.0063,.0376,.0096,.0558,-.0295,0,-.0311,-.0634,.0062,.0176,-.0154,-.0109,-.1149,.0192,.0326,.0121,.0237,.0034,.0262,-.0778,.0014,-.0045,-.0203,.0077,.0588,.0575,.008,-.0557,-.0095,.0032,.0054,-.0042]},7:{mean:[.0038,-.2927,.833],identity:[6e-4,-.0109,.0073,-6e-4,-.0044,.0017,-1e-4,-.0022,-6e-4,-3e-4,.0065,-.0014,-6e-4,-.0051,-.0046,3e-4,-.0029,.003,2e-4,.0038,-6e-4,0,-.0012,6e-4,-4e-4,.0053,-.0075,-2e-4,-7e-4,-.0063,.0014,.0026,.0019,-.0022,.0018,.0028,-1e-4,-.0012,.0011,9e-4,.0019,-.0019,-1e-4,.0012,-.0022,-3e-4,-.0012,4e-4,-8e-4,3e-4,-3e-4,0,.0017,.0021,-4e-4,.0012,.0022,-3e-4,.0026,-3e-4,4e-4,-.0026,.0032,-.0019,3e-4,.0015,1e-4,-.0015,.0013,-1e-4,1e-4,-.0029,0,-2e-4,-.0028,-7e-4,.0019,-3e-4,-2e-4,.0012,9e-4,4e-4,-.001,-.002,-.0016,.0011,-1e-4,3e-4,.0021,2e-4,-.0014,-9e-4,-1e-4,0,-2e-4,-.001,.0015,.0018,1e-4,7e-4,8e-4,.0017,.001,-9e-4,1e-4,4e-4,.0023,-1e-4,.0012,1e-4,-8e-4,2e-4,.0018,6e-4,3e-4,1e-4,.0012,-3e-4,.002,-6e-4,0,-1e-4,-.0022,4e-4,5e-4,.0011,2e-4,-.0013,-.0023,6e-4,6e-4,-5e-4,-5e-4,9e-4,2e-4,2e-4,.0011,-3e-4,.0011,.0015,.0011,3e-4,2e-4,8e-4,-4e-4,-8e-4,3e-4,0,.0012,-1e-4],expression:[.026,.1107,.3257,.1917,.3206,-1.1348,1.0791,-.035,.1549,-.0103,.6953,1e-4,-.3262,.068,.0219,-.0044,.3643,.2178,.0168,-.2478,-.1321,-.0414,-.3782,-.0617,.5088,-.0031,-.0311,-.0497,.0948,-.385,.0148,-.2224,-.1415,-.0074,.0863,-.203,3e-4,-.0081,.0057,.1164,-.0039,.0015,-.0024,.0505,.1532,.0039,-.0148,-.0753,.0163,.0058,-.0339,.0036,.0252,-.0569,-.0041,.0163,-.0361,.0035,-.018,.1266,0,-.0163,-.0046,.0133,-.1656,.2134,.0191,.0057,.0734,.0681,.0039,-.0144,.029,-.074,-.046,.0122,.0072,-.0162,-.0349,-.1234,.0212,-.0355,.0535,.1218,.0043,-.024,.0016]},8:{mean:[-.0018,-.3037,.8491],identity:[2e-4,-.0112,.0077,-4e-4,-.0044,.0024,1e-4,-.0021,-4e-4,-4e-4,.0066,-.002,-4e-4,-.0052,-.0044,3e-4,-.0032,.0039,4e-4,.0042,-3e-4,2e-4,-.0012,-2e-4,-2e-4,.0052,-.0083,-1e-4,-8e-4,-.0056,.0017,.0024,.0019,-.0023,.002,.0027,-2e-4,-.0013,.002,9e-4,.0017,-.0028,-2e-4,.0012,-.0026,0,-.0016,2e-4,-5e-4,3e-4,-.001,-1e-4,.0016,.0016,-3e-4,.0012,.0012,-3e-4,.0027,-3e-4,3e-4,-.0026,.0037,-.0017,1e-4,.0016,1e-4,-.0015,.0024,1e-4,2e-4,-.0039,0,-3e-4,-.0033,-6e-4,.0017,-4e-4,-4e-4,.0012,.0018,2e-4,-.0012,-.002,-.0017,.0013,-.001,3e-4,.0021,4e-4,-.0012,-6e-4,-2e-4,0,-4e-4,-9e-4,.0016,.0017,4e-4,7e-4,7e-4,.001,9e-4,-8e-4,5e-4,5e-4,.0023,.001,.0013,2e-4,-4e-4,2e-4,.0017,8e-4,3e-4,-1e-4,9e-4,-4e-4,.0019,-5e-4,3e-4,0,-.0025,3e-4,3e-4,.0011,1e-4,-.0015,-.001,7e-4,7e-4,-7e-4,-7e-4,8e-4,0,1e-4,.0013,-4e-4,.0012,.0014,.0017,4e-4,2e-4,3e-4,-3e-4,-9e-4,1e-4,0,.001,-4e-4],expression:[-.0092,2.8809,1.416,.2018,1.1982,-.9351,1.4492,-.1902,.1749,.0305,-.167,-.1572,-.7354,-.0492,.0115,.0608,.2971,.1179,.0046,-.0997,-.0041,-.0104,.3379,-.1854,.009,.0366,-.0583,.0269,-.0029,-.4175,-8e-4,.1794,.0752,-.0135,.1158,.1234,5e-4,.003,-.0032,.1034,-.0504,-.0055,-.0076,-.0772,.224,.0047,.0229,-.1044,.0162,-.0161,-.0241,-.0083,-.1388,-.0434,-.0125,-.0997,-.0327,-.0111,.1576,-.3911,.0199,.2522,.142,.0059,-.0721,-.0045,.031,-.1136,-.1685,.0641,.0142,.0312,.0426,-.1366,.1011,.0101,-.0157,.0018,-.0103,-.0344,.0907,.0016,.1168,-.0806,.0104,-.0057,.0111]},9:[{mean:[.0038,-.2927,.833],identity:[6e-4,-.0109,.0073,-6e-4,-.0044,.0017,-1e-4,-.0022,-6e-4,-3e-4,.0065,-.0014,-6e-4,-.0051,-.0046,3e-4,-.0029,.003,2e-4,.0038,-6e-4,0,-.0012,6e-4,-4e-4,.0053,-.0075,-2e-4,-7e-4,-.0063,.0014,.0026,.0019,-.0022,.0018,.0028,-1e-4,-.0012,.0011,9e-4,.0019,-.0019,-1e-4,.0012,-.0022,-3e-4,-.0012,4e-4,-8e-4,3e-4,-3e-4,0,.0017,.0021,-4e-4,.0012,.0022,-3e-4,.0026,-3e-4,4e-4,-.0026,.0032,-.0019,3e-4,.0015,1e-4,-.0015,.0013,-1e-4,1e-4,-.0029,0,-2e-4,-.0028,-7e-4,.0019,-3e-4,-2e-4,.0012,9e-4,4e-4,-.001,-.002,-.0016,.0011,-1e-4,3e-4,.0021,2e-4,-.0014,-9e-4,-1e-4,0,-2e-4,-.001,.0015,.0018,1e-4,7e-4,8e-4,.0017,.001,-9e-4,1e-4,4e-4,.0023,-1e-4,.0012,1e-4,-8e-4,2e-4,.0018,6e-4,3e-4,1e-4,.0012,-3e-4,.002,-6e-4,0,-1e-4,-.0022,4e-4,5e-4,.0011,2e-4,-.0013,-.0023,6e-4,6e-4,-5e-4,-5e-4,9e-4,2e-4,2e-4,.0011,-3e-4,.0011,.0015,.0011,3e-4,2e-4,8e-4,-4e-4,-8e-4,3e-4,0,.0012,-1e-4],expression:[.026,.1107,.3257,.1917,.3206,-1.1348,1.0791,-.035,.1549,-.0103,.6953,1e-4,-.3262,.068,.0219,-.0044,.3643,.2178,.0168,-.2478,-.1321,-.0414,-.3782,-.0617,.5088,-.0031,-.0311,-.0497,.0948,-.385,.0148,-.2224,-.1415,-.0074,.0863,-.203,3e-4,-.0081,.0057,.1164,-.0039,.0015,-.0024,.0505,.1532,.0039,-.0148,-.0753,.0163,.0058,-.0339,.0036,.0252,-.0569,-.0041,.0163,-.0361,.0035,-.018,.1266,0,-.0163,-.0046,.0133,-.1656,.2134,.0191,.0057,.0734,.0681,.0039,-.0144,.029,-.074,-.046,.0122,.0072,-.0162,-.0349,-.1234,.0212,-.0355,.0535,.1218,.0043,-.024,.0016]},{mean:[-.0018,-.3037,.8491],identity:[2e-4,-.0112,.0077,-4e-4,-.0044,.0024,1e-4,-.0021,-4e-4,-4e-4,.0066,-.002,-4e-4,-.0052,-.0044,3e-4,-.0032,.0039,4e-4,.0042,-3e-4,2e-4,-.0012,-2e-4,-2e-4,.0052,-.0083,-1e-4,-8e-4,-.0056,.0017,.0024,.0019,-.0023,.002,.0027,-2e-4,-.0013,.002,9e-4,.0017,-.0028,-2e-4,.0012,-.0026,0,-.0016,2e-4,-5e-4,3e-4,-.001,-1e-4,.0016,.0016,-3e-4,.0012,.0012,-3e-4,.0027,-3e-4,3e-4,-.0026,.0037,-.0017,1e-4,.0016,1e-4,-.0015,.0024,1e-4,2e-4,-.0039,0,-3e-4,-.0033,-6e-4,.0017,-4e-4,-4e-4,.0012,.0018,2e-4,-.0012,-.002,-.0017,.0013,-.001,3e-4,.0021,4e-4,-.0012,-6e-4,-2e-4,0,-4e-4,-9e-4,.0016,.0017,4e-4,7e-4,7e-4,.001,9e-4,-8e-4,5e-4,5e-4,.0023,.001,.0013,2e-4,-4e-4,2e-4,.0017,8e-4,3e-4,-1e-4,9e-4,-4e-4,.0019,-5e-4,3e-4,0,-.0025,3e-4,3e-4,.0011,1e-4,-.0015,-.001,7e-4,7e-4,-7e-4,-7e-4,8e-4,0,1e-4,.0013,-4e-4,.0012,.0014,.0017,4e-4,2e-4,3e-4,-3e-4,-9e-4,1e-4,0,.001,-4e-4],expression:[-.0092,2.8809,1.416,.2018,1.1982,-.9351,1.4492,-.1902,.1749,.0305,-.167,-.1572,-.7354,-.0492,.0115,.0608,.2971,.1179,.0046,-.0997,-.0041,-.0104,.3379,-.1854,.009,.0366,-.0583,.0269,-.0029,-.4175,-8e-4,.1794,.0752,-.0135,.1158,.1234,5e-4,.003,-.0032,.1034,-.0504,-.0055,-.0076,-.0772,.224,.0047,.0229,-.1044,.0162,-.0161,-.0241,-.0083,-.1388,-.0434,-.0125,-.0997,-.0327,-.0111,.1576,-.3911,.0199,.2522,.142,.0059,-.0721,-.0045,.031,-.1136,-.1685,.0641,.0142,.0312,.0426,-.1366,.1011,.0101,-.0157,.0018,-.0103,-.0344,.0907,.0016,.1168,-.0806,.0104,-.0057,.0111]}],10:{mean:[-.007,-.6338,.7695],identity:[1e-4,-.0296,.0089,-6e-4,-.0073,-.0065,-1e-4,-.0029,-.0031,-2e-4,.0128,.0065,0,-.0116,-.014,-1e-4,-.0037,-.0052,-5e-4,.0028,.003,-4e-4,.0041,.0015,6e-4,.0088,-.0076,-.0011,-.0015,-.0073,7e-4,-.0011,.0019,-.0011,-5e-4,.0031,-1e-4,-.0018,9e-4,.0018,.0038,.0068,-4e-4,-1e-4,.0061,.0024,.0024,-.0066,-6e-4,.0051,.0014,.002,.005,-.0035,1e-4,-.0034,-.004,-7e-4,.001,-8e-4,1e-4,-5e-4,-.0021,2e-4,.0045,-.0043,-.0012,-.0024,-.0014,6e-4,.0034,.0027,-8e-4,-.0053,.0014,1e-4,.0013,-.0018,6e-4,-.0015,.0029,-2e-4,-.0035,1e-4,-.002,.0012,.0048,.0011,1e-4,-2e-4,-3e-4,-.0012,.0033,6e-4,.002,-.0033,4e-4,.0028,2e-4,8e-4,-1e-4,-.0018,8e-4,.0017,1e-4,9e-4,8e-4,3e-4,.0019,-.001,.001,-7e-4,-.0013,0,1e-4,.0032,-1e-4,1e-4,.0011,-4e-4,5e-4,-7e-4,.0018,-3e-4,2e-4,7e-4,8e-4,-.0014,7e-4,.0015,-6e-4,-1e-4,-4e-4,.0019,-9e-4,-6e-4,-6e-4,-.0012,2e-4,-.0012,-8e-4,4e-4,6e-4,-.0011,3e-4,9e-4,-4e-4,6e-4,-7e-4,-4e-4],expression:[-.0603,2.0527,1.9014,.1025,.6143,.3804,.7881,-.1023,-.0764,.0454,-.2487,-.5073,-.6704,-.031,-.0181,.0466,.0651,-.0726,-.0033,-.0022,.2944,.0101,.1669,-.5225,-.4685,.0236,.0079,.011,.2173,.4529,.0121,-.2104,-.0673,.0225,-.4023,.0317,-9e-4,.0076,-.0032,.0333,.0523,.0129,-.001,-.0319,-.0139,.0015,-.0044,.0247,-5e-4,.0161,.0061,.0074,.0776,-.0176,.007,.055,-.017,.0052,-.1819,.0294,-.0161,-.0337,.0226,-.008,-.0297,.1967,-.0095,.0383,.2039,.0434,.0271,-.0064,-.0037,-.0294,-.024,.0024,-.0137,-.0209,-.0031,.0628,.1003,-.0126,-.056,-.0097,-.0012,-.0041,.0162]},11:{mean:[.2505,.3833,.7793],identity:[.0098,.012,.0077,-6e-4,-3e-4,0,1e-4,.0082,-7e-4,.0019,-.0036,-.0012,2e-4,.0119,-.0039,.001,1e-4,.0031,-.0036,-.0059,-7e-4,.0026,.0028,-.0011,9e-4,-.0032,8e-4,.0029,.0043,3e-4,.0025,-9e-4,.0047,.0016,.0022,.0018,-.001,.0025,-.003,-.001,.0033,.0034,4e-4,-.0052,.0024,-2e-4,.001,-.0014,-6e-4,.0038,-.0015,-6e-4,-.001,-.0011,-4e-4,-.001,4e-4,-7e-4,.0036,-8e-4,-2e-4,-.0019,5e-4,3e-4,-6e-4,-.0024,-.0017,-.0014,6e-4,-4e-4,-.0031,-.0013,-6e-4,.0042,2e-4,-2e-4,-.002,-3e-4,8e-4,.0018,-5e-4,-6e-4,-2e-4,-6e-4,.0025,.0019,.001,8e-4,-.0015,-.0012,-1e-4,-6e-4,-4e-4,.0023,-.001,6e-4,-2e-4,-.001,0,-9e-4,-.002,-.0011,1e-4,0,-1e-4,5e-4,6e-4,9e-4,-6e-4,5e-4,8e-4,-1e-4,-2e-4,-.0017,-6e-4,-4e-4,4e-4,-6e-4,.0012,4e-4,3e-4,-7e-4,3e-4,-2e-4,6e-4,1e-4,5e-4,-.0019,-6e-4,4e-4,7e-4,-1e-4,1e-4,5e-4,.001,-6e-4,-.002,-7e-4,-5e-4,5e-4,3e-4,7e-4,.0014,0,5e-4,-5e-4,-2e-4,3e-4,-6e-4,-1e-4],expression:[-9e-4,-3e-4,.0032,-.003,-.0034,-.0031,.0014,0,4e-4,-.0139,-.0764,.0275,-.002,-.0089,.0031,-.0503,-.0771,.038,-.1323,-.3523,.1368,-.0474,-.0564,.0296,-.0045,.007,-.0013,.0153,.1259,-.0464,.0866,.2175,-.0786,-.0413,-.1248,.0448,-.1777,-.4607,.1782,-5e-4,-.005,.0016,.0629,.1506,-.0624,.0545,.2576,-.0864,-.0231,-.0552,.0244,-.0136,-.0359,.0169,-.1158,-.2996,.1214,-.0235,-.0354,.0165,-.0745,-.1079,.0475,-.0116,-.0039,.0012,.0013,-.0108,-8e-4,.0044,-.0027,-1e-4,-.0694,.0363,.0071,.1462,-.136,.0047,.009,-.0177,.0038,-.0271,.0118,.0011,-.0399,-.0111,.0123]},12:{mean:[-.2981,.3828,.7563],identity:[-.0116,.014,.0054,.0018,5e-4,0,-4e-4,.0068,-.0013,-.0019,-.0048,-5e-4,5e-4,.0108,-.0036,-.0029,-.0018,.0029,.0043,-.0077,6e-4,-.0017,.002,-.0011,-.0014,-.0035,.0015,-.0024,.0011,4e-4,-.0048,2e-4,.0029,-1e-4,-1e-4,.003,.0019,.0035,-.0016,-4e-4,.0039,.0019,1e-4,-.0064,.004,3e-4,.002,-.0021,.0017,.0011,-.001,.0026,.0025,-5e-4,2e-4,-3e-4,-5e-4,-7e-4,9e-4,-4e-4,-.001,-.0022,.001,9e-4,-.0014,7e-4,.0011,-.001,-5e-4,-8e-4,-.0017,-.0021,9e-4,.0036,5e-4,4e-4,-.0031,6e-4,-.0015,.0027,2e-4,1e-4,-.0011,2e-4,-.0011,-.0018,4e-4,-.0013,-2e-4,7e-4,9e-4,-3e-4,.001,-.0021,8e-4,6e-4,-9e-4,4e-4,-7e-4,8e-4,-.002,-.0013,0,7e-4,-.0012,-1e-4,.0014,.0014,-1e-4,.0013,6e-4,6e-4,-.0014,-.0015,-9e-4,1e-4,1e-4,9e-4,7e-4,0,1e-4,-.001,-4e-4,0,-5e-4,1e-4,-3e-4,4e-4,-5e-4,-1e-4,-.0011,2e-4,0,1e-4,8e-4,8e-4,0,-7e-4,-8e-4,0,2e-4,-1e-4,.001,3e-4,4e-4,-2e-4,0,5e-4,.0018,-1e-4],expression:[0,-4e-4,.0028,.0036,-8e-4,-.0026,-.0015,-8e-4,3e-4,.0075,-.0608,.025,.0019,-.0076,.0033,.0379,-.0437,.0335,.0964,-.2452,.1233,.0368,-.0251,.0253,.0033,.0097,-.0021,-.0095,.1171,-.0475,-.064,.1548,-.0718,.0228,-.0831,.0343,-.1924,.6206,-.2771,.0021,-.0143,.0056,-.0705,.2522,-.1116,-.0692,.4229,-.1592,-.0093,.05,-.0185,.0948,-.3196,.1437,-.0184,.0194,-.0131,.0205,-.0353,.0201,.0676,-.135,.0672,.0137,-.0311,.0118,3e-4,-.0077,-2e-4,-.0151,4e-4,-.0058,.029,-.0139,.0163,.1324,.1819,-.0039,.0406,.0501,.0017,.0331,.0161,.0062,-.0235,-.0446,.0047]}},tx=1,tM=new Map;class tk{constructor(e){this._name=e,this.anchor_pose=z.vt()}_getVertex(e,t,r){let i=r.mean.slice();for(let t=0;t<50;t++)i[0]+=e[t]*r.identity[3*t+0],i[1]+=e[t]*r.identity[3*t+1],i[2]+=e[t]*r.identity[3*t+2];for(let e=0;e<29;e++)i[0]+=t[e]*r.expression[3*e+0],i[1]+=t[e]*r.expression[3*e+1],i[2]+=t[e]*r.expression[3*e+2];return i}update(e,t,r){let i,a=tR[this._name.toString()];if(a){if(Array.isArray(a)){i=this._getVertex(e,t,a[0]);let r=this._getVertex(e,t,a[1]);i[0]=.5*(i[0]+r[0]),i[1]=.5*(i[1]+r[1]),i[2]=.5*(i[2]+r[2])}else i=this._getVertex(e,t,a);r&&(i[0]*=-1),z.kN(this.anchor_pose,i)}}}let tI={incompatible:()=>!("function"==typeof Promise&&"object"==typeof WebAssembly&&navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices&&navigator.mediaDevices.getUserMedia&&1),incompatible_ui:()=>{let e=document.createElement("div");e.append(function(){let e=document.createElement("div"),t="a recent web browser";navigator.userAgent.match(/Android/i)?(t="Chrome for Android",window.location.href="googlechrome://navigate?url="+encodeURI(window.location.href),setTimeout(()=>{window.location.href="samsunginternet://open?url="+encodeURI(window.location.href)},2e3)):navigator.userAgent.match(/iPhone|iPod|iPad/i)&&(t="Safari",e.classList.add("zee-launcher-browser-safari")),e.classList.add("zee-launcher-unsupported"),e.innerHTML=`
            <style>.zee-launcher-unsupported {
               display: flex;
               flex-direction: column;
               height: 100%;
               justify-content: center;
               position: absolute;
               width: 100%;
               height: 100%;
               top: 0;
               left: 0;
               align-items: center;
               }
               .zee-launcher-browser-logo {
               background-image: url("data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg version='1.1' viewBox='0 0 210 211' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg transform='translate(-82 -146)' fill-rule='nonzero' stroke='%23ffffff' stroke-width='2'%3E%3Cg transform='translate(83 146.5)'%3E%3Cpath d='m55.146 88.785l-32.039-49.472c19.962-24.947 49.904-38.684 80.517-38.81 17.739-0.12642 35.855 4.4246 52.336 13.99 18.2 10.619 32.039 25.874 40.846 43.404l-86.095-4.5511c-24.365-1.4327-47.556 12.347-55.565 35.439zm13.797 16.224c0 19.468 15.684 35.229 35.059 35.229 19.374 0 35.059-15.76 35.059-35.229 0-19.468-15.684-35.229-35.059-35.229-19.374 0-35.059 15.718-35.059 35.229zm132.06-37.588l-58.585 3.034c15.894 18.668 16.145 45.595 2.7678 66.243l-47.01 72.648c19.5 1.0535 39.588-3.2447 57.788-13.864 45.039-26.126 63.282-80.908 45.039-128.06zm-144.93 57.647l-39.126-77.326c-10.694 16.434-16.942 36.156-16.942 57.267 0 52.253 38.078 95.53 87.856 103.2l26.713-52.59c-24.155 4.5511-47.472-8.765-58.501-30.551z'/%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/svg%3E%0A");
               width: 211px;
               height: 211px;
               margin-bottom: 25%;
               margin-top: -60px;
               background-repeat: no-repeat;
               }
               .zee-launcher-browser-safari .zee-launcher-browser-logo {
               background-image: url("data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg version='1.1' viewBox='0 0 211 211' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg transform='translate(-82 -146)' fill-rule='nonzero' stroke='%23ffffff' stroke-width='2'%3E%3Cpath d='m180 251.86c0-4.0385 2.9377-7.855 7.2552-7.855 3.9614 0 7.7448 2.8402 7.7448 7.145 0 4.0385-2.8487 7.855-7.1662 7.855-4.0059 0-7.8338-2.9734-7.8338-7.145zm112-0.35503c0 57.728-46.772 104.5-104.5 104.5s-104.5-46.772-104.5-104.5 46.772-104.5 104.5-104.5 104.5 46.772 104.5 104.5zm-12-1c0-51.649-41.851-93.5-93.5-93.5s-93.5 41.851-93.5 93.5 41.851 93.5 93.5 93.5 93.5-41.851 93.5-93.5zm-30.624 40.983c0 1.5095 5.4495 4.2768 6.8328 5.1154-11.486 17.401-29.26 29.938-49.423 34.928l-1.8444-7.757c-0.12576-1.0482-0.79646-1.174-1.7606-1.174-0.79646 0-1.2576 1.174-1.1737 1.7611l1.8444 7.8828c-5.5753 1.174-11.234 1.7611-16.935 1.7611-15.217 0-30.182-4.2768-43.177-12.202 0.71263-1.174 5.1141-7.5474 5.1141-8.4698 0-0.79666-0.71263-1.5095-1.5091-1.5095-1.6348 0-5.1141 6.9603-6.1621 8.344-17.522-11.615-30.182-29.602-35.044-50.148l8.0066-1.761c0.92222-0.25158 1.1737-0.92246 1.1737-1.7611 0-0.79667-1.1737-1.2579-1.8444-1.174l-7.8389 1.803c-1.048-5.3251-1.6348-10.692-1.6348-16.143 0-15.556 4.4015-30.86 12.66-43.984 1.1737 0.71281 6.749 4.5284 7.6712 4.5284 0.79646 0 1.5091-0.58702 1.5091-1.3837 0-1.6353-6.1621-4.7381-7.5455-5.7024 11.821-17.275 29.805-29.728 50.219-34.34l1.7606 7.757c0.25152 0.92246 0.92222 1.174 1.7606 1.174 0.83838 0 1.2576-1.174 1.1737-1.8449l-1.7606-7.6732c5.1141-0.92246 10.312-1.5095 15.552-1.5095 15.552 0 30.727 4.4026 43.973 12.663-0.79646 1.174-4.5273 6.6249-4.5273 7.5474 0 0.79667 0.58687 1.5095 1.3833 1.5095 1.6348 0 4.7369-6.0379 5.5753-7.4216 17.187 11.615 29.469 29.351 34.248 49.561l-6.4975 1.3837c-1.048 0.25158-1.1737 0.92246-1.1737 1.8449 0 0.79667 1.1737 1.2579 1.7606 1.174l6.6232-1.5095c1.048 5.3251 1.6348 10.776 1.6348 16.227 0 15.221-4.1919 30.189-12.073 43.062-1.1737-0.58702-6.0364-4.0672-6.9586-4.0672-0.8803 0-1.5929 0.71281-1.5929 1.5095zm-14.876-98.483c-5.2178 4.88-53.863 49.48-55.228 51.8l-38.772 64.2c5.0974-4.76 53.863-49.6 55.108-51.72l38.892-64.28z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
               }
               .zee-launcher-unsupported-message {
               text-align: center;
               width: 250px;
               font-family: sans-serif;
               color: #ffffff;
               }
               .zee-launcher-unsupported-message-copy {
               border: 1px solid #ffffff;
               border-radius: 5px;
               margin-top: 10px;
               }
               #zee-launcher-unsupported-message-input {
               border: none;
               padding: 10px;
               border-radius: 0px;
               border-right: 1px solid #344B60;
               height: 40px;
               color: #ffffff;
               background-color: black;
               box-sizing: border-box;
               width: calc(100% - 65px);
               margin-left: 5px;
               }
               #zee-launcher-unsupported-message-button {
               background: none;
               border: none;
               outline: none;
               text-transform: uppercase;
               color: #ffffff;
               height: 40px;
               display: inline-block;
               width: 59px;
               }
               .zee-launcher-unsupported-message-before-copy {
               height: 100px;
               display: flex;
               flex-direction: column;
               justify-content: center;
               margin-top: 20px;
               }
               .zee-launcher-unsupported-message-copied .zee-launcher-unsupported-message-before-copy {
               display: none;
               }
               .zee-launcher-unsupported-message-after-copy {
               display: none;
               }
               .zee-launcher-unsupported-message-copied .zee-launcher-unsupported-message-after-copy {
               height: 100px;
               display: flex;
               flex-direction: column;
               justify-content: center;
               margin-top: 20px;
               }
            </style>
            <div class="zee-launcher-browser-logo"></div>
            <div class="zee-launcher-unsupported-message">Open with ${t} to access this content.</div>
            <div class="zee-launcher-unsupported-message-before-copy">
               <div class="zee-launcher-unsupported-message ">Tap below to copy the address for easy pasting into ${t}.</div>
               <div class="zee-launcher-unsupported-message-copy"><input id="zee-launcher-unsupported-message-input" type="text/"><button id="zee-launcher-unsupported-message-button">Copy</button></div>
            </div>
            <div class="zee-launcher-unsupported-message zee-launcher-unsupported-message-after-copy">COPIED! Now paste into ${t}'s address bar to experience the content.</div>
    `;let r=e.querySelector("#zee-launcher-unsupported-message-input")||document.createElement("input");r.value=window.location.href;let i=e.querySelector("#zee-launcher-unsupported-message-button")||document.createElement("button"),a=()=>{if(navigator.userAgent.match(/iPhone|iPod|iPad/i)){let e=document.createRange();e.selectNodeContents(r);let t=window.getSelection();if(!t)return;t.removeAllRanges(),t.addRange(e),r.setSelectionRange(0,0x3b9ac9ff)}else r.select();document.execCommand("copy"),r.blur(),e.classList.toggle("zee-launcher-unsupported-message-copied",!0)};return i.addEventListener("click",a),r.addEventListener("click",a),e}()),Object.assign(e.style,{position:"fixed",width:"100%",height:"100%",top:"0px",left:"0px",zIndex:1001,backgroundColor:"rgba(0, 0, 0, 0.9)",fontFamily:"sans-serif",color:"white",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}),e.classList.add("zee_launcher_compatibility"),document.body.append(e)}},tS=1,tF=new Map;class tC extends eg{constructor(e,t){super(),this._impl=e,this._pipeline=t,this._packetNumber=0,this._motionUpdatesQueued=0,this._motionUpdatesSent=0,this._minFrameGapMs=0,this._lastUpdateTime=0}static create(e){let t=tS++;return tF.set(t,new tC(t,e)),eh("sequence_source_source_t initialized"),t}static get(e){return tF.get(e)}loadFromMemory(e){try{this._decoder=new ef(e),this._packetNumber=0,this._lastUpdateTime=0}catch(e){eu("Unable to decode sequence:",e)}}maxPlaybackFpsSet(e){if(e<=0){this._minFrameGapMs=0;return}this._minFrameGapMs=1e3/e}setTime(e){e<0?delete this._time:this._time=e}getFrame(e){var t;let r=eN.get(this._pipeline);if(!r||!this._decoder||(this._submitMotionUpdates(r),this._motionUpdatesQueued>this._motionUpdatesSent||e))return;let i=null!=(t=this._time)?t:performance.now();if(i<this._lastUpdateTime+this._minFrameGapMs||this._packetNumber>=this._decoder.numberPackets)return;let a=this._decoder.dataByPacket.get(this._packetNumber);if(a.type!=w.CAMERA_FRAME)return;this._packetNumber++;let s=r.cameraPixelArrays.pop();for(;s&&s.byteLength!==a.greyscale.byteLength;)s=r.cameraPixelArrays.pop();s||(s=new ArrayBuffer(a.greyscale.byteLength)),new Uint8Array(s).set(a.greyscale),this._lastUpdateTime=i;let n={data:s,cameraSourceData:a.greyscale,cameraModel:a.cameraModel,cameraToDevice:a.cameraToDevice,dataWidth:a.width,dataHeight:a.height,texture:void 0,userFacing:a.userFacing,uvTransform:z.vt(),cameraSource:this};this._submitMotionUpdates(r);let o=r.registerToken(n);r.sendDataToWorker(n.data||new ArrayBuffer(0),o,n.dataWidth,n.dataHeight,n.userFacing,n.cameraToDevice,n.cameraModel,-1)}destroy(){tF.delete(this._impl),this.pause()}start(){var e;let t=eN.get(this._pipeline);t&&t.currentCameraSource!==this&&(null==(e=t.currentCameraSource)||e.pause(),t.currentCameraSource=this)}pause(){let e=eN.get(this._pipeline);e&&e.currentCameraSource===this&&(e.currentCameraSource=void 0)}uploadGL(e){let t=eN.get(this._pipeline);if(!t)return;let r=null==t?void 0:t.glContext;if(r)e.texture||(e.texture=t.getVideoTexture()),e.texture&&e.cameraSourceData&&(r.bindTexture(r.TEXTURE_2D,e.texture),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1),r.texImage2D(r.TEXTURE_2D,0,r.LUMINANCE,e.dataWidth,e.dataHeight,0,r.LUMINANCE,r.UNSIGNED_BYTE,new Uint8Array(e.cameraSourceData)),r.bindTexture(r.TEXTURE_2D,null))}_submitMotionUpdates(e){let t=!1;for(;this._packetNumber<this._decoder.numberPackets;){let r=this._decoder.dataByPacket.get(this._packetNumber);if(r.type==w.CAMERA_FRAME)break;switch(r.type){case w.ACCELEROMETER:e.motionAccelerometerSubmit(r.t,r.x,r.y,r.z),t=!0;break;case w.ROTATION_RATE:e.motionRotationRateSubmit(r.t,r.x,r.y,r.z),t=!0;break;case w.ATTITUDE:e.motionAttitudeSubmit(r.t,r.x,r.y,r.z),t=!0;break;case w.ATTITUDE_MATRIX:e.motionAttitudeMatrix(r.attitude),t=!0;break;case w.ACCELEROMETER_WO_GRAVITY_INT:e.motionAccelerometerWithoutGravitySubmitInt(r.t,r.int,r.x,r.y,r.z),t=!0;break;case w.ACCELEROMETER_W_GRAVITY_INT:e.motionAccelerometerWithGravitySubmitInt(r.t,r.int,r.x,r.y,r.z),t=!0;break;case w.ATTITUDE_INT:e.motionAttitudeSubmitInt(r.t,r.int,r.x,r.y,r.z),t=!0;break;case w.ROTATION_RATE_INT:e.motionRotationRateSubmitInt(r.t,r.int,r.x,r.y,r.z),t=!0}this._packetNumber++}t&&(this._motionUpdatesQueued++,setTimeout(()=>{this._motionUpdatesSent++},0))}}function tD(){var e=new B.tb(2);return B.tb!=Float32Array&&(e[0]=0,e[1]=0),e}function tU(e,t){return e[0]=t[0],e[1]=t[1],e}function tP(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function tL(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function tz(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function tB(e){return Math.hypot(e[0],e[1])}function tO(){return{indices:new Uint16Array(0),vertices:new Float32Array(0),normals:new Float32Array(0),uvs:new Float32Array(0)}}function tN(e){let t=2*e.trainedWidth/(e.trainedHeight*e.topRadius);return tV(e,2,!1,0,0,0,tD(),e.trainedWidth/e.trainedHeight,t,e.physicalScaleFactor)}function tV(e,t,r,i,a,s,n,o,l,_){isNaN(o)&&(o=1);let c=[],d=[],h=_>0?_:1,u=2*h/t;for(let t=0;t<=64;++t){let i=t*l/64+(2*Math.PI-l)/2,a=e.bottomRadius*Math.sin(i)*u,s=e.bottomRadius*Math.cos(i)*u,n=e.topRadius*Math.sin(i)*u,o=e.topRadius*Math.cos(i)*u,_=-1*h;r?(c.push(a,_,s),c.push(n,h,o)):(c.push(n,h,-o),c.push(a,_,-s))}for(let t=0;t<=64;++t)if(e.type==I.yc.IMAGE_TRACKER_TYPE_CYLINDRICAL){let e=1-t/64;d.push(e,1),d.push(e,0)}else{let e=-(2*(t/64-.5))*i;r&&(e=-e+i)>i&&(e=-i+(e-i));let l=tD();l[0]=Math.sin(e),l[1]=Math.cos(e),r&&(l[1]*=-1);let _=tD();tU(_,l),tz(_,_,a),tP(_,n,_);let c=tD();tU(c,l),tz(c,c,s),tP(c,n,c),d.push((c[0]+o)/(2*o),1-(-c[1]+1)/2),d.push((_[0]+o)/(2*o),1-(-_[1]+1)/2)}let m=[];for(let e=0;e<64;++e){let t=2*e;m.push(t+1,t+2,t+3),m.push(t+0,t+2,t+1)}return{vertices:new Float32Array(c),indices:new Uint16Array(m),normals:new Float32Array(0),uvs:new Float32Array(d)}}tD();let tG=new TextDecoder;class tW{constructor(e,t=!1){this._data=e,this._paddingBytes=t,this.truncatedChunks=!1,this._view=new DataView(this._data),this.root=this._parse()}_parse(){if("RIFF"!==tG.decode(this._data.slice(0,4)))throw Error("Not a valid ZPT file");return this._parseChunk(0)}_parseChunk(e){let t,r,i=tG.decode(this._data.slice(e,e+4)),a=this._view.getUint32(e+4,!0),s=new Uint8Array(this._data,e+8,a);if(s.byteLength!==a&&(this.truncatedChunks=!0),"RIFF"===i||"LIST"===i){r=tG.decode(this._data.slice(e+8,e+12)),t=[];let i=4;for(;i<s.byteLength-1;){let r=this._parseChunk(e+8+i);t.push(r),i+=r.data.byteLength+8,this._paddingBytes&&1&r.data.byteLength&&i++}}return{ident:i,data:s,subident:r,subchunks:t}}find(e,t=this.root){if(t.ident===e)return t;if(t.subchunks)for(let r of t.subchunks){let t=this.find(e,r);if(t)return t}}has(e){return void 0!==this.find(e)}}let tq=new Map,tH=new TextDecoder;class tj{constructor(e,t){this._client=e,this._impl=t,this._targets=[]}static create(e,t){let r=t.image_tracker_create(e);return tq.set(r,new tj(t,r)),r}static get(e){return tq.get(e)}destroy(){this._client.image_tracker_destroy(this._impl),tq.delete(this._impl)}loadFromMemory(e){this._targets.push({data:e}),this._client.image_tracker_target_load_from_memory(this._impl,e)}targetCount(){return this._targets.length}getTargetInfo(e){let t=this._targets[e];if(t&&t.info)return t.info;t.info={topRadius:-1,bottomRadius:-1,sideLength:-1,physicalScaleFactor:-1,trainedWidth:0,trainedHeight:0,type:I.yc.IMAGE_TRACKER_TYPE_PLANAR};try{let e=new tW(t.data,!1),r=e.find("IMG ");if(r){let i="image/png",a=e.find("IMGM");a&&(i=tH.decode(a.data)),t.info.preview={mimeType:i,compressed:r.data}}let i=e.find("ODLE");if(i){let e=tH.decode(i.data);this._parseOdle(e,t.info)}}catch(e){}return t.info}_parseOdle(e,t){let r=0,i="0";return([i,r]=tY(r,e),"1"===i)?this._parseOdleV1(e,r,t):"3"===i?this._parseOdleV3(e,r,t):void 0}_parseOdleV1(e,t,r){let i="0";if([i,t]=tY(t,e),"0"!==i&&"1"!==i)return;let a="";if([a,t]=tY(t,e),0!==a.length)return;let s="";[s,t]=tY(t,e);let n=s.split(" ");n.length<5||(r.trainedWidth=parseInt(n[3].replace("[","")),r.trainedHeight=parseInt(n[4].replace("]","")))}_parseOdleV3(e,t,r){let i="0";if([i,t]=tY(t,e),"0"!==i&&"1"!==i)return;let a="0";[a,t]=tY(t,e);let s=parseInt(a);if(isNaN(s)||s<1)return;let n="";if([n,t]=tY(t,e),0!==n.length)return;let o="";[o,t]=tY(t,e);let l=o.split(" ");if(l.length<6)return;let _=parseInt(l[0]);(0===_||1===_||2===_)&&(r.type=_),r.trainedWidth=parseInt(l[4].replace("[","")),r.trainedHeight=parseInt(l[5].replace("]","")),l.length>=7&&(r.physicalScaleFactor=parseFloat(l[6]),isNaN(r.physicalScaleFactor)&&(r.physicalScaleFactor=-1)),l.length>=8&&(r.topRadius=parseFloat(l[7]),isNaN(r.topRadius)&&(r.topRadius=-1),r.bottomRadius=r.topRadius),l.length>=9&&(r.bottomRadius=parseFloat(l[8]),isNaN(r.bottomRadius)&&(r.bottomRadius=-1)),l.length>=10&&(r.sideLength=parseFloat(l[9]),isNaN(r.sideLength)&&(r.sideLength=-1))}getDecodedPreview(e){let t=this.getTargetInfo(e);if(t.preview){if(!t.preview.image){let e=new Blob([t.preview.compressed],{type:t.preview.mimeType});t.preview.image=new Image,t.preview.image.src=URL.createObjectURL(e)}return t.preview.image}}getPreviewMesh(e){let t=this.getTargetInfo(e);return t.previewMesh||(t.previewMesh=function(e){switch(e.type){case I.yc.IMAGE_TRACKER_TYPE_PLANAR:var t=e;let r=t.trainedWidth/t.trainedHeight;if(isNaN(r))break;let i=t.physicalScaleFactor>0?t.physicalScaleFactor:1,a=new Float32Array([-1*r*i,-1*i,0,-1*r*i,i,0,r*i,i,0,r*i,-1*i,0]);return{vertices:a,indices:new Uint16Array([0,2,1,0,3,2]),uvs:new Float32Array([0,0,0,1,1,1,1,0]),normals:new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1])};case I.yc.IMAGE_TRACKER_TYPE_CYLINDRICAL:return tN(e);case I.yc.IMAGE_TRACKER_TYPE_CONICAL:return function(e){let t=e.topRadius-e.bottomRadius;if(0===t)return console.warn("Conical target has matching radii, using cylindrical preview mesh with a defined image size instead."),tN(e);let r=Math.sqrt(e.sideLength*e.sideLength-t*t),i=e.bottomRadius>e.topRadius,a=e.trainedWidth/e.trainedHeight;isNaN(a)&&(a=1);let s=!(e.bottomRadius>0)||!(e.topRadius>0),n=e.sideLength<2*Math.abs(e.topRadius-e.bottomRadius),o=tD(),l=tD(),_=tD();if(s)if(n)if(i){_[1]=a-1;let e=Math.acos((2-a)/a);o[0]=a*Math.sin(e),o[1]=a-1+a*Math.cos(e),tU(l,_)}else{_[1]=1-a;let e=Math.PI+Math.acos((2-a)/a);o[0]=a*Math.sin(e),o[1]=1-a+a*Math.cos(e),tU(l,_)}else i?(_[1]=1,tU(l,_),o[0]=a,o[1]=1-Math.sqrt(4-Math.pow(a,2))):(_[1]=-1,tU(l,_),o[0]=-a,o[1]=Math.sqrt(4-Math.pow(a,2))-1);else if(n)if(i){_[1]=a-1;let t=Math.acos((2-a)/a);o[0]=a*Math.sin(t),o[1]=a-1+a*Math.cos(t),l[0]=(a-e.sideLength)*Math.sin(t),l[1]=a-1+(a-e.sideLength)*Math.cos(t)}else{_[1]=1-a;let t=Math.PI+Math.acos((2-a)/a);o[0]=a*Math.sin(t),o[1]=1-a+a*Math.cos(t),l[0]=(a-e.sideLength)*Math.sin(t),l[1]=1-a+(a-e.sideLength)*Math.cos(t)}else{let t=i?e.topRadius/e.bottomRadius:e.bottomRadius/e.topRadius;i?(l[0]=t*a,l[1]=1,o[0]=a,o[1]=1-Math.sqrt(e.sideLength*e.sideLength-(l[0]-o[0])*(l[0]-o[0])),_[1]=o[1]+o[0]/(o[0]-l[0])*(l[1]-o[1])):(l[0]=-t*a,l[1]=-1,o[0]=-a,o[1]=Math.sqrt(e.sideLength*e.sideLength-(l[0]-o[0])*(l[0]-o[0]))-1,_[1]=o[1]- -o[0]/(l[0]-o[0])*(o[1]-l[1]))}let c=tD();tL(c,o,_);let d=tD();tL(d,l,_);let h=tB(c),u=tB(d),m=2*Math.abs(Math.atan(c[0]/c[1]));n&&(m=2*Math.PI-m);let p=h*m/e.topRadius,f=Math.abs(Math.atan(c[0]/c[1]));return n&&(f=Math.PI-f),tV(e,r,i,f,u,h,_,a,p,e.physicalScaleFactor)}(e)}return tO()}(t)),t.previewMesh}}function tY(e,t){let r=t.indexOf("\n",e);return[t.substring(e,r>=0?r:void 0).replace("\r",""),r+1]}let tX=`
#ifndef GL_ES
#define highp
#define mediump
#define lowp
#endif

uniform mat4 projMatrix;
uniform mat4 cameraMatrix;
uniform mat4 modelViewMatrix;
attribute vec4 position;
attribute vec2 textureCoord;

varying highp vec2 vTextureCoord;

void main()
{
    gl_Position = projMatrix * cameraMatrix * modelViewMatrix * position;
    vTextureCoord = textureCoord;
}`,tZ=`
#define highp mediump
#ifdef GL_ES
    // define default precision for float, vec, mat.
    precision highp float;
#else
#define highp
#define mediump
#define lowp
#endif

varying highp vec2 vTextureCoord;
uniform sampler2D skinSampler;

void main()
{
    vec2 pixels = 500.0 * vTextureCoord + 0.5;
    if ((int(mod(pixels.x, 50.0)) == 0) || (int(mod(pixels.y, 50.0)) == 0)) {
        gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);
    } else {
        discard;
    }
}`;z.vt();let t$=`
#ifndef GL_ES
#define highp
#define mediump
#define lowp
#endif

uniform mat4 projMatrix;
uniform mat4 cameraMatrix;
uniform mat4 modelViewMatrix;
attribute vec4 position;
attribute vec4 color;

varying highp vec4 vColor;

void main()
{
    gl_Position = projMatrix * cameraMatrix * modelViewMatrix * position;
    vColor = color;
}`,tK=`
#define highp mediump
#ifdef GL_ES
    // define default precision for float, vec, mat.
    precision highp float;
#else
#define highp
#define mediump
#define lowp
#endif

varying highp vec4 vColor;

void main()
{
    gl_FragColor = vColor;
}`;var tQ=function(e,t,r,i){return new(r||(r=Promise))(function(a,s){function n(e){try{l(i.next(e))}catch(e){s(e)}}function o(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(n,o)}l((i=i.apply(e,t||[])).next())})};let tJ=new Map,t0=z.vt(),t1=O();function t4(){!u&&(console.log("Zappar JS v4.0.0-beta.2"),console.log("Zappar CV v3.4.0-beta.1"),u=function(e){let t,u;if(h)return h;let m=!1;(function(e){return H(this,void 0,void 0,function*(){var t;function i(){for(let t of j.getOutgoingMessages())e.postMessage(t.msg,t.transferables)}e||(e=new Worker(r.tu(new URL(r.p+r.u(606),r.b)),{type:void 0})),e.postMessage({t:"wasm",url:new r.U(r(6391)).toString(),module:yield X,shouldRecordData:Y}),yield(t=e,new Promise(e=>{let r=i=>{"loaded"===i.data&&(t.removeEventListener("message",r),e())};t.addEventListener("message",r)})),j.onOutgoingMessage.bind(i),i(),e.addEventListener("message",e=>{j.postIncomingMessage(e.data)})})})(null==e?void 0:e.worker).then(()=>{eh("Fully loaded"),m=!0});let p=new C(e=>{j.postOutgoingMessage({t:"zappar",d:e},[e])}),f=function(){let e=window.localStorage.getItem("z_uar_lid");if(null===e){let t=new Uint8Array(8);window.crypto.getRandomValues(t),e="";for(let r=0;r<t.byteLength;r++){let i=t[r].toString(16);1===i.length?e+="0"+i:2===i.length&&(e+=i)}}return e}(),g=!1,v=!1;try{let e=Object.fromEntries(document.cookie.split("; ").map(e=>e.split(/=(.*)/s).map(decodeURIComponent)));if(e["zw-uar-project"]){let t=JSON.parse(e["zw-uar-project"]);"object"==typeof t&&"string"==typeof t.id&&(p.impl.analytics_project_id_set(".wiz"+t.id,f),v=!0)}}catch(e){}if(!v&&(window.location.hostname.toLowerCase().indexOf(".zappar.io")>0||window.location.hostname.toLowerCase().indexOf(".webar.run")>0||window.location.hostname.toLowerCase().indexOf(".arweb.app")>0||window.location.hostname.toLowerCase().indexOf(".zappar-us.io")>0||window.location.hostname.toLowerCase().indexOf(".zappar-eu.io")>0)){let e=window.location.pathname.split("/");e.length>1&&e[1].length>0&&(p.impl.analytics_project_id_set(".wiz"+e[1],f),v=!0)}j.onIncomingMessage.bind(t=>{var i,a,s,n,o,l,_,c;switch(t.t){case"zappar":null==(i=eN.get(t.p))||i.pendingMessages.push(t.d);break;case"buf":p.serializer.bufferReturn(t.d);break;case"cameraFrameRecycleS2C":null==(s=null==(a=eN.get(t.p))?void 0:a.cameraTokenReturn)||s.call(a,t);break;case"videoFrameS2C":null==(o=null==(n=eN.get(t.p))?void 0:n.videoFrameFromWorker)||o.call(n,t);break;case"imageBitmapS2C":null==(_=null==(l=eN.get(t.p))?void 0:l.imageBitmapFromWorker)||_.call(l,t);break;case"raw":null==(c=eN.get(t.p))||c.cameraFrameDataRawResult(t);break;case"streamEndedS2C":{let e=eC(t.source);e instanceof ek&&e.streamEnded();break}case"setupCeresWorker":!function(e,t,i,a){H(this,void 0,void 0,function*(){i||(i=new Worker(r.tu(new URL(r.p+r.u(105),r.b)),{type:void 0})),i.postMessage({t:"wasm",url:new r.U(r(6391)).toString(),module:yield X,port:e,instance:0},[e]),a||(a=new Worker(r.tu(new URL(r.p+r.u(486),r.b)),{type:void 0})),a.postMessage({t:"wasm",url:new r.U(r(6391)).toString(),module:yield X,port:t,instance:1},[t])})}(t.port0,t.port1,null==e?void 0:e.ceresWorker0,null==e?void 0:e.ceresWorker1);break;case"_z_datadownload":{let e=new Blob([t.data],{type:"application/octet-stream"}),r=URL.createObjectURL(e),i=document.createElement("a");i.download="sequencedata.bin",i.href=r,i.click();break}case"licerr":{let e=document.createElement("div");e.innerHTML="Visit <a href='https://docs.zap.works/universal-ar/licensing/' style='color: white;'>our licensing page</a> to find out about hosting on your own domain.",e.style.position="absolute",e.style.bottom="20px",e.style.width="80%",e.style.backgroundColor="black",e.style.color="white",e.style.borderRadius="10px",e.style.padding="10px",e.style.fontFamily="sans-serif",e.style.textAlign="center",e.style.left="10%",e.style.zIndex=Number.MAX_SAFE_INTEGER.toString();let t=document.createElement("span");t.innerText=" (30)",e.append(t);let r=30;setInterval(function(){--r>=0&&(t.innerText=" ("+r.toString()+")")},1e3),document.body.append(e)}case"gfx":{let e=document.createElement("div");e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="250" height="80.408" viewBox="0 0 250 80.408"><defs><filter id="a" x="0" y="1.182" width="250" height="79.226" filterUnits="userSpaceOnUse"><feOffset dy="3" input="SourceAlpha"/><feGaussianBlur stdDeviation="3" result="b"/><feFlood flood-opacity="0.161"/><feComposite operator="in" in2="b"/><feComposite in="SourceGraphic"/></filter><filter id="c" x="6.929" y="0" width="111.975" height="40.988" filterUnits="userSpaceOnUse"><feOffset dy="3" input="SourceAlpha"/><feGaussianBlur stdDeviation="3" result="d"/><feFlood flood-opacity="0.161"/><feComposite operator="in" in2="d"/><feComposite in="SourceGraphic"/></filter></defs><g transform="translate(-26.873 -414.029)"><g transform="translate(44 423.332)"><g transform="translate(0 0.635)" style="isolation:isolate"><g transform="translate(0 0)"><g transform="matrix(1, 0, 0, 1, -17.13, -9.94)" filter="url(#a)"><path d="M55.766,44.97V11.8h8.272v2.6h.089a8.258,8.258,0,0,1,7.046-3.357,11.4,11.4,0,0,1,8.5,3.686,12.667,12.667,0,0,1,3.278,8.622,12.509,12.509,0,0,1-3.25,8.57,11.353,11.353,0,0,1-8.429,3.6,9.533,9.533,0,0,1-7.229-2.95V43.378l-8.269,1.594h0Zm8-21.671a4.958,4.958,0,0,0,5.319,5.15A4.957,4.957,0,0,0,74.4,23.3a5.321,5.321,0,0,0-10.638,0ZM16.105,18.412H2.752V11.038H30.9L14.887,37.16H38.22L0,44.534ZM131.469,38.45a.761.761,0,0,1-.484-.166.582.582,0,0,1-.228-.419l-.553-3.586a12.243,12.243,0,0,1-1.782-.721l-2.789,2.084a.718.718,0,0,1-.5.176.688.688,0,0,1-.495-.214,25.864,25.864,0,0,1-3.264-3.274.754.754,0,0,1,.018-.9c.2-.277.543-.713,1.01-1.3.483-.6.832-1.05,1.068-1.374a9.614,9.614,0,0,1-.811-1.929l-3.62-.527a.631.631,0,0,1-.416-.243.728.728,0,0,1-.159-.458V21.283a.743.743,0,0,1,.159-.448.6.6,0,0,1,.376-.253l3.68-.546a9.511,9.511,0,0,1,.772-1.792c-.523-.733-1.235-1.638-2.117-2.69a.731.731,0,0,1-.2-.467.82.82,0,0,1,.178-.449,19.577,19.577,0,0,1,1.949-2.095c.953-.924,1.582-1.393,1.87-1.393a.861.861,0,0,1,.515.195l2.729,2.084a11.551,11.551,0,0,1,1.8-.741,31.446,31.446,0,0,1,.573-3.623.666.666,0,0,1,.712-.546h4.392a.757.757,0,0,1,.485.166.58.58,0,0,1,.228.419l.553,3.584a12.576,12.576,0,0,1,1.782.722l2.809-2.085a.641.641,0,0,1,.475-.176.776.776,0,0,1,.5.195,27.035,27.035,0,0,1,3.264,3.313.625.625,0,0,1,.139.429.742.742,0,0,1-.159.447c-.2.271-.525.7-1.008,1.3-.467.581-.827,1.043-1.069,1.373a11.8,11.8,0,0,1,.812,1.91l3.62.545a.626.626,0,0,1,.416.244.736.736,0,0,1,.158.457v4.325a.755.755,0,0,1-.158.449.6.6,0,0,1-.4.253l-3.66.545a12.692,12.692,0,0,1-.772,1.774c.465.653,1.177,1.559,2.117,2.688a.751.751,0,0,1,.2.488.648.648,0,0,1-.178.448,19.638,19.638,0,0,1-1.958,2.1c-.947.918-1.573,1.384-1.861,1.384a.976.976,0,0,1-.515-.176l-2.731-2.1a11.361,11.361,0,0,1-1.8.741,31.849,31.849,0,0,1-.573,3.625.668.668,0,0,1-.713.546Zm-1.385-18.491a4.935,4.935,0,0,0,0,7.053,5.12,5.12,0,0,0,7.163,0,4.931,4.931,0,0,0,0-7.053,5.117,5.117,0,0,0-7.163,0Zm69.969,14.868a18.523,18.523,0,0,1-4.932-2.073l1.705-6.1A13.441,13.441,0,0,0,200.779,29a12.14,12.14,0,0,0,4.344.818,4.644,4.644,0,0,0,2.351-.482,1.538,1.538,0,0,0,.806-1.4q0-1.5-3.25-2.242-1.061-.246-1.705-.425a12.335,12.335,0,0,1-5.358-2.589,5.5,5.5,0,0,1-1.671-4.157,6.323,6.323,0,0,1,2.547-5.267,10.993,10.993,0,0,1,6.9-1.972,21.351,21.351,0,0,1,4.552.5,25.439,25.439,0,0,1,4.736,1.557l-1.705,5.491a14.244,14.244,0,0,0-3.319-1.636,10.6,10.6,0,0,0-3.364-.561,4.227,4.227,0,0,0-2.121.426,1.357,1.357,0,0,0-.714,1.232q0,1.211,3.227,2.04.737.2,1.106.291,4.264,1.187,5.935,2.79a5.728,5.728,0,0,1,1.67,4.337A6.781,6.781,0,0,1,213,33.37a11.48,11.48,0,0,1-7.259,2.14A22.577,22.577,0,0,1,200.053,34.827ZM30.568,31.834a12.566,12.566,0,0,1-3.292-8.59,12.567,12.567,0,0,1,3.247-8.568,11.3,11.3,0,0,1,8.423-3.638,9.519,9.519,0,0,1,7.217,3V11.8h8.264V34.735H46.163V32.186h-.09c-1.32,2.071-3.951,3.308-7.038,3.308A11.412,11.412,0,0,1,30.568,31.834Zm5.245-8.545a4.95,4.95,0,0,0,5.312,5.141,4.95,4.95,0,0,0,5.312-5.141A5.023,5.023,0,0,0,41.125,18.1,5.023,5.023,0,0,0,35.813,23.289Zm69.2,11.554-3.527-10.452q-.282-.892-.505-1.8t-.412-1.8a30.821,30.821,0,0,1-.917,3.454l-.047.16L96.1,34.842H90.176l-9.925-23.1h8.632l3.552,10.223q.4,1.12.634,1.955t.377,1.635a23.558,23.558,0,0,1,.917-3.179q.093-.274.141-.411l3.528-10.223h5.056l3.5,10.2.07.183a20.724,20.724,0,0,1,.988,3.43q.141-.732.364-1.532t.647-2.058l3.574-10.223h8.678l-9.971,23.1Zm80.154-.092-8.587-9.841v9.841h-7.888V1.5L176.583,0V22.28l8.272-9.665h9.96L184.584,23.266l11.156,11.485Zm-35.09,0V11.782h8.272v3.761h.091a8.131,8.131,0,0,1,7.546-4.074h1.593V19.3a6.8,6.8,0,0,0-3.5-.761c-4.593,0-5.728,3-5.728,6.941v9.268Z" transform="translate(17.13 15.31)"/></g><g transform="matrix(1, 0, 0, 1, -17.13, -9.94)" filter="url(#c)"><path d="M3.576-12.852v-4.3H6.628a2.867,2.867,0,0,1,1.945.55A2.034,2.034,0,0,1,9.188-15a2.06,2.06,0,0,1-.615,1.608,2.784,2.784,0,0,1-1.945.542ZM2.017-18.464V-6.748H3.576v-4.792H7.153a3.569,3.569,0,0,0,2.683-.9A3.478,3.478,0,0,0,10.747-15a3.45,3.45,0,0,0-.911-2.552,3.638,3.638,0,0,0-2.683-.911Zm11.421,7.483a4.221,4.221,0,0,1,.205-1.37,2.957,2.957,0,0,1,.566-1.009,2.411,2.411,0,0,1,.845-.624A2.515,2.515,0,0,1,16.08-14.2a2.515,2.515,0,0,1,1.026.213,2.411,2.411,0,0,1,.845.624,2.957,2.957,0,0,1,.566,1.009,4.221,4.221,0,0,1,.205,1.37,4.221,4.221,0,0,1-.205,1.37,2.867,2.867,0,0,1-.566,1,2.457,2.457,0,0,1-.845.615,2.515,2.515,0,0,1-1.026.213,2.515,2.515,0,0,1-1.026-.213,2.457,2.457,0,0,1-.845-.615,2.867,2.867,0,0,1-.566-1A4.221,4.221,0,0,1,13.438-10.981Zm-1.477,0a5.573,5.573,0,0,0,.263,1.739,3.97,3.97,0,0,0,.788,1.4,3.623,3.623,0,0,0,1.3.935,4.4,4.4,0,0,0,1.772.336A4.381,4.381,0,0,0,17.86-6.9a3.641,3.641,0,0,0,1.288-.935,3.97,3.97,0,0,0,.788-1.4,5.573,5.573,0,0,0,.263-1.739,5.65,5.65,0,0,0-.263-1.748,3.96,3.96,0,0,0-.788-1.411,3.729,3.729,0,0,0-1.288-.944,4.29,4.29,0,0,0-1.78-.345,4.3,4.3,0,0,0-1.772.345,3.71,3.71,0,0,0-1.3.944,3.96,3.96,0,0,0-.788,1.411A5.65,5.65,0,0,0,11.961-10.981Zm18.28,4.234,2.708-8.484H31.5L29.6-8.29h-.033L27.8-15.231H26.27L24.564-8.29h-.033l-1.92-6.941H21.068l2.724,8.484H25.3l1.707-6.744h.033l1.723,6.744ZM40.169-11.8H35.3a2.905,2.905,0,0,1,.213-.927A2.473,2.473,0,0,1,36-13.492a2.255,2.255,0,0,1,.747-.517,2.429,2.429,0,0,1,.976-.189,2.386,2.386,0,0,1,.96.189,2.415,2.415,0,0,1,.755.509,2.391,2.391,0,0,1,.509.763A2.854,2.854,0,0,1,40.169-11.8Zm1.346,2.363H40.136a1.983,1.983,0,0,1-.747,1.247,2.414,2.414,0,0,1-1.452.41,2.889,2.889,0,0,1-1.2-.23,2.348,2.348,0,0,1-.837-.615,2.4,2.4,0,0,1-.476-.886,3.367,3.367,0,0,1-.131-1.058h6.35a6.754,6.754,0,0,0-.139-1.625,4.7,4.7,0,0,0-.624-1.575,3.716,3.716,0,0,0-1.2-1.19,3.48,3.48,0,0,0-1.879-.468,3.858,3.858,0,0,0-1.6.328,3.76,3.76,0,0,0-1.264.919,4.236,4.236,0,0,0-.829,1.395,5.105,5.105,0,0,0-.3,1.772,6.8,6.8,0,0,0,.287,1.789,3.9,3.9,0,0,0,.763,1.411,3.478,3.478,0,0,0,1.255.919,4.358,4.358,0,0,0,1.764.328,3.851,3.851,0,0,0,2.4-.722A3.39,3.39,0,0,0,41.515-9.439Zm1.526-5.793v8.484h1.395v-3.774a5.8,5.8,0,0,1,.164-1.452,2.784,2.784,0,0,1,.525-1.075,2.251,2.251,0,0,1,.952-.673,3.945,3.945,0,0,1,1.428-.23v-1.477a3.135,3.135,0,0,0-1.871.459,3.779,3.779,0,0,0-1.247,1.526h-.033v-1.789ZM54.15-11.8H49.276a2.905,2.905,0,0,1,.213-.927,2.473,2.473,0,0,1,.492-.763,2.255,2.255,0,0,1,.747-.517A2.429,2.429,0,0,1,51.7-14.2a2.386,2.386,0,0,1,.96.189,2.415,2.415,0,0,1,.755.509,2.391,2.391,0,0,1,.509.763A2.854,2.854,0,0,1,54.15-11.8ZM55.5-9.439H54.117a1.983,1.983,0,0,1-.747,1.247,2.414,2.414,0,0,1-1.452.41,2.889,2.889,0,0,1-1.2-.23,2.348,2.348,0,0,1-.837-.615,2.4,2.4,0,0,1-.476-.886,3.367,3.367,0,0,1-.131-1.058h6.35a6.754,6.754,0,0,0-.139-1.625,4.7,4.7,0,0,0-.624-1.575,3.716,3.716,0,0,0-1.2-1.19,3.48,3.48,0,0,0-1.879-.468,3.858,3.858,0,0,0-1.6.328,3.76,3.76,0,0,0-1.264.919,4.236,4.236,0,0,0-.829,1.395,5.1,5.1,0,0,0-.3,1.772,6.8,6.8,0,0,0,.287,1.789,3.9,3.9,0,0,0,.763,1.411,3.478,3.478,0,0,0,1.255.919,4.358,4.358,0,0,0,1.764.328,3.851,3.851,0,0,0,2.4-.722A3.39,3.39,0,0,0,55.5-9.439Zm2.593-1.477a5.581,5.581,0,0,1,.131-1.214,3.212,3.212,0,0,1,.427-1.05,2.221,2.221,0,0,1,.788-.738,2.4,2.4,0,0,1,1.2-.279,2.589,2.589,0,0,1,1.231.271,2.389,2.389,0,0,1,.829.714,2.985,2.985,0,0,1,.468,1.026,4.889,4.889,0,0,1,.148,1.206,4.919,4.919,0,0,1-.139,1.165,3.053,3.053,0,0,1-.451,1.026,2.4,2.4,0,0,1-.8.73,2.4,2.4,0,0,1-1.2.279,2.491,2.491,0,0,1-1.173-.263,2.332,2.332,0,0,1-.82-.706,3.122,3.122,0,0,1-.476-1.009A4.338,4.338,0,0,1,58.088-10.916Zm6.564,4.168V-18.464H63.257V-14.1h-.033a2.247,2.247,0,0,0-.566-.632,3.216,3.216,0,0,0-.714-.41,3.583,3.583,0,0,0-.755-.222,4.132,4.132,0,0,0-.706-.066,3.861,3.861,0,0,0-1.7.353,3.487,3.487,0,0,0-1.214.952,4.018,4.018,0,0,0-.722,1.4,5.985,5.985,0,0,0-.238,1.707,5.8,5.8,0,0,0,.246,1.707,4.218,4.218,0,0,0,.73,1.411,3.529,3.529,0,0,0,1.214.968,3.827,3.827,0,0,0,1.715.361,4.135,4.135,0,0,0,1.625-.312A2.053,2.053,0,0,0,63.224-7.9h.033v1.149Zm6.761-11.716V-6.748h1.395V-7.88h.033a2.247,2.247,0,0,0,.566.632,2.982,2.982,0,0,0,.714.4,3.874,3.874,0,0,0,.763.213,4.193,4.193,0,0,0,.7.066,3.94,3.94,0,0,0,1.7-.345,3.4,3.4,0,0,0,1.214-.944,4.018,4.018,0,0,0,.722-1.4,5.985,5.985,0,0,0,.238-1.707,5.8,5.8,0,0,0-.246-1.707,4.312,4.312,0,0,0-.73-1.419,3.488,3.488,0,0,0-1.214-.976,3.827,3.827,0,0,0-1.715-.361,4.043,4.043,0,0,0-1.625.32,2.088,2.088,0,0,0-1.083,1.026h-.033v-4.381Zm6.564,7.4a5.581,5.581,0,0,1-.131,1.214,3.212,3.212,0,0,1-.427,1.05,2.243,2.243,0,0,1-.779.738,2.385,2.385,0,0,1-1.206.279A2.589,2.589,0,0,1,74.2-8.052a2.389,2.389,0,0,1-.829-.714,2.985,2.985,0,0,1-.468-1.026A4.889,4.889,0,0,1,72.758-11a4.919,4.919,0,0,1,.139-1.165,3.053,3.053,0,0,1,.451-1.026,2.4,2.4,0,0,1,.8-.73,2.4,2.4,0,0,1,1.2-.279,2.491,2.491,0,0,1,1.173.263,2.332,2.332,0,0,1,.82.706,3.122,3.122,0,0,1,.476,1.009A4.338,4.338,0,0,1,77.976-11.063Zm6.449,5.448a8.871,8.871,0,0,1-.484,1.05,2.871,2.871,0,0,1-.525.7,1.782,1.782,0,0,1-.64.394,2.462,2.462,0,0,1-.812.123,3.721,3.721,0,0,1-.492-.033A2.324,2.324,0,0,1,81-3.5v-1.28a2.342,2.342,0,0,0,.418.139,1.765,1.765,0,0,0,.4.057,1.2,1.2,0,0,0,.714-.205,1.255,1.255,0,0,0,.435-.583L83.539-6.8l-3.364-8.434h1.575L84.228-8.29h.033l2.379-6.941h1.477Z" transform="translate(17.85 28.4)"/></g></g></g><g transform="translate(0 0)"><g transform="translate(0 5.371)"><path d="M11.76,24.456A11.41,11.41,0,0,1,3.292,20.8,12.564,12.564,0,0,1,0,12.206,12.569,12.569,0,0,1,3.246,3.638,11.307,11.307,0,0,1,11.67,0a9.519,9.519,0,0,1,7.217,3V.759h8.264V23.7H18.887V21.148H18.8C17.478,23.219,14.846,24.456,11.76,24.456ZM13.849,7.064A5.023,5.023,0,0,0,8.537,12.25a4.95,4.95,0,0,0,5.312,5.141A4.95,4.95,0,0,0,19.16,12.25,5.023,5.023,0,0,0,13.849,7.064Z" transform="translate(27.277 11.038)" fill="#fff"/><path d="M0,33.931V.758H8.271v2.6H8.36A8.258,8.258,0,0,1,15.406,0,11.4,11.4,0,0,1,23.9,3.686a12.665,12.665,0,0,1,3.278,8.622,12.508,12.508,0,0,1-3.25,8.57,11.351,11.351,0,0,1-8.429,3.6,9.535,9.535,0,0,1-7.229-2.95V32.337L0,33.931ZM13.317,7.07A5.028,5.028,0,0,0,8,12.259a4.957,4.957,0,0,0,5.319,5.15,4.957,4.957,0,0,0,5.319-5.15A5.028,5.028,0,0,0,13.317,7.07Z" transform="translate(55.766 11.041)" fill="#fff"/><path d="M22.836,0l3.5,10.2.07.183a20.748,20.748,0,0,1,.988,3.43q.141-.731.364-1.532t.647-2.058L31.985,0h8.678L30.691,23.1H24.764L21.237,12.647q-.282-.891-.505-1.8t-.412-1.8A30.927,30.927,0,0,1,19.4,12.51l-.047.16L15.851,23.1H9.925L0,0H8.631l3.552,10.223q.4,1.121.635,1.955t.377,1.635a23.522,23.522,0,0,1,.917-3.179q.093-.274.141-.411L17.78,0h5.056" transform="translate(80.251 11.743)" fill="#fff"/><path d="M0,34.75V1.5L7.888,0V22.28l8.272-9.665H26.12L15.889,23.266,27.045,34.75H16.475L7.888,24.91v9.84H0" transform="translate(168.695 0)" fill="#fff"/><path d="M0,21.47l1.705-6.1a13.453,13.453,0,0,0,3.952,2.342A12.145,12.145,0,0,0,10,18.534a4.643,4.643,0,0,0,2.351-.482,1.539,1.539,0,0,0,.807-1.4q0-1.5-3.25-2.241-1.06-.246-1.705-.426A12.325,12.325,0,0,1,2.846,11.4,5.5,5.5,0,0,1,1.176,7.239,6.324,6.324,0,0,1,3.722,1.972,11,11,0,0,1,10.624,0a21.365,21.365,0,0,1,4.551.5,25.45,25.45,0,0,1,4.736,1.558l-1.706,5.49a14.24,14.24,0,0,0-3.319-1.636,10.6,10.6,0,0,0-3.364-.56A4.22,4.22,0,0,0,9.4,5.782a1.356,1.356,0,0,0-.714,1.233q0,1.211,3.227,2.04.737.2,1.106.291,4.264,1.188,5.935,2.79a5.728,5.728,0,0,1,1.671,4.337,6.782,6.782,0,0,1-2.743,5.614,11.478,11.478,0,0,1-7.259,2.14,22.565,22.565,0,0,1-5.693-.683A18.517,18.517,0,0,1,0,21.47" transform="translate(195.121 11.284)" fill="#fff"/><path d="M8.273,4.075h.091A8.13,8.13,0,0,1,15.909,0H17.5V7.834A6.8,6.8,0,0,0,14,7.074c-4.593,0-5.728,3-5.728,6.941v9.268H0V.313H8.273V4.075" transform="translate(150.08 11.469)" fill="#fff"/><path d="M17.392,29.929H13a.76.76,0,0,1-.485-.166.579.579,0,0,1-.227-.419l-.553-3.586a12.3,12.3,0,0,1-1.781-.721L7.163,27.123a.719.719,0,0,1-.495.176.687.687,0,0,1-.495-.214A25.873,25.873,0,0,1,2.91,23.81a.753.753,0,0,1,.019-.9c.2-.277.542-.713,1.009-1.3.483-.6.832-1.05,1.068-1.374a9.591,9.591,0,0,1-.811-1.929l-3.62-.526a.63.63,0,0,1-.416-.243A.729.729,0,0,1,0,17.089V12.762a.746.746,0,0,1,.159-.448.6.6,0,0,1,.376-.253l3.68-.546a9.5,9.5,0,0,1,.772-1.792C4.464,8.991,3.752,8.085,2.87,7.034a.732.732,0,0,1-.2-.468.82.82,0,0,1,.179-.449A19.622,19.622,0,0,1,4.8,4.023C5.751,3.1,6.38,2.631,6.668,2.631a.859.859,0,0,1,.515.194L9.913,4.91a11.536,11.536,0,0,1,1.8-.741A31.372,31.372,0,0,1,12.287.546.665.665,0,0,1,13,0h4.392a.755.755,0,0,1,.485.166.581.581,0,0,1,.229.419l.553,3.584a12.543,12.543,0,0,1,1.781.722L23.25,2.807a.641.641,0,0,1,.475-.176.775.775,0,0,1,.495.194,27.092,27.092,0,0,1,3.264,3.313.625.625,0,0,1,.139.429.745.745,0,0,1-.159.448c-.2.271-.525.695-1.008,1.3-.467.581-.827,1.043-1.069,1.373a11.784,11.784,0,0,1,.812,1.91l3.62.545a.625.625,0,0,1,.416.244.736.736,0,0,1,.157.458v4.325a.754.754,0,0,1-.157.449.606.606,0,0,1-.4.253l-3.66.545a12.628,12.628,0,0,1-.772,1.774c.465.654,1.177,1.559,2.117,2.688a.752.752,0,0,1,.2.488.648.648,0,0,1-.177.448,19.641,19.641,0,0,1-1.959,2.1c-.947.918-1.573,1.384-1.86,1.384a.978.978,0,0,1-.515-.176l-2.731-2.1a11.429,11.429,0,0,1-1.8.741,32.016,32.016,0,0,1-.573,3.624A.668.668,0,0,1,17.392,29.929ZM15.2,9.976a4.938,4.938,0,0,0-3.582,1.463,4.935,4.935,0,0,0,0,7.053,5.12,5.12,0,0,0,7.163,0,4.932,4.932,0,0,0,0-7.053A4.938,4.938,0,0,0,15.2,9.976Z" transform="translate(118.47 8.521)" fill="#fff"/><path d="M0,33.5,16.106,7.374H2.752V0H30.9L14.887,26.122H38.22L0,33.5" transform="translate(0 11.038)" fill="#fff"/></g><path d="M3.576-12.852v-4.3H6.628a2.867,2.867,0,0,1,1.945.55A2.034,2.034,0,0,1,9.188-15a2.06,2.06,0,0,1-.615,1.608,2.784,2.784,0,0,1-1.945.542ZM2.017-18.464V-6.748H3.576v-4.792H7.153a3.569,3.569,0,0,0,2.683-.9A3.478,3.478,0,0,0,10.747-15a3.45,3.45,0,0,0-.911-2.552,3.638,3.638,0,0,0-2.683-.911Zm11.421,7.483a4.221,4.221,0,0,1,.205-1.37,2.957,2.957,0,0,1,.566-1.009,2.411,2.411,0,0,1,.845-.624A2.515,2.515,0,0,1,16.08-14.2a2.515,2.515,0,0,1,1.026.213,2.411,2.411,0,0,1,.845.624,2.957,2.957,0,0,1,.566,1.009,4.221,4.221,0,0,1,.205,1.37,4.221,4.221,0,0,1-.205,1.37,2.867,2.867,0,0,1-.566,1,2.457,2.457,0,0,1-.845.615,2.515,2.515,0,0,1-1.026.213,2.515,2.515,0,0,1-1.026-.213,2.457,2.457,0,0,1-.845-.615,2.867,2.867,0,0,1-.566-1A4.221,4.221,0,0,1,13.438-10.981Zm-1.477,0a5.573,5.573,0,0,0,.263,1.739,3.97,3.97,0,0,0,.788,1.4,3.623,3.623,0,0,0,1.3.935,4.4,4.4,0,0,0,1.772.336A4.381,4.381,0,0,0,17.86-6.9a3.641,3.641,0,0,0,1.288-.935,3.97,3.97,0,0,0,.788-1.4,5.573,5.573,0,0,0,.263-1.739,5.65,5.65,0,0,0-.263-1.748,3.96,3.96,0,0,0-.788-1.411,3.729,3.729,0,0,0-1.288-.944,4.29,4.29,0,0,0-1.78-.345,4.3,4.3,0,0,0-1.772.345,3.71,3.71,0,0,0-1.3.944,3.96,3.96,0,0,0-.788,1.411A5.65,5.65,0,0,0,11.961-10.981Zm18.28,4.234,2.708-8.484H31.5L29.6-8.29h-.033L27.8-15.231H26.27L24.564-8.29h-.033l-1.92-6.941H21.068l2.724,8.484H25.3l1.707-6.744h.033l1.723,6.744ZM40.169-11.8H35.3a2.905,2.905,0,0,1,.213-.927A2.473,2.473,0,0,1,36-13.492a2.255,2.255,0,0,1,.747-.517,2.429,2.429,0,0,1,.976-.189,2.386,2.386,0,0,1,.96.189,2.415,2.415,0,0,1,.755.509,2.391,2.391,0,0,1,.509.763A2.854,2.854,0,0,1,40.169-11.8Zm1.346,2.363H40.136a1.983,1.983,0,0,1-.747,1.247,2.414,2.414,0,0,1-1.452.41,2.889,2.889,0,0,1-1.2-.23,2.348,2.348,0,0,1-.837-.615,2.4,2.4,0,0,1-.476-.886,3.367,3.367,0,0,1-.131-1.058h6.35a6.754,6.754,0,0,0-.139-1.625,4.7,4.7,0,0,0-.624-1.575,3.716,3.716,0,0,0-1.2-1.19,3.48,3.48,0,0,0-1.879-.468,3.858,3.858,0,0,0-1.6.328,3.76,3.76,0,0,0-1.264.919,4.236,4.236,0,0,0-.829,1.395,5.105,5.105,0,0,0-.3,1.772,6.8,6.8,0,0,0,.287,1.789,3.9,3.9,0,0,0,.763,1.411,3.478,3.478,0,0,0,1.255.919,4.358,4.358,0,0,0,1.764.328,3.851,3.851,0,0,0,2.4-.722A3.39,3.39,0,0,0,41.515-9.439Zm1.526-5.793v8.484h1.395v-3.774a5.8,5.8,0,0,1,.164-1.452,2.784,2.784,0,0,1,.525-1.075,2.251,2.251,0,0,1,.952-.673,3.945,3.945,0,0,1,1.428-.23v-1.477a3.135,3.135,0,0,0-1.871.459,3.779,3.779,0,0,0-1.247,1.526h-.033v-1.789ZM54.15-11.8H49.276a2.905,2.905,0,0,1,.213-.927,2.473,2.473,0,0,1,.492-.763,2.255,2.255,0,0,1,.747-.517A2.429,2.429,0,0,1,51.7-14.2a2.386,2.386,0,0,1,.96.189,2.415,2.415,0,0,1,.755.509,2.391,2.391,0,0,1,.509.763A2.854,2.854,0,0,1,54.15-11.8ZM55.5-9.439H54.117a1.983,1.983,0,0,1-.747,1.247,2.414,2.414,0,0,1-1.452.41,2.889,2.889,0,0,1-1.2-.23,2.348,2.348,0,0,1-.837-.615,2.4,2.4,0,0,1-.476-.886,3.367,3.367,0,0,1-.131-1.058h6.35a6.754,6.754,0,0,0-.139-1.625,4.7,4.7,0,0,0-.624-1.575,3.716,3.716,0,0,0-1.2-1.19,3.48,3.48,0,0,0-1.879-.468,3.858,3.858,0,0,0-1.6.328,3.76,3.76,0,0,0-1.264.919,4.236,4.236,0,0,0-.829,1.395,5.1,5.1,0,0,0-.3,1.772,6.8,6.8,0,0,0,.287,1.789,3.9,3.9,0,0,0,.763,1.411,3.478,3.478,0,0,0,1.255.919,4.358,4.358,0,0,0,1.764.328,3.851,3.851,0,0,0,2.4-.722A3.39,3.39,0,0,0,55.5-9.439Zm2.593-1.477a5.581,5.581,0,0,1,.131-1.214,3.212,3.212,0,0,1,.427-1.05,2.221,2.221,0,0,1,.788-.738,2.4,2.4,0,0,1,1.2-.279,2.589,2.589,0,0,1,1.231.271,2.389,2.389,0,0,1,.829.714,2.985,2.985,0,0,1,.468,1.026,4.889,4.889,0,0,1,.148,1.206,4.919,4.919,0,0,1-.139,1.165,3.053,3.053,0,0,1-.451,1.026,2.4,2.4,0,0,1-.8.73,2.4,2.4,0,0,1-1.2.279,2.491,2.491,0,0,1-1.173-.263,2.332,2.332,0,0,1-.82-.706,3.122,3.122,0,0,1-.476-1.009A4.338,4.338,0,0,1,58.088-10.916Zm6.564,4.168V-18.464H63.257V-14.1h-.033a2.247,2.247,0,0,0-.566-.632,3.216,3.216,0,0,0-.714-.41,3.583,3.583,0,0,0-.755-.222,4.132,4.132,0,0,0-.706-.066,3.861,3.861,0,0,0-1.7.353,3.487,3.487,0,0,0-1.214.952,4.018,4.018,0,0,0-.722,1.4,5.985,5.985,0,0,0-.238,1.707,5.8,5.8,0,0,0,.246,1.707,4.218,4.218,0,0,0,.73,1.411,3.529,3.529,0,0,0,1.214.968,3.827,3.827,0,0,0,1.715.361,4.135,4.135,0,0,0,1.625-.312A2.053,2.053,0,0,0,63.224-7.9h.033v1.149Zm6.761-11.716V-6.748h1.395V-7.88h.033a2.247,2.247,0,0,0,.566.632,2.982,2.982,0,0,0,.714.4,3.874,3.874,0,0,0,.763.213,4.193,4.193,0,0,0,.7.066,3.94,3.94,0,0,0,1.7-.345,3.4,3.4,0,0,0,1.214-.944,4.018,4.018,0,0,0,.722-1.4,5.985,5.985,0,0,0,.238-1.707,5.8,5.8,0,0,0-.246-1.707,4.312,4.312,0,0,0-.73-1.419,3.488,3.488,0,0,0-1.214-.976,3.827,3.827,0,0,0-1.715-.361,4.043,4.043,0,0,0-1.625.32,2.088,2.088,0,0,0-1.083,1.026h-.033v-4.381Zm6.564,7.4a5.581,5.581,0,0,1-.131,1.214,3.212,3.212,0,0,1-.427,1.05,2.243,2.243,0,0,1-.779.738,2.385,2.385,0,0,1-1.206.279A2.589,2.589,0,0,1,74.2-8.052a2.389,2.389,0,0,1-.829-.714,2.985,2.985,0,0,1-.468-1.026A4.889,4.889,0,0,1,72.758-11a4.919,4.919,0,0,1,.139-1.165,3.053,3.053,0,0,1,.451-1.026,2.4,2.4,0,0,1,.8-.73,2.4,2.4,0,0,1,1.2-.279,2.491,2.491,0,0,1,1.173.263,2.332,2.332,0,0,1,.82.706,3.122,3.122,0,0,1,.476,1.009A4.338,4.338,0,0,1,77.976-11.063Zm6.449,5.448a8.871,8.871,0,0,1-.484,1.05,2.871,2.871,0,0,1-.525.7,1.782,1.782,0,0,1-.64.394,2.462,2.462,0,0,1-.812.123,3.721,3.721,0,0,1-.492-.033A2.324,2.324,0,0,1,81-3.5v-1.28a2.342,2.342,0,0,0,.418.139,1.765,1.765,0,0,0,.4.057,1.2,1.2,0,0,0,.714-.205,1.255,1.255,0,0,0,.435-.583L83.539-6.8l-3.364-8.434h1.575L84.228-8.29h.033l2.379-6.941h1.477Z" transform="translate(0.722 18.464)" fill="#fff"/></g></g></g></svg>',e.style.position="absolute",e.style.bottom="20px",e.style.width="250px",e.style.left="50%",e.style.marginLeft="-125px",e.style.zIndex=Number.MAX_SAFE_INTEGER.toString(),e.style.opacity="0",e.style.transition="opacity 0.5s",document.body.append(e),setTimeout(function(){e.style.opacity="1"},500),setTimeout(function(){e.style.opacity="0"},3e3),setTimeout(function(){e.remove()},4e3)}}});let b=new Map;e8.IsSupported()&&(t=e8.SharedInstance(),u=e9.SharedInstance());let y=(null==t?void 0:t.impl)||{},w=(null==t?void 0:t.impl)||p.impl,A=(null==u?void 0:u.impl)||{};return h=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},p.impl),{world_tracker_mesh_anchor_count:()=>0,world_tracker_mesh_anchor_id:()=>"",world_tracker_mesh_anchor_indices:()=>new Uint32Array(0),world_tracker_mesh_anchor_indices_count:()=>0,world_tracker_mesh_anchor_indices_size:()=>0,world_tracker_mesh_anchor_vertices:()=>new Float32Array(0),world_tracker_mesh_anchor_vertices_count:()=>0,world_tracker_mesh_anchor_vertices_size:()=>0,world_tracker_mesh_anchor_vertices_offset:()=>0,world_tracker_mesh_anchor_vertices_stride:()=>0,world_tracker_mesh_anchor_pose_raw:()=>new Float32Array,world_tracker_mesh_anchor_status:()=>I.uI.ANCHOR_STATUS_STOPPED,world_tracker_mesh_anchors_enabled:()=>!1,world_tracker_mesh_anchors_enabled_set:()=>{},d3_tracker_create:e=>-1,d3_tracker_destroy:e=>{},d3_tracker_count:e=>0,d3_tracker_enabled:e=>!1,d3_tracker_enabled_set:(e,t)=>{},d3_tracker_process_max_resolution_set:(e,t)=>{},d3_tracker_pose_raw:(e,t)=>z.vt(),d3_tracker_pose0_raw:(e,t)=>z.vt(),d3_tracker_pose1_raw:(e,t)=>z.vt(),d3_tracker_id:(e,t)=>"",d3_tracker_qr:(e,t)=>"",d3_tracker_landmarks_data:(e,t)=>new Float32Array(0),d3_tracker_landmarks_data_size:(e,t)=>0,d3_tracker_type:(e,t)=>0,d3_tracker_dense:(e,t)=>0,d3_tracker_size_for_id_set:(e,t,r)=>0,d3_tracker_pose:(e,t,r,i)=>{let a=eV(void 0,h.d3_tracker_pose_raw(e,t));if(i){let e=z.vt();z.CV(e,[-1,1,1]),z.lw(a,e,a),z.lw(a,a,e)}return z.lw(a,r,a),a},d3_tracker_pose_camera_relative:(e,t,r)=>{let i=eV(void 0,h.d3_tracker_pose_raw(e,t));if(r){let e=z.vt();z.CV(e,[-1,1,1]),z.lw(i,e,i),z.lw(i,i,e)}return i},d3_tracker_pose0:(e,t,r,i)=>{let a=eV(void 0,h.d3_tracker_pose0_raw(e,t));if(i){let e=z.vt();z.CV(e,[-1,1,1]),z.lw(a,e,a),z.lw(a,a,e)}return z.lw(a,r,a),a},d3_tracker_pose0_camera_relative:(e,t,r)=>{let i=eV(void 0,h.d3_tracker_pose0_raw(e,t));if(r){let e=z.vt();z.CV(e,[-1,1,1]),z.lw(i,e,i),z.lw(i,i,e)}return i},d3_tracker_pose1:(e,t,r,i)=>{let a=eV(void 0,h.d3_tracker_pose1_raw(e,t));if(i){let e=z.vt();z.CV(e,[-1,1,1]),z.lw(a,e,a),z.lw(a,a,e)}return z.lw(a,r,a),a},d3_tracker_pose1_camera_relative:(e,t,r)=>{let i=eV(void 0,h.d3_tracker_pose1_raw(e,t));if(r){let e=z.vt();z.CV(e,[-1,1,1]),z.lw(i,e,i),z.lw(i,i,e)}return i}}),y),A),{loaded:()=>m,camera_default_device_id:e=>e?eE.USER_DEFAULT_DEVICE_ID:eE.DEFAULT_DEVICE_ID,camera_source_create:(e,t)=>{let r;return r=eI++,tr.IsSupported()&&t===eE.DEFAULT_DEVICE_ID?eF(r,new tr(r,e,t)):V.M.preferMediaStreamTrackProcessorCamera&&"MediaStreamTrackProcessor"in window&&"MediaStreamTrackGenerator"in window?eF(r,new ek(r,e,t)):V.M.preferImageBitmapCamera&&"undefined"!=typeof OffscreenCanvas?eF(r,new ex(r,e,t)):eF(r,new eE(r,e,t)),eh("camera_source_t initialized"),r},camera_source_destroy:e=>{var t;return null==(t=eC(e))?void 0:t.destroy()},camera_source_pause:e=>{var t;return null==(t=eC(e))?void 0:t.pause()},camera_source_start:e=>{var t;return null==(t=eC(e))?void 0:t.start()},camera_source_profile_set:(e,t)=>{var r;return null==(r=eC(e))?void 0:r.setProfile(t)},camera_count:()=>2,camera_id:e=>0===e?eE.DEFAULT_DEVICE_ID:eE.USER_DEFAULT_DEVICE_ID,camera_name:e=>0===e?"Rear-facing Camera":"User-facing Camera",camera_user_facing:e=>0!==e,pose_from_raw:(e,t)=>{let r=eV(void 0,e);if(t){let e=z.vt();z.CV(e,[-1,1,1]),z.lw(r,e,r),z.lw(r,r,e)}return r},pipeline_create:()=>eN.create(p.impl,j),pipeline_frame_update:e=>{var t;return null==(t=eN.get(e))?void 0:t.frameUpdate(p)},pipeline_camera_frame_draw_gl:(e,t,r,i)=>{var a;null==(a=eN.get(e))||a.cameraFrameDrawGL(t,r,i)},draw_plane:(e,t,r,n,o)=>{let l,_,c;l=function(e){if(i)return i;let t=e.createProgram();if(!t)throw Error("Unable to create program");let r=(0,D.R)(e,e.VERTEX_SHADER,P),a=(0,D.R)(e,e.FRAGMENT_SHADER,L);e.attachShader(t,r),e.attachShader(t,a),(0,D.i)(e,t);let s=e.getUniformLocation(t,"projMatrix");if(!s)throw Error("Unable to get uniform location projMatrix");let n=e.getUniformLocation(t,"modelViewMatrix");if(!n)throw Error("Unable to get uniform location modelViewMatrix");let o=e.getUniformLocation(t,"cameraMatrix");if(!o)throw Error("Unable to get uniform location cameraMatrix");let l=e.getUniformLocation(t,"skinSampler");if(!l)throw Error("Unable to get uniform location skinSampler");return i={prog:t,unif_matrix:n,unif_proj:s,unif_camera:o,unif_skinSampler:l,attr_position:e.getAttribLocation(t,"position"),attr_textureCoord:e.getAttribLocation(t,"textureCoord")}}(e),_=function(e){if(a)return a;if(!(a=e.createBuffer()))throw Error("Unable to create buffer object");return e.bindBuffer(e.ARRAY_BUFFER,a),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-.5,.125,0,-.5,-.125,0,.5,.125,0,.5,-.125,0]),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),a}(e),c=function(e){if(s)return s;if(!(s=e.createBuffer()))throw Error("Unable to create buffer object");return e.bindBuffer(e.ARRAY_BUFFER,s),e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,1,1,0]),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),s}(e),e.disable(e.DEPTH_TEST),e.useProgram(l.prog),e.uniformMatrix4fv(l.unif_proj,!1,t),e.uniformMatrix4fv(l.unif_camera,!1,r),e.uniformMatrix4fv(l.unif_matrix,!1,n),e.bindBuffer(e.ARRAY_BUFFER,_),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,function(e,t){if(U[t])return U[t];let r=e.createTexture();if(!r)throw Error("Unable to create texture");U[t]=r,e.bindTexture(e.TEXTURE_2D,r);let i=e.RGBA,a=e.RGBA,s=e.UNSIGNED_BYTE,n=new Uint8Array([0,0,255,255]);e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.texImage2D(e.TEXTURE_2D,0,i,1,1,0,a,s,n);let o=new Image;return o.onload=function(){e.bindTexture(e.TEXTURE_2D,r),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.texImage2D(e.TEXTURE_2D,0,i,a,s,o),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR)},o.src=t,r}(e,o)),e.uniform1i(l.unif_skinSampler,0),e.vertexAttribPointer(l.attr_position,3,e.FLOAT,!1,12,0),e.enableVertexAttribArray(l.attr_position),e.bindBuffer(e.ARRAY_BUFFER,c),e.vertexAttribPointer(l.attr_textureCoord,2,e.FLOAT,!1,8,0),e.enableVertexAttribArray(l.attr_textureCoord),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.disableVertexAttribArray(l.attr_position),e.disableVertexAttribArray(l.attr_textureCoord),e.bindBuffer(e.ARRAY_BUFFER,null)},draw_grid:(e,t,r,i)=>{let a,s,_;a=function(e){if(n)return n;let t=e.createProgram();if(!t)throw Error("Unable to create program");let r=(0,D.R)(e,e.VERTEX_SHADER,tX),i=(0,D.R)(e,e.FRAGMENT_SHADER,tZ);e.attachShader(t,r),e.attachShader(t,i),(0,D.i)(e,t);let a=e.getUniformLocation(t,"projMatrix");if(!a)throw Error("Unable to get uniform location projMatrix");let s=e.getUniformLocation(t,"modelViewMatrix");if(!s)throw Error("Unable to get uniform location modelViewMatrix");let o=e.getUniformLocation(t,"cameraMatrix");if(!o)throw Error("Unable to get uniform location cameraMatrix");return n={prog:t,unif_matrix:s,unif_proj:a,unif_camera:o,attr_position:e.getAttribLocation(t,"position"),attr_textureCoord:e.getAttribLocation(t,"textureCoord")}}(e),s=function(e){if(o)return o;if(!(o=e.createBuffer()))throw Error("Unable to create buffer object");let t=[-.5,0,.5,-.5,0,-.5,.5,0,.5,.5,0,-.5];return t=t.map(e=>10*e),e.bindBuffer(e.ARRAY_BUFFER,o),e.bufferData(e.ARRAY_BUFFER,new Float32Array(t),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),o}(e),_=function(e){if(l)return l;if(!(l=e.createBuffer()))throw Error("Unable to create buffer object");let t=[0,1,0,0,1,1,1,0];return t=t.map(e=>10*e),e.bindBuffer(e.ARRAY_BUFFER,l),e.bufferData(e.ARRAY_BUFFER,new Float32Array(t),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),l}(e),e.disable(e.DEPTH_TEST),e.useProgram(a.prog),e.uniformMatrix4fv(a.unif_proj,!1,t),e.uniformMatrix4fv(a.unif_camera,!1,r),e.uniformMatrix4fv(a.unif_matrix,!1,i),e.bindBuffer(e.ARRAY_BUFFER,s),e.vertexAttribPointer(a.attr_position,3,e.FLOAT,!1,12,0),e.enableVertexAttribArray(a.attr_position),e.bindBuffer(e.ARRAY_BUFFER,_),e.vertexAttribPointer(a.attr_textureCoord,2,e.FLOAT,!1,8,0),e.enableVertexAttribArray(a.attr_textureCoord),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.disableVertexAttribArray(a.attr_position),e.disableVertexAttribArray(a.attr_textureCoord),e.bindBuffer(e.ARRAY_BUFFER,null)},draw_axis:(e,t,r,i)=>{let a,s,n;a=function(e){if(_)return _;let t=e.createProgram();if(!t)throw Error("Unable to create program");let r=(0,D.R)(e,e.VERTEX_SHADER,t$),i=(0,D.R)(e,e.FRAGMENT_SHADER,tK);e.attachShader(t,r),e.attachShader(t,i),(0,D.i)(e,t);let a=e.getUniformLocation(t,"projMatrix");if(!a)throw Error("Unable to get uniform location projMatrix");let s=e.getUniformLocation(t,"modelViewMatrix");if(!s)throw Error("Unable to get uniform location modelViewMatrix");let n=e.getUniformLocation(t,"cameraMatrix");if(!n)throw Error("Unable to get uniform location cameraMatrix");return _={prog:t,unif_matrix:s,unif_proj:a,unif_camera:n,attr_position:e.getAttribLocation(t,"position"),attr_color:e.getAttribLocation(t,"color")}}(e),s=function(e){if(c)return c;if(!(c=e.createBuffer()))throw Error("Unable to create buffer object");return e.bindBuffer(e.ARRAY_BUFFER,c),e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,0,.1,0,0,0,0,0,0,.1,0,0,0,0,0,0,.1]),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),c}(e),n=function(e){if(d)return d;if(!(d=e.createBuffer()))throw Error("Unable to create buffer object");return e.bindBuffer(e.ARRAY_BUFFER,d),e.bufferData(e.ARRAY_BUFFER,new Float32Array([1,0,0,1,1,0,0,1,0,1,0,1,0,1,0,1,0,0,1,1,0,0,1,1]),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),d}(e),e.disable(e.DEPTH_TEST),e.useProgram(a.prog),e.uniformMatrix4fv(a.unif_proj,!1,t),e.uniformMatrix4fv(a.unif_camera,!1,r),e.uniformMatrix4fv(a.unif_matrix,!1,i),e.bindBuffer(e.ARRAY_BUFFER,s),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,null),e.vertexAttribPointer(a.attr_position,3,e.FLOAT,!1,12,0),e.enableVertexAttribArray(a.attr_position),e.bindBuffer(e.ARRAY_BUFFER,n),e.vertexAttribPointer(a.attr_color,4,e.FLOAT,!1,16,0),e.enableVertexAttribArray(a.attr_color),e.lineWidth(2),e.drawArrays(e.LINES,0,6),e.disableVertexAttribArray(a.attr_position),e.disableVertexAttribArray(a.attr_color),e.bindBuffer(e.ARRAY_BUFFER,null)},pipeline_draw_face:(e,t,r,i,a)=>{var s;let n=tT(a);if(!n)return em("attempting to call draw_face on a destroyed zappar_face_mesh_t"),new Uint16Array;null==(s=eN.get(e))||s.drawFace(t,r,i,n)},pipeline_draw_face_project:(e,t,r,i,a,s,n)=>{var o;null==(o=eN.get(e))||o.drawFaceProject(t,r,i,a,s,n)},pipeline_draw_image_target_preview:(e,t,r,i,a,s)=>{var n;let o=tj.get(a);if(!o)return void em("image tracker not found");null==(n=eN.get(e))||n.drawImageTargetPreview(t,r,i,s,o)},projection_matrix_from_camera_model_and_size:G,projection_matrix_from_camera_model_and_size_ext:G,pipeline_process_gl:e=>{var t;return null==(t=eN.get(e))?void 0:t.processGL()},pipeline_gl_context_set:(e,t,r)=>{var i;return null==(i=eN.get(e))?void 0:i.glContextSet(t,r)},pipeline_gl_context_lost:e=>{var t;return null==(t=eN.get(e))?void 0:t.glContextLost()},pipeline_camera_frame_upload_gl:e=>{var t;return null==(t=eN.get(e))?void 0:t.uploadGL()},pipeline_camera_frame_texture_gl:e=>{var t;return null==(t=eN.get(e))?void 0:t.cameraFrameTexture()},pipeline_camera_frame_texture_matrix:(e,t,r,i)=>{var a;return(null==(a=eN.get(e))?void 0:a.cameraFrameTextureMatrix(t,r,i))||z.vt()},pipeline_camera_frame_user_facing:e=>{var t;return(null==(t=eN.get(e))?void 0:t.cameraFrameUserFacing())||!1},pipeline_camera_pose_default:()=>z.vt(),pipeline_camera_pose_with_attitude:(e,t)=>{var r;return(null==(r=eN.get(e))?void 0:r.cameraPoseWithAttitude(t))||z.vt()},pipeline_camera_pose_with_origin:(e,t)=>{let r=z.vt();return z.B8(r,t),r},pipeline_sequence_record_clear:e=>{var t;return null==(t=eN.get(e))?void 0:t.sequenceRecordClear()},pipeline_sequence_record_start:(e,t)=>{var r;return null==(r=eN.get(e))?void 0:r.sequenceRecordStart(t)},pipeline_sequence_record_stop:e=>{var t;return null==(t=eN.get(e))?void 0:t.sequenceRecordStop()},pipeline_sequence_record_device_attitude_matrices_set:(e,t)=>{var r;return null==(r=eN.get(e))?void 0:r.sequenceRecordDeviceAttitudeMatrices(t)},pipeline_sequence_record_data:e=>{var t;return(null==(t=eN.get(e))?void 0:t.sequenceRecordData())||new Uint8Array(0)},pipeline_sequence_record_data_size:e=>{var t;return(null==(t=eN.get(e))?void 0:t.sequenceRecordData().byteLength)||0},pipeline_camera_frame_data_raw:e=>{var t;return(null==(t=eN.get(e))?void 0:t.getCameraFrameDataRaw())||Promise.reject()},pipeline_camera_frame_data_raw_enabled_set:(e,t)=>{var r;return null==(r=eN.get(e))?void 0:r.setCameraFrameDataRawEnabled(t)},pipeline_camera_frame_data_rgb:e=>{var t;return null==(t=eN.get(e))?void 0:t.getCameraFrameDataRGB()},pipeline_camera_frame_data_rgb_enabled_set:(e,t)=>{var r;return null==(r=eN.get(e))?void 0:r.setCameraFrameDataRGBEnabled(t)},instant_world_tracker_anchor_pose_camera_relative:(e,t)=>{let r=eV(void 0,p.impl.instant_world_tracker_anchor_pose_raw(e));if(t){let e=z.vt();z.CV(e,[-1,1,1]),z.lw(r,e,r),z.lw(r,r,e)}return r},instant_world_tracker_anchor_pose:(e,t,r)=>{let i=eV(void 0,p.impl.instant_world_tracker_anchor_pose_raw(e));if(r){let e=z.vt();z.CV(e,[-1,1,1]),z.lw(i,e,i),z.lw(i,i,e)}return z.lw(i,t,i),i},instant_world_tracker_anchor_pose_set_from_camera_offset:(e,t,r,i,a)=>{let s=W(!1)*Math.PI/180,n=z.vt();z.$0(n,-s,[0,0,1]);let o=O();N(o,[t,r,i],n),p.impl.instant_world_tracker_anchor_pose_set_from_camera_offset_raw(e,o[0],o[1],o[2],a)},custom_anchor_pose_raw:e=>{let t=b.get(e);if(void 0===t)return em("attempting to call custom_anchor_pose_raw on a destroyed zappar_custom_anchor_t"),z.vt();if(t.sessionNumber<h.world_tracker_session_number(t.wt))return h.world_tracker_world_anchor_pose_raw(t.wt).slice();if(t.expectedPoseVersion==h.custom_anchor_pose_version(e))return w.custom_anchor_pose_raw(e);let r=h.world_tracker_world_anchor_pose_raw(t.wt).slice(),i=z.vt();return z.lw(i,r,t.poseRelativeToWorldAnchor),i},custom_anchor_status:e=>{let t=b.get(e);return void 0===t?(em("attempting to call custom_anchor_status on a destroyed zappar_custom_anchor_t"),I.uI.ANCHOR_STATUS_STOPPED):t.sessionNumber<h.world_tracker_session_number(t.wt)?I.uI.ANCHOR_STATUS_STOPPED:t.expectedPoseVersion==h.custom_anchor_pose_version(e)?w.custom_anchor_status(e):I.uI.ANCHOR_STATUS_INITIALIZING},custom_anchor_pose_camera_relative:(e,t)=>{let r=eV(void 0,h.custom_anchor_pose_raw(e));if(t){let e=z.vt();z.CV(e,[-1,1,1]),z.lw(r,e,r),z.lw(r,r,e)}return r},custom_anchor_pose:(e,t,r)=>{let i=eV(void 0,h.custom_anchor_pose_raw(e));if(r){let e=z.vt();z.CV(e,[-1,1,1]),z.lw(i,e,i),z.lw(i,i,e)}return z.lw(i,t,i),i},custom_anchor_create:(e,t,r)=>{let i=w.custom_anchor_create(e,t,r);return b.set(i,{id:r,wt:t,sessionNumber:-1,expectedPoseVersion:0,poseRelativeToWorldAnchor:z.vt()}),i},custom_anchor_id:e=>{var t;let r=null==(t=b.get(e))?void 0:t.id;return void 0===r?(em("attempting to call custom_anchor_id on a destroyed zappar_custom_anchor_t"),""):r},custom_anchor_pose_set_from_camera_offset:(e,t,r,i,a)=>{let s=b.get(e);if(void 0===s)return void em("attempting to call custom_anchor_pose_set_from_camera_offset on a destroyed zappar_custom_anchor_t");let n=z.vt();switch(z.B8(t0,h.world_tracker_world_anchor_pose_camera_relative(s.wt,!1)),t1[0]=t,t1[1]=r,t1[2]=i,a){case I.zn.PARENT:n[12]=t1[0],n[13]=t1[1],n[14]=t1[2],z.lw(n,t0,n);break;case I.zn.UNCHANGED:z.C(n,h.custom_anchor_pose_camera_relative(e,!1)),n[12]=t1[0],n[13]=t1[1],n[14]=t1[2],z.lw(n,t0,n);break;case I.zn.WORLD:N(t1,t1,t0),n[12]=t1[0],n[13]=t1[1],n[14]=t1[2];break;case I.zn.Z_TOWARDS_CAMERA:N(t1,t1,t0);let o=t0[12]-t1[0],l=t0[14]-t1[2],_=o*o+l*l;if(_>Number.EPSILON){let e=1/Math.sqrt(_);o*=e,l*=e,n[8]=o,n[10]=l,n[0]=l,n[2]=-o}n[12]=t1[0],n[13]=t1[1],n[14]=t1[2]}h.custom_anchor_pose_set(e,n)},custom_anchor_pose_set_from_anchor_offset:(e,t,r,i,a,s)=>{let n,o=b.get(e);if(void 0===o)return void em("attempting to call custom_anchor_pose_set_from_anchor_offset on a destroyed zappar_custom_anchor_t");if(t===h.world_tracker_ground_anchor_id(o.wt))n=h.world_tracker_ground_anchor_pose_raw(o.wt);else if(t===h.world_tracker_world_anchor_id(o.wt))n=h.world_tracker_world_anchor_pose_raw(o.wt);else{for(let e=0;e<h.world_tracker_plane_anchor_count(o.wt);e++)if(t===h.world_tracker_plane_anchor_id(o.wt,e)){n=h.world_tracker_plane_anchor_pose_raw(o.wt,e);break}if(!n){for(let[e,r]of b.entries())if(r.id===t){n=h.custom_anchor_pose_raw(e);break}}}if(!n||16!==n.length)return void em("unable for find valid pose for anchor with id",t);let l=z.vt();switch(z.B8(t0,h.world_tracker_world_anchor_pose_raw(o.wt)),t1[0]=r,t1[1]=i,t1[2]=a,N(t1,t1,n),s){case I.zn.PARENT:z.C(l,n),l[12]=t1[0],l[13]=t1[1],l[14]=t1[2],z.lw(l,t0,l);break;case I.zn.UNCHANGED:z.C(l,h.custom_anchor_pose_raw(e)),l[12]=t1[0],l[13]=t1[1],l[14]=t1[2],z.lw(l,t0,l);break;case I.zn.WORLD:N(t1,t1,t0),l[12]=t1[0],l[13]=t1[1],l[14]=t1[2];break;case I.zn.Z_TOWARDS_CAMERA:N(t1,t1,t0);let _=t0[12]-t1[0],c=t0[14]-t1[2],d=_*_+c*c;if(d>Number.EPSILON){let e=1/Math.sqrt(d);_*=e,c*=e,l[8]=_,l[10]=c,l[0]=c,l[2]=-_}l[12]=t1[0],l[13]=t1[1],l[14]=t1[2]}h.custom_anchor_pose_set_with_parent(e,l,t)},custom_anchor_pose_set:(e,t)=>{let r=b.get(e);if(void 0===r)return void em("attempting to call custom_anchor_pose_set on a destroyed zappar_custom_anchor_t");r.sessionNumber=h.world_tracker_session_number(r.wt),r.expectedPoseVersion++,z.C(r.poseRelativeToWorldAnchor,t),w.custom_anchor_pose_set(e,t)},custom_anchor_pose_set_with_parent:(e,t,r)=>{let i=b.get(e);if(void 0===i)return void em("attempting to call custom_anchor_pose_set_with_parent on a destroyed zappar_custom_anchor_t");i.sessionNumber=h.world_tracker_session_number(i.wt),i.expectedPoseVersion++,z.C(i.poseRelativeToWorldAnchor,t),w.custom_anchor_pose_set_with_parent(e,t,r)},custom_anchor_destroy:e=>{b.delete(e),w.custom_anchor_destroy(e)},image_tracker_create:e=>tj.create(e,p.impl),image_tracker_destroy:e=>{var t;return null==(t=tj.get(e))?void 0:t.destroy()},image_tracker_target_type:(e,t)=>{let r=tj.get(e);return r?r.getTargetInfo(t).type:(em("attempting to call image_tracker_target_type on a destroyed zappar_image_tracker_t"),I.yc.IMAGE_TRACKER_TYPE_PLANAR)},image_tracker_target_count:e=>{let t=tj.get(e);return t?t.targetCount():(em("attempting to call image_tracker_target_count on a destroyed zappar_image_tracker_t"),0)},image_tracker_target_load_from_memory:(e,t)=>{let r=tj.get(e);if(!r)return em("attempting to call image_tracker_target_load_from_memory on a destroyed zappar_image_tracker_t"),0;r.loadFromMemory(t)},image_tracker_target_preview_compressed:(e,t)=>{var r;let i=tj.get(e);return i?(null==(r=i.getTargetInfo(t).preview)?void 0:r.compressed)||new Uint8Array(0):(em("attempting to call image_tracker_target_preview_compressed on a destroyed zappar_image_tracker_t"),new Uint8Array(0))},image_tracker_target_preview_compressed_mimetype:(e,t)=>{var r;let i=tj.get(e);return i?(null==(r=i.getTargetInfo(t).preview)?void 0:r.mimeType)||"":(em("attempting to call image_tracker_target_preview_compressed_mimetype on a destroyed zappar_image_tracker_t"),"")},image_tracker_target_preview_compressed_size:(e,t)=>{var r,i;let a=tj.get(e);return a?(null==(i=null==(r=a.getTargetInfo(t).preview)?void 0:r.compressed)?void 0:i.byteLength)||0:(em("attempting to call image_tracker_target_preview_compressed_size on a destroyed zappar_image_tracker_t"),0)},image_tracker_target_physical_scale_factor:(e,t)=>{let r=tj.get(e);return r?r.getTargetInfo(t).physicalScaleFactor:(em("attempting to call image_tracker_target_physical_scale_factor on a destroyed zappar_image_tracker_t"),0)},image_tracker_target_radius_top:(e,t)=>{let r=tj.get(e);return r?r.getTargetInfo(t).topRadius:(em("attempting to call image_tracker_target_radius_top on a destroyed zappar_image_tracker_t"),0)},image_tracker_target_radius_bottom:(e,t)=>{let r=tj.get(e);return r?r.getTargetInfo(t).bottomRadius:(em("attempting to call image_tracker_target_radius_bottom on a destroyed zappar_image_tracker_t"),0)},image_tracker_target_side_length:(e,t)=>{let r=tj.get(e);return r?r.getTargetInfo(t).sideLength:(em("attempting to call image_tracker_target_side_length on a destroyed zappar_image_tracker_t"),0)},image_tracker_target_image:(e,t)=>{let r=tj.get(e);return r?r.getDecodedPreview(t):(em("attempting to call image_tracker_target_image on a destroyed zappar_image_tracker_t"),new Image)},image_tracker_anchor_pose_camera_relative:(e,t,r)=>{let i=eV(void 0,p.impl.image_tracker_anchor_pose_raw(e,t));if(r){let e=z.vt();z.CV(e,[-1,1,1]),z.lw(i,e,i),z.lw(i,i,e)}return i},image_tracker_anchor_pose:(e,t,r,i)=>{let a=eV(void 0,p.impl.image_tracker_anchor_pose_raw(e,t));if(i){let e=z.vt();z.CV(e,[-1,1,1]),z.lw(a,e,a),z.lw(a,a,e)}return z.lw(a,r,a),a},image_tracker_target_preview_mesh_indices:(e,t)=>{let r=tj.get(e);return r?r.getPreviewMesh(t).indices:(em("attempting to call image_tracker_target_preview_mesh_indices on a destroyed zappar_image_tracker_t"),new Uint16Array)},image_tracker_target_preview_mesh_vertices:(e,t)=>{let r=tj.get(e);return r?r.getPreviewMesh(t).vertices:(em("attempting to call image_tracker_target_preview_mesh_vertices on a destroyed zappar_image_tracker_t"),new Float32Array)},image_tracker_target_preview_mesh_uvs:(e,t)=>{let r=tj.get(e);return r?r.getPreviewMesh(t).uvs:(em("attempting to call image_tracker_target_preview_mesh_uvs on a destroyed zappar_image_tracker_t"),new Float32Array)},image_tracker_target_preview_mesh_normals:(e,t)=>{let r=tj.get(e);return r?r.getPreviewMesh(t).normals:(em("attempting to call image_tracker_target_preview_mesh_normals on a destroyed zappar_image_tracker_t"),new Float32Array)},image_tracker_target_preview_mesh_indices_size:(e,t)=>{let r=tj.get(e);return r?r.getPreviewMesh(t).indices.length:(em("attempting to call image_tracker_target_preview_mesh_indices_size on a destroyed zappar_image_tracker_t"),0)},image_tracker_target_preview_mesh_vertices_size:(e,t)=>{let r=tj.get(e);return r?r.getPreviewMesh(t).vertices.length:(em("attempting to call image_tracker_target_preview_mesh_vertices_size on a destroyed zappar_image_tracker_t"),0)},image_tracker_target_preview_mesh_uvs_size:(e,t)=>{let r=tj.get(e);return r?r.getPreviewMesh(t).uvs.length:(em("attempting to call image_tracker_target_preview_mesh_uvs_size on a destroyed zappar_image_tracker_t"),0)},image_tracker_target_preview_mesh_normals_size:(e,t)=>{let r=tj.get(e);return r?r.getPreviewMesh(t).normals.length:(em("attempting to call image_tracker_target_preview_mesh_normals_size on a destroyed zappar_image_tracker_t"),0)},zapcode_tracker_anchor_pose_camera_relative:(e,t,r)=>{let i=eV(void 0,p.impl.zapcode_tracker_anchor_pose_raw(e,t));if(r){let e=z.vt();z.CV(e,[-1,1,1]),z.lw(i,e,i),z.lw(i,i,e)}return i},zapcode_tracker_anchor_pose:(e,t,r,i)=>{let a=eV(void 0,p.impl.zapcode_tracker_anchor_pose_raw(e,t));if(i){let e=z.vt();z.CV(e,[-1,1,1]),z.lw(a,e,a),z.lw(a,a,e)}return z.lw(a,r,a),a},face_tracker_anchor_pose_camera_relative:(e,t,r)=>{let i=eV(void 0,p.impl.face_tracker_anchor_pose_raw(e,t));if(r){let e=z.vt();z.CV(e,[-1,1,1]),z.lw(i,e,i),z.lw(i,i,e)}return i},face_tracker_anchor_pose:(e,t,r,i)=>{let a=eV(void 0,p.impl.face_tracker_anchor_pose_raw(e,t));if(i){let e=z.vt();z.CV(e,[-1,1,1]),z.lw(a,e,a),z.lw(a,a,e)}return z.lw(a,r,a),a},face_tracker_model_load_default:e=>tQ(this,void 0,void 0,function*(){yield function(e){return tQ(this,void 0,void 0,function*(){let t=new r.U(r(6707)),i=yield fetch(t.toString()),a=yield i.arrayBuffer();null==h||h.face_tracker_model_load_from_memory(e,a)})}(e)}),face_mesh_create:()=>{let e;return e=tw++,tA.set(e,new tE),eh("face_mesh_t initialized"),e},face_mesh_destroy:e=>{tA.delete(e)},face_mesh_indices:e=>{let t=tT(e);return t?t.getIndices():(em("attempting to call face_mesh_indices on a destroyed zappar_face_mesh_t"),new Uint16Array)},face_mesh_indices_size:e=>{let t=tT(e);return t?t.getIndices().length:(em("attempting to call face_mesh_indices_size on a destroyed zappar_face_mesh_t"),0)},face_mesh_uvs:e=>{let t=tT(e);return t?t.getUVs():(em("attempting to call face_mesh_uvs on a destroyed zappar_face_mesh_t"),new Float32Array)},face_mesh_uvs_size:e=>{let t=tT(e);return t?t.getUVs().length:(em("attempting to call face_mesh_uvs_size on a destroyed zappar_face_mesh_t"),0)},face_mesh_vertices:e=>{let t=tT(e);return t?t.getVertices():(em("attempting to call face_mesh_vertices on a destroyed zappar_face_mesh_t"),new Float32Array)},face_mesh_vertices_size:e=>{let t=tT(e);return t?t.getVertices().length:(em("attempting to call face_mesh_vertices_size on a destroyed zappar_face_mesh_t"),0)},face_mesh_normals:e=>{let t=tT(e);return t?t.getNormals():(em("attempting to call face_mesh_normals on a destroyed zappar_face_mesh_t"),new Float32Array)},face_mesh_normals_size:e=>{let t=tT(e);return t?t.getNormals().length:(em("attempting to call face_mesh_normals_size on a destroyed zappar_face_mesh_t"),0)},face_mesh_load_from_memory:(e,t,r,i,a,s)=>{let n=tT(e);if(!n)return void em("attempting to call face_mesh_load_from_memory on a destroyed zappar_face_mesh_t");n.loadFromMemory(t,r,i,a,s)},face_mesh_update:(e,t,r,i)=>{let a=tT(e);if(!a)return void em("attempting to call face_mesh_update on a destroyed zappar_face_mesh_t");a.update(t,r,i)},face_mesh_load_default:e=>tQ(this,void 0,void 0,function*(){let t=tT(e);if(!t)return void em("attempting to call face_mesh_load_default on a destroyed zappar_face_mesh_t");let i=new r.U(r(1065)),a=yield fetch(i.toString());t.loadFromMemory((yield a.arrayBuffer()),!1,!1,!1,!1)}),face_mesh_load_default_face:(e,t,i,a)=>tQ(this,void 0,void 0,function*(){let s=tT(e);if(!s)return void em("attempting to call face_mesh_load_default_face on a destroyed zappar_face_mesh_t");let n=new r.U(r(1065)),o=yield fetch(n.toString());s.loadFromMemory((yield o.arrayBuffer()),t,i,a,!1)}),face_mesh_load_default_full_head_simplified:(e,t,i,a,s)=>tQ(this,void 0,void 0,function*(){let n=tT(e);if(!n)return void em("attempting to call face_mesh_load_default_full_head_simplified on a destroyed zappar_face_mesh_t");let o=new r.U(r(2771)),l=yield fetch(o.toString());n.loadFromMemory((yield l.arrayBuffer()),t,i,a,s)}),face_mesh_loaded_version:e=>{let t=tT(e);return t?t.getModelVersion():(em("attempting to call face_mesh_load_default on a destroyed zappar_face_mesh_t"),-1)},face_landmark_create:e=>{let t;return t=tx++,tM.set(t,new tk(e)),eh("face_landmark_t initialized"),t},face_landmark_destroy:e=>{tM.delete(e)},face_landmark_update:(e,t,r,i)=>{let a=tM.get(e);if(!a)return void em("attempting to call face_landmark_update on a destroyed zappar_face_landmark_t");a.update(t,r,i)},face_landmark_anchor_pose:e=>{let t=tM.get(e);return t?t.anchor_pose:(em("attempting to call face_landmark_anchor_pose on a destroyed zappar_face_landmark_t"),z.vt())},world_tracker_create:e=>{let t=w.world_tracker_create(e);return tJ.set(t,e),t},world_tracker_points_data_matrix:(e,t,r,i)=>{var a,s;let n,o,l=tJ.get(e);return void 0!==l&&h?(a=h.pipeline_camera_data_width(l),s=h.pipeline_camera_data_height(l),n=z.vt(),o=z.vt(),z.kN(o,[-.5*a,-.5*s,0]),z.lw(n,o,n),z.CV(o,[2/a,-(2/s),1]),z.lw(n,o,n),i&&(z.CV(o,[-1,1,1]),z.lw(n,o,n)),z.CV(o,[1,(t>r?t/r:r/t)/(a/s),1]),z.lw(n,o,n),z.$0(o,function(){if(window.screen.orientation&&!V.M.forceWindowOrientation)switch(window.screen.orientation.type){case"portrait-primary":return 270;case"landscape-secondary":return 180;case"portrait-secondary":return 90}else if(void 0!==window.orientation)switch(window.orientation){case 0:return 270;case 90:break;case 180:return 90;case -90:return 180}return 0}()*Math.PI/180,[0,0,1]),z.lw(n,o,n),n):z.vt()},world_tracker_plane_anchor_pose_camera_relative:(e,t,r)=>{let i=eV(void 0,h.world_tracker_plane_anchor_pose_raw(e,t));if(r){let e=z.vt();z.CV(e,[-1,1,1]),z.lw(i,e,i),z.lw(i,i,e)}return i},world_tracker_plane_anchor_pose:(e,t,r,i)=>{let a=eV(void 0,h.world_tracker_plane_anchor_pose_raw(e,t));if(i){let e=z.vt();z.CV(e,[-1,1,1]),z.lw(a,e,a),z.lw(a,a,e)}return z.lw(a,r,a),a},world_tracker_world_anchor_pose:(e,t,r)=>{let i=eV(void 0,h.world_tracker_world_anchor_pose_raw(e));if(r){let e=z.vt();z.CV(e,[-1,1,1]),z.lw(i,e,i),z.lw(i,i,e)}return z.lw(i,t,i),i},world_tracker_world_anchor_pose_camera_relative:(e,t)=>{let r=eV(void 0,h.world_tracker_world_anchor_pose_raw(e));if(t){let e=z.vt();z.CV(e,[-1,1,1]),z.lw(r,e,r),z.lw(r,r,e)}return r},world_tracker_ground_anchor_pose:(e,t,r)=>{let i=eV(void 0,h.world_tracker_ground_anchor_pose_raw(e));if(r){let e=z.vt();z.CV(e,[-1,1,1]),z.lw(i,e,i),z.lw(i,i,e)}return z.lw(i,t,i),i},world_tracker_ground_anchor_pose_camera_relative:(e,t)=>{let r=eV(void 0,h.world_tracker_ground_anchor_pose_raw(e));if(t){let e=z.vt();z.CV(e,[-1,1,1]),z.lw(r,e,r),z.lw(r,r,e)}return r},world_tracker_vertical_plane_detection_supported:e=>!!t,world_tracker_mesh_anchor_pose_camera_relative:(e,t,r)=>{let i=eV(void 0,h.world_tracker_mesh_anchor_pose_raw(e,t));if(r){let e=z.vt();z.CV(e,[-1,1,1]),z.lw(i,e,i),z.lw(i,i,e)}return i},world_tracker_mesh_anchor_pose:(e,t,r,i)=>{let a=eV(void 0,h.world_tracker_mesh_anchor_pose_raw(e,t));if(i){let e=z.vt();z.CV(e,[-1,1,1]),z.lw(a,e,a),z.lw(a,a,e)}return z.lw(a,r,a),a},html_element_source_create:(e,t)=>ew.createVideoElementSource(e,t),html_element_source_start:e=>{var t;return null==(t=ew.getVideoElementSource(e))?void 0:t.start()},html_element_source_pause:e=>{var t;return null==(t=ew.getVideoElementSource(e))?void 0:t.pause()},html_element_source_destroy:e=>{var t;return null==(t=ew.getVideoElementSource(e))?void 0:t.destroy()},sequence_source_create:e=>tC.create(e),sequence_source_load_from_memory:(e,t)=>{var r;return null==(r=tC.get(e))?void 0:r.loadFromMemory(t)},sequence_source_pause:e=>{var t;return null==(t=tC.get(e))?void 0:t.pause()},sequence_source_start:e=>{var t;return null==(t=tC.get(e))?void 0:t.start()},sequence_source_max_playback_fps_set:(e,t)=>{var r;return null==(r=tC.get(e))?void 0:r.maxPlaybackFpsSet(t)},sequence_source_time_set:(e,t)=>{var r;return null==(r=tC.get(e))?void 0:r.setTime(t)},sequence_source_destroy:e=>{var t;return null==(t=tC.get(e))?void 0:t.destroy()},permission_granted_all:tp,permission_granted_camera:tc,permission_granted_motion:td,permission_denied_any:tm,permission_denied_camera:th,permission_denied_motion:tu,permission_request_motion:tv,permission_request_camera:tg,permission_request_all:tf,permission_request_ui:tb,permission_request_ui_promise:tb,permission_denied_ui:ty,browser_incompatible:tI.incompatible,browser_incompatible_ui:tI.incompatible_ui,in_app_clip:()=>tr.IsSupported(),log_level_set:e=>{ed=e,p.impl.log_level_set(e)},cookies_permitted:e=>{var t;e?g||(t=f,window.localStorage.setItem("z_uar_lid",t),g=!0):window.localStorage.removeItem("z_uar_lid")}})}(m));return u}function t2(e){return t4().camera_default_device_id(e||!1)}function t3(){return t4().browser_incompatible()}function t5(){t4().browser_incompatible_ui()}function t7(){return t4().loaded()}async function t6(){for(;;){if(t7())return;await new Promise(e=>setTimeout(e,50))}}function t8(e){t4().cookies_permitted(e)}class t9{constructor(e,t){this._pipeline=e,this.onVisible=new v,this.onNotVisible=new v,this.onNewAnchor=new v,this.visible=new Set,this.anchors=new Map,this._visibleLastFrame=new Set,this._frameUpdate=()=>{let e=new Set,t=this.visible;this.visible=this._visibleLastFrame,this._visibleLastFrame=t,this.visible.clear();let r=this._z.image_tracker_anchor_count(this._impl);for(let t=0;t<r;t++){let r=this._z.image_tracker_anchor_id(this._impl,t),i=this.anchors.get(r);i||(i={onVisible:new g,onNotVisible:new g,id:r,poseCameraRelative:e=>this._z.image_tracker_anchor_pose_camera_relative(this._impl,t,!0===e),pose:(e,r)=>this._z.image_tracker_anchor_pose(this._impl,t,e,!0===r),visible:!0},this.anchors.set(r,i),e.add(i)),i.visible=!0,this.visible.add(i)}for(let t of e)this.onNewAnchor.emit(t);for(let e of this.visible)this._visibleLastFrame.has(e)?this._visibleLastFrame.delete(e):(this.onVisible.emit(e),e.onVisible.emit());for(let e of this._visibleLastFrame)e.visible=!1,this.onNotVisible.emit(e),e.onNotVisible.emit()},this._pipeline._onFrameUpdateInternal.bind(this._frameUpdate),this._z=t4(),this._impl=this._z.image_tracker_create(this._pipeline._getImpl()),t&&this.loadTarget(t)}destroy(){this._pipeline._onFrameUpdateInternal.unbind(this._frameUpdate),this.anchors.clear(),this.visible.clear(),this._z.image_tracker_destroy(this._impl)}async loadTarget(e){"string"==typeof e&&(e=await (await fetch(e)).arrayBuffer()),this._targets=void 0,this._z.image_tracker_target_load_from_memory(this._impl,e)}get enabled(){return this._z.image_tracker_enabled(this._impl)}set enabled(e){this._z.image_tracker_enabled_set(this._impl,e)}get targets(){if(!this._targets){this._targets=[];let e=this._z.image_tracker_target_count(this._impl);for(let t=0;t<e;t++)this._targets.push(new re(this._z,this._impl,t))}return this._targets}}class re{constructor(e,t,r){this._z=e,this._impl=t,this._indx=r,this.physicalScaleFactor=this._z.image_tracker_target_physical_scale_factor(this._impl,this._indx),this.physicalScaleFactor<0&&(this.physicalScaleFactor=void 0),this.topRadius=this._z.image_tracker_target_radius_top(this._impl,this._indx),this.topRadius<0&&(this.topRadius=void 0),this.bottomRadius=this._z.image_tracker_target_radius_bottom(this._impl,this._indx),this.bottomRadius<0&&(this.bottomRadius=void 0),this.sideLength=this._z.image_tracker_target_side_length(this._impl,this._indx),this.sideLength<0&&(this.sideLength=void 0)}get image(){return void 0===this._image&&(this._image=this._z.image_tracker_target_image(this._impl,this._indx)||null),this._image||void 0}get preview(){return void 0===this._preview&&(this._preview=new rt(this._z,this._impl,this._indx)),this._preview}}class rt{constructor(e,t,r){this._z=e,this._impl=t,this._indx=r,this.vertices=this._z.image_tracker_target_preview_mesh_vertices(this._impl,this._indx),this.indices=this._z.image_tracker_target_preview_mesh_indices(this._impl,this._indx),this.uvs=this._z.image_tracker_target_preview_mesh_uvs(this._impl,this._indx)}}class rr{constructor(e){this._pipeline=e,this.anchor={poseCameraRelative:e=>this._anchorPoseCameraRelative(e),pose:(e,t)=>this._anchorPose(e,t)},this._z=t4(),this._impl=this._z.instant_world_tracker_create(this._pipeline._getImpl())}destroy(){this._z.instant_world_tracker_destroy(this._impl)}_anchorPoseCameraRelative(e){return this._z.instant_world_tracker_anchor_pose_camera_relative(this._impl,!0===e)}_anchorPose(e,t){return this._z.instant_world_tracker_anchor_pose(this._impl,e,!0===t)}get enabled(){return this._z.instant_world_tracker_enabled(this._impl)}set enabled(e){this._z.instant_world_tracker_enabled_set(this._impl,e)}setAnchorPoseFromCameraOffset(e,t,r,i){this._z.instant_world_tracker_anchor_pose_set_from_camera_offset(this._impl,e,t,r,i||I.HO.MINUS_Z_AWAY_FROM_USER)}}class ri{constructor(e){this._pipeline=e,this.onDetection=new v,this._lastDetected=[],this._found=[],this._formats=[],this._frameUpdate=()=>{this._found=[];let e=this._z.barcode_finder_found_number(this._impl);for(let t=0;t<e;t++)this._found.push({text:this._z.barcode_finder_found_text(this._impl,t),format:this._z.barcode_finder_found_format(this._impl,t)});if(0!==this._found.length){e:for(let e of this._found){for(let t of this._lastDetected)if(t.text===e.text)continue e;this.onDetection.emit(e)}this._lastDetected=this._found}},this._pipeline._onFrameUpdateInternal.bind(this._frameUpdate),this._z=t4(),this._impl=this._z.barcode_finder_create(this._pipeline._getImpl()),this._formats.push.apply(this._formats,[I.iq.AZTEC,I.iq.CODABAR,I.iq.CODE_39,I.iq.CODE_93,I.iq.CODE_128,I.iq.DATA_MATRIX,I.iq.EAN_8,I.iq.EAN_13,I.iq.ITF,I.iq.MAXICODE,I.iq.PDF_417,I.iq.QR_CODE,I.iq.RSS_14,I.iq.RSS_EXPANDED,I.iq.UPC_A,I.iq.UPC_E,I.iq.UPC_EAN_EXTENSION])}destroy(){this._pipeline._onFrameUpdateInternal.unbind(this._frameUpdate),this._found=[],this._lastDetected=[],this._z.barcode_finder_destroy(this._impl)}get found(){return this._found}get enabled(){return this._z.barcode_finder_enabled(this._impl)}set enabled(e){this._z.barcode_finder_enabled_set(this._impl,e)}get formats(){return this._formats}set formats(e){this._formats=e.slice();let t=0;for(let e of this._formats)t|=e;this._z.barcode_finder_formats_set(this._impl,t)}}class ra{constructor(e){this._pipeline=e,this.onVisible=new v,this.onNotVisible=new v,this.onNewAnchor=new v,this.visible=new Set,this.anchors=new Map,this._visibleLastFrame=new Set,this._frameUpdate=()=>{let e=new Set,t=this.visible;this.visible=this._visibleLastFrame,this._visibleLastFrame=t,this.visible.clear();let r=this._z.face_tracker_anchor_count(this._impl);for(let t=0;t<r;t++){let r=this._z.face_tracker_anchor_id(this._impl,t),i=this.anchors.get(r);i||(i={onVisible:new g,onNotVisible:new g,indx:0,id:r,poseCameraRelative:e=>this._z.face_tracker_anchor_pose_camera_relative(this._impl,i.indx,!0===e),pose:(e,t)=>this._z.face_tracker_anchor_pose(this._impl,i.indx,e,!0===t),identity:new Float32Array(50),expression:new Float32Array(29),visible:!0},this.anchors.set(r,i),e.add(i)),i.indx=t,i.visible=!0,i.identity=this._z.face_tracker_anchor_identity_coefficients(this._impl,t),i.expression=this._z.face_tracker_anchor_expression_coefficients(this._impl,t),this.visible.add(i)}for(let t of e)this.onNewAnchor.emit(t);for(let e of this.visible)this._visibleLastFrame.has(e)?this._visibleLastFrame.delete(e):(this.onVisible.emit(e),e.onVisible.emit());for(let e of this._visibleLastFrame)e.visible=!1,this.onNotVisible.emit(e),e.onNotVisible.emit()},this._pipeline._onFrameUpdateInternal.bind(this._frameUpdate),this._z=t4(),this._impl=this._z.face_tracker_create(this._pipeline._getImpl())}destroy(){this._pipeline._onFrameUpdateInternal.unbind(this._frameUpdate),this.anchors.clear(),this.visible.clear(),this._z.face_tracker_destroy(this._impl)}async loadModel(e){"string"==typeof e&&(e=await (await fetch(e)).arrayBuffer()),this._z.face_tracker_model_load_from_memory(this._impl,e)}async loadDefaultModel(){await this._z.face_tracker_model_load_default(this._impl)}get enabled(){return this._z.face_tracker_enabled(this._impl)}set enabled(e){this._z.face_tracker_enabled_set(this._impl,e)}get maxFaces(){return this._z.face_tracker_max_faces(this._impl)}set maxFaces(e){this._z.face_tracker_max_faces_set(this._impl,e)}}class rs{constructor(){this._z=t4(),this._impl=this._z.face_mesh_create()}destroy(){this._z.face_mesh_destroy(this._impl)}async load(e,t,r,i,a){if(!e)return void this.loadDefault();"string"==typeof e&&(e=await (await fetch(e)).arrayBuffer()),this._z.face_mesh_load_from_memory(this._impl,e,t||!1,r||!1,i||!1,a||!1)}async loadDefault(){await this._z.face_mesh_load_default(this._impl)}async loadDefaultFace(e,t,r){await this._z.face_mesh_load_default_face(this._impl,e||!1,t||!1,r||!1)}async loadDefaultFullHeadSimplified(e,t,r,i){await this._z.face_mesh_load_default_full_head_simplified(this._impl,e||!1,t||!1,r||!1,i||!1)}updateFromFaceAnchor(e,t){this._z.face_mesh_update(this._impl,e.identity,e.expression,t||!1)}updateFromIdentityExpression(e,t,r){this._z.face_mesh_update(this._impl,e,t,r||!1)}get vertices(){return this._z.face_mesh_vertices(this._impl)}get indices(){return this._z.face_mesh_indices(this._impl)}get uvs(){return this._z.face_mesh_uvs(this._impl)}get normals(){return this._z.face_mesh_normals(this._impl)}_getImpl(){return this._impl}}class rn{constructor(e,t){this._profile=I.HE.DEFAULT,this._z=t4(),this._impl=this._z.camera_source_create(e._getImpl(),t)}destroy(){this._z.camera_source_destroy(this._impl)}start(){this._z.camera_source_start(this._impl)}pause(){this._z.camera_source_pause(this._impl)}set profile(e){this._profile=e,this._z.camera_source_profile_set(this._impl,e)}get profile(){return this._profile}}class ro{constructor(e,t){this._z=t4(),this._impl=this._z.html_element_source_create(e._getImpl(),t)}destroy(){this._z.html_element_source_destroy(this._impl)}start(){this._z.html_element_source_start(this._impl)}pause(){this._z.html_element_source_pause(this._impl)}}class rl{constructor(e){this._z=t4(),this._impl=this._z.sequence_source_create(e._getImpl())}destroy(){this._z.sequence_source_destroy(this._impl)}start(){this._z.sequence_source_start(this._impl)}pause(){this._z.sequence_source_pause(this._impl)}async load(e){"string"==typeof e&&(e=await (await fetch(e)).arrayBuffer()),this._z.sequence_source_load_from_memory(this._impl,e)}setTime(e){this._z.sequence_source_time_set(this._impl,null!=e?e:-1)}}class r_{constructor(){this.onFrameUpdate=new g,this._onFrameUpdateInternal=new g,this._lastFrameNumber=-1,this._cameraFrameDataRawEnabled=!1,this._cameraFrameDataRGBEnabled=!1,this._z=t4(),this._impl=this._z.pipeline_create()}destroy(){this._z.pipeline_destroy(this._impl)}frameUpdate(){this._z.pipeline_frame_update(this._impl);let e=this._z.pipeline_frame_number(this._impl);e!==this._lastFrameNumber&&(this._lastFrameNumber=e,this._onFrameUpdateInternal.emit(),this.onFrameUpdate.emit())}_getImpl(){return this._impl}glContextSet(e){this._z.pipeline_gl_context_set(this._impl,e)}glContextLost(){this._z.pipeline_gl_context_lost(this._impl)}cameraDataSize(){return[this._z.pipeline_camera_data_width(this._impl),this._z.pipeline_camera_data_height(this._impl)]}cameraFrameTextureGL(){return this._z.pipeline_camera_frame_texture_gl(this._impl)}cameraFrameDataRaw(){return this._z.pipeline_camera_frame_data_raw(this._impl)}cameraFrameDataRGB(){return this._z.pipeline_camera_frame_data_rgb(this._impl)}set cameraFrameDataRGBEnabled(e){this._cameraFrameDataRGBEnabled=e,this._z.pipeline_camera_frame_data_rgb_enabled_set(this._impl,e)}get cameraFrameDataRGBEnabled(){return this._cameraFrameDataRGBEnabled}set cameraFrameDataRawEnabled(e){this._cameraFrameDataRawEnabled=e,this._z.pipeline_camera_frame_data_raw_enabled_set(this._impl,e)}get cameraFrameDataRawEnabled(){return this._cameraFrameDataRawEnabled}projectionMatrix(e,t,r=.1,i=100){let a=this.cameraModel(),[s,n]=this.cameraDataSize();return this._z.projection_matrix_from_camera_model_and_size_ext(a,s,n,e,t,r,i)}cameraFrameTextureMatrix(e,t,r){return this._z.pipeline_camera_frame_texture_matrix(this._impl,e,t,!0===r)}cameraFrameDrawGL(e,t,r){this._z.pipeline_camera_frame_draw_gl(this._impl,e,t,r)}cameraFrameUploadGL(){this._z.pipeline_camera_frame_upload_gl(this._impl)}processGL(){this._z.pipeline_process_gl(this._impl)}cameraModel(){return this._z.pipeline_camera_model(this._impl)}cameraPoseDefault(){return this._z.pipeline_camera_pose_default(this._impl)}cameraPoseWithAttitude(e){return this._z.pipeline_camera_pose_with_attitude(this._impl,e||!1)}cameraPoseWithOrigin(e){return this._z.pipeline_camera_pose_with_origin(this._impl,e)}cameraFrameUserFacing(){return this._z.pipeline_camera_frame_user_facing(this._impl)}drawFace(e,t,r,i){this._z.pipeline_draw_face(this._impl,e,t,r,i._getImpl())}frameNumber(){return this._z.pipeline_frame_number(this._impl)}sequenceRecordStart(e){void 0===e&&(e=150),this._z.pipeline_sequence_record_start(this._impl,e)}sequenceRecordStop(){this._z.pipeline_sequence_record_stop(this._impl)}sequenceRecordClear(){this._z.pipeline_sequence_record_clear(this._impl)}sequenceRecordData(){return this._z.pipeline_sequence_record_data(this._impl)}}class rc{constructor(e){this._name=e,this.pose=z.vt(),this._z=t4(),this._impl=this._z.face_landmark_create(this._name)}destroy(){this._z.face_landmark_destroy(this._impl)}updateFromFaceAnchor(e,t){this._z.face_landmark_update(this._impl,e.identity,e.expression,t||!1),this.pose=this._z.face_landmark_anchor_pose(this._impl)}updateFromIdentityExpression(e,t,r){this._z.face_landmark_update(this._impl,e,t,r||!1),this.pose=this._z.face_landmark_anchor_pose(this._impl)}_getImpl(){return this._impl}}class rd{constructor(e){this.onQuality=new v,this.onInitializing=new g,this.onQualityGood=new g,this.onQualityLimited=new g,this.quality=I.DN.WORLD_TRACKER_QUALITY_INITIALIZING,this.worldAnchor={id:"world",poseCameraRelative:e=>this._z.world_tracker_world_anchor_pose_camera_relative(this._impl,null!=e&&e),pose:(e,t)=>this._z.world_tracker_world_anchor_pose(this._impl,e,null!=t&&t),status:I.uI.ANCHOR_STATUS_INITIALIZING},this.groundAnchor={id:"ground",poseCameraRelative:e=>this._z.world_tracker_ground_anchor_pose_camera_relative(this._impl,null!=e&&e),pose:(e,t)=>this._z.world_tracker_ground_anchor_pose(this._impl,e,null!=t&&t),status:I.uI.ANCHOR_STATUS_INITIALIZING},this.planes=new Map,this.customAnchors=new Map,this.resetIfLimitedForMS=5e3,this._hadFirstPlane=!1,this._frameUpdate=()=>{this.worldAnchor.status=this._z.world_tracker_world_anchor_status(this._impl),this.worldAnchor.id=this._z.world_tracker_world_anchor_id(this._impl),this.groundAnchor.status=this._z.world_tracker_ground_anchor_status(this._impl),this.groundAnchor.id=this._z.world_tracker_ground_anchor_id(this._impl);let e=new Set,t=this._z.world_tracker_plane_anchor_count(this._impl);for(let r=0;r<t;r++){let t=this._z.world_tracker_plane_anchor_id(this._impl,r);e.add(t);let i=this.planes.get(t);i||(i={id:t,status:I.uI.ANCHOR_STATUS_INITIALIZING,poseCameraRelative:e=>this._z.world_tracker_plane_anchor_pose_camera_relative(this._impl,r,null!=e&&e),pose:(e,t)=>this._z.world_tracker_plane_anchor_pose(this._impl,r,e,null!=t&&t),polygon:new Float32Array,polygonVersion:0,orientation:I.z0.PLANE_ORIENTATION_HORIZONTAL,firstPlane:!this._hadFirstPlane},this._hadFirstPlane=!0,this.planes.set(t,i)),i.poseCameraRelative=e=>this._z.world_tracker_plane_anchor_pose_camera_relative(this._impl,r,null!=e&&e),i.pose=(e,t)=>this._z.world_tracker_plane_anchor_pose(this._impl,r,e,null!=t&&t),i.status=this._z.world_tracker_plane_anchor_status(this._impl,r),i.polygon=this._z.world_tracker_plane_anchor_polygon_data(this._impl,r),i.polygonVersion=this._z.world_tracker_plane_anchor_polygon_version(this._impl,r),i.orientation=this._z.world_tracker_plane_anchor_orientation(this._impl,r)}for(let t of this.planes.values())e.has(t.id)||(t.firstPlane&&(this._hadFirstPlane=!1),this.planes.delete(t.id));let r=this.quality;if(this.quality=this._z.world_tracker_quality(this._impl),r!==this.quality){switch(this._limitedTimeout&&this.quality!==I.DN.WORLD_TRACKER_QUALITY_LIMITED&&(window.clearTimeout(this._limitedTimeout),this._limitedTimeout=void 0),this.quality){case I.DN.WORLD_TRACKER_QUALITY_GOOD:this.onQualityGood.emit();break;case I.DN.WORLD_TRACKER_QUALITY_INITIALIZING:this.onInitializing.emit();break;case I.DN.WORLD_TRACKER_QUALITY_LIMITED:!this._limitedTimeout&&this.resetIfLimitedForMS>0&&(this._limitedTimeout=window.setTimeout(()=>{this.reset(),this._limitedTimeout=void 0},this.resetIfLimitedForMS)),this.onQualityLimited.emit()}this.onQuality.emit(this.quality)}},this._z=t4(),this._pipeline=e,this._pipeline._onFrameUpdateInternal.bind(this._frameUpdate),this._impl=this._z.world_tracker_create(this._pipeline._getImpl()),this.worldAnchor.id=this._z.world_tracker_world_anchor_id(this._impl),this.groundAnchor.id=this._z.world_tracker_ground_anchor_id(this._impl)}destroy(){this._pipeline._onFrameUpdateInternal.unbind(this._frameUpdate),this._z.world_tracker_destroy(this._impl)}reset(){this._z.world_tracker_reset(this._impl)}get enabled(){return this._z.world_tracker_enabled(this._impl)}set enabled(e){this._z.world_tracker_enabled_set(this._impl,e)}get horizontalPlaneDetectionEnabled(){return this._z.world_tracker_horizontal_plane_detection_enabled(this._impl)}set horizontalPlaneDetectionEnabled(e){this._z.world_tracker_horizontal_plane_detection_enabled_set(this._impl,e)}get verticalPlaneDetectionEnabled(){return this._z.world_tracker_vertical_plane_detection_enabled(this._impl)}set verticalPlaneDetectionEnabled(e){this._z.world_tracker_vertical_plane_detection_enabled_set(this._impl,e)}get verticalPlaneDetectionSupported(){return this._z.world_tracker_vertical_plane_detection_supported(this._impl)}get tracksDataEnabled(){return this._z.world_tracker_tracks_data_enabled(this._impl)}set tracksDataEnabled(e){this._z.world_tracker_tracks_data_enabled_set(this._impl,e)}get projectionsDataEnabled(){return this._z.world_tracker_projections_data_enabled(this._impl)}get tracksData(){return this._z.world_tracker_tracks_data(this._impl)}get projectionsData(){return this._z.world_tracker_projections_data(this._impl)}computePointsDataMatrix(e,t,r=!1){return this._z.world_tracker_points_data_matrix(this._impl,e,t,r)}}let rh=0;class ru{constructor(e,t){this._worldTracker=e,this._z=t4(),t?this.id=t:(this.id="custom-anchor-"+rh.toString(),rh++),e.customAnchors.set(this.id,this),this._impl=this._z.custom_anchor_create(e._pipeline._getImpl(),this._worldTracker._impl,this.id)}destroy(){this._z.custom_anchor_destroy(this._impl)}pose(e,t){return this._z.custom_anchor_pose(this._impl,e,null!=t&&t)}poseCameraRelative(e){return this._z.custom_anchor_pose_camera_relative(this._impl,null!=e&&e)}setPoseFromCameraOffset(e,t,r,i=I.zn.UNCHANGED){this._z.custom_anchor_pose_set_from_camera_offset(this._impl,e,t,r,i)}setPoseFromAnchorOffset(e,t,r,i,a=I.zn.UNCHANGED){let s="string"==typeof e?e:e.id;this._z.custom_anchor_pose_set_from_anchor_offset(this._impl,s,t,r,i,a)}setPose(e){this._z.custom_anchor_pose_set(this._impl,e)}setPoseWithParent(e,t){let r="string"==typeof t?t:t.id;this._z.custom_anchor_pose_set_with_parent(this._impl,e,r)}get status(){return this._z.custom_anchor_status(this._impl)}}!function(e){e[e.QR=0]="QR",e[e.DENSE=1]="DENSE"}(T||(T={}));let rm=`
<style>
	.zappar-world-tracker-ui {
		position: fixed;
		top: 0;
		left: 0;
		pointer-events: none;
		overflow: hidden;
		display: flex;
		flex-direction: column;
		align-items: center;
    	justify-content: center;
	}

	.zappar-world-tracker-ui-container {
		position: absolute;
		width: 208px;
		height: 208px;
		background: rgba(48, 48, 48, 0.87);
		border-radius: 16px;
		font-family: sans-serif;
		font-style: normal;
		font-weight: 500;
		font-size: 14px;
		line-height: 17px;
		text-align: center;
		color: white;
		display: flex;
		flex-direction: column;
		padding: 20px 30px;
		padding-bottom: 30px;
		box-sizing: border-box;
	}

	#zappar-world-tracker-ui-text {
		height: 34px;
	}

	.zappar-world-tracker-ui-animation {
		flex-grow: 1;
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
	}
	.zappar-world-tracker-ui-animation > svg {
		width: 128px;
	}
</style>

<div class="zappar-world-tracker-ui-container">
	<div class="zappar-world-tracker-ui-animation">
		<svg id="eefv1bMyhqS1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 128 88" shape-rendering="geometricPrecision" text-rendering="geometricPrecision">
		<style><![CDATA[
		#eefv1bMyhqS25_to {animation: eefv1bMyhqS25_to__to 3000ms linear infinite normal forwards}@keyframes eefv1bMyhqS25_to__to { 0% {offset-distance: 0%;animation-timing-function: cubic-bezier(0.42,0,0.58,1)} 26.666667% {offset-distance: 50%} 56.666667% {offset-distance: 50%;animation-timing-function: cubic-bezier(0.42,0,0.58,1)} 83.333333% {offset-distance: 100%} 100% {offset-distance: 100%}} #eefv1bMyhqS25_ts {animation: eefv1bMyhqS25_ts__ts 3000ms linear infinite normal forwards}@keyframes eefv1bMyhqS25_ts__ts { 0% {transform: scale(0.709677,0.709677);animation-timing-function: cubic-bezier(0.42,0,0.58,1)} 26.666667% {transform: scale(0.4,0.4)} 56.666667% {transform: scale(0.4,0.4);animation-timing-function: cubic-bezier(0.42,0,0.58,1)} 83.333333% {transform: scale(0.709677,0.709677)} 100% {transform: scale(0.709677,0.709677)}}
		]]></style>
		<defs><linearGradient id="eefv1bMyhqS24-stroke" x1="50" y1="32" x2="50" y2="0" spreadMethod="pad" gradientUnits="userSpaceOnUse" gradientTransform="translate(0 0)"><stop id="eefv1bMyhqS24-stroke-0" offset="0%" stop-color="#fff"/><stop id="eefv1bMyhqS24-stroke-1" offset="100%" stop-color="#a3a3a3"/></linearGradient></defs><ellipse rx="2" ry="1.00787" transform="translate(19 54.4252)" fill="#fff" fill-opacity="0.15"/><ellipse rx="2" ry="1.00787" transform="translate(37 54.4252)" fill="#fff"/><ellipse rx="2" ry="1.00787" transform="translate(55 54.4252)" fill="#fff"/><ellipse rx="2" ry="1.00787" transform="translate(73 54.4252)" fill="#fff"/><ellipse rx="2" ry="1.00787" transform="translate(91 54.4252)" fill="#fff"/><ellipse rx="2" ry="1.00787" transform="translate(109 54.4252)" fill="#fff" fill-opacity="0.5"/><ellipse rx="2" ry="1.00787" transform="translate(21 45.3543)" fill="#fff" fill-opacity="0.15"/><ellipse rx="2" ry="1.00787" transform="translate(39 45.3543)" fill="#fff"/><ellipse rx="2" ry="1.00787" transform="translate(56 45.3543)" fill="#fff"/><ellipse rx="2" ry="1.00787" transform="translate(72 45.3543)" fill="#fff"/><ellipse rx="2" ry="1.00787" transform="translate(89 45.3543)" fill="#fff"/><ellipse rx="2" ry="1.00787" transform="translate(107 45.3543)" fill="#fff" fill-opacity="0.15"/><ellipse rx="2" ry="1.00788" transform="translate(23 36.2835)" fill="#fff" fill-opacity="0.15"/><ellipse rx="2" ry="1.00788" transform="translate(41 36.2835)" fill="#fff" fill-opacity="0.4"/><ellipse rx="2" ry="1.00788" transform="translate(57 36.2835)" fill="#fff" fill-opacity="0.6"/><ellipse rx="2" ry="1.00788" transform="translate(71 36.2835)" fill="#fff" fill-opacity="0.6"/><ellipse rx="2" ry="1.00788" transform="translate(87 36.2835)" fill="#fff" fill-opacity="0.4"/><ellipse rx="2" ry="1.00788" transform="translate(105 36.2835)" fill="#fff" fill-opacity="0.15"/><ellipse rx="2" ry="1.00787" transform="translate(43 27.2126)" fill="#fff" fill-opacity="0.15"/><ellipse rx="2" ry="1.00787" transform="translate(58 27.2126)" fill="#fff" fill-opacity="0.1"/><ellipse rx="2" ry="1.00787" transform="translate(69 27.2126)" fill="#fff" fill-opacity="0.1"/><ellipse rx="2" ry="1.00787" transform="translate(85 27.2126)" fill="#fff" fill-opacity="0.07"/><path d="M22.2462,1h83.5078c3.212,0,6.012,2.18608,6.791,5.30225l12,48.00005C125.649,58.7203,122.308,63,117.754,63h-107.5078c-4.55399,0-7.89549-4.2797-6.79099-8.6978L15.4552,6.30225C16.2343,3.18608,19.0341,1,22.2462,1Z" fill="none" stroke="url(#eefv1bMyhqS24-stroke)" stroke-width="2"/><g id="eefv1bMyhqS25_to" style="offset-path:path('M63.999993,60C63.999993,60,64,37.449592,64,37.449592L64,37.449592L63.999993,60');offset-rotate:0deg"><g id="eefv1bMyhqS25_ts" transform="scale(0.709677,0.709677)"><rect width="31" height="55" rx="3.5" ry="3.5" transform="translate(-15.5,-27.5)" fill="#5b5b5b" stroke="#fff"/></g></g></svg>
	</div>
	<div id="zappar-world-tracker-ui-text">Move forward and back to find a surface</div>
</div>
`;class rp{constructor(e){this._canvas=e,this.dom=document.createElement("div"),this._lastRect=new DOMRect(0,0,0,0),this.dom.innerHTML=rm,this.dom.className="zappar-world-tracker-ui"}setText(e){this.dom.querySelector("#zappar-world-tracker-ui-text").innerText=e}update(){let e=this._canvas.getBoundingClientRect();this._lastRect&&this._lastRect.top===e.top&&this._lastRect.left===e.left&&this._lastRect.width===e.width&&this._lastRect.height===e.height||(this.dom.style.top=e.top.toString()+"px",this.dom.style.left=e.left.toString()+"px",this.dom.style.width=e.width.toString()+"px",this.dom.style.height=e.height.toString()+"px")}show(){this.dom.parentElement||document.body.appendChild(this.dom)}hide(){this.dom.remove()}}function rf(e){switch(e){case E.CAMERA:return t4().permission_granted_camera();case E.MOTION:return t4().permission_granted_motion();default:return t4().permission_granted_all()}}function rg(e){switch(e){case E.CAMERA:return t4().permission_denied_camera();case E.MOTION:return t4().permission_denied_motion();default:return t4().permission_denied_any()}}function rv(e){switch(e){case E.CAMERA:t4().permission_request_camera();break;case E.MOTION:t4().permission_request_motion();break;default:t4().permission_request_all()}return new Promise(async t=>{for(;;)switch(await new Promise(e=>requestAnimationFrame(()=>e())),e){case E.CAMERA:if(t4().permission_granted_camera())return void t(!0);if(t4().permission_denied_camera())return void t(!1);break;case E.MOTION:if(t4().permission_granted_motion())return void t(!0);if(t4().permission_denied_motion())return void t(!1);break;default:if(t4().permission_granted_camera()&&t4().permission_granted_motion())return void t(!0);if(t4().permission_denied_camera()||t4().permission_denied_motion())return void t(!1)}})}async function rb(e){return await t4().permission_request_ui_promise(e)}function ry(e){return t4().permission_denied_ui(e)}function rw(e){t4().log_level_set(e)}!function(e){e[e.CAMERA=0]="CAMERA",e[e.MOTION=1]="MOTION"}(E||(E={}));var rA=r(3264),rT=r(7431);let rE=new g;function rR(){return p||(p=new r_).onFrameUpdate.bind(()=>rE.emit()),p}class rx extends t9{constructor(e,t){super(t||rR(),e)}}class rM extends ri{constructor(e){super(e||rR())}}class rk extends ra{constructor(e){super(e||rR())}}class rI extends rr{constructor(e){super(e||rR())}}class rS extends rd{constructor(e){super(e||rR())}}class rF extends rn{constructor(e,t){super(t||rR(),e)}}class rC extends ro{constructor(e,t){super(t||rR(),e)}}function rD(e){rR().glContextSet(e)}function rU(){rR().glContextLost()}let rP=`
      precision highp float;
      varying vec2 vUv;
      void main() {
        vUv = uv;
        gl_Position = projectionMatrix * modelViewMatrix * vec4(position,1.0);
      }
    `,rL=`
      precision highp float;
      uniform sampler2D u_texture;
      varying vec2 vUv;
      void main() {
        vec4 texColor = texture2D(u_texture, vUv);
        texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
        gl_FragColor = texColor;
      }
    `;class rz extends rA.gPd{constructor(){super(),this.MirrorMode=x.None,this.onTextureUpdated=new v,this.viewMatrix=new rA.kn4,this.textureMatrix3=new rA.dwI}update(){}updateFromPipeline(e,t){t.cameraFrameUploadGL();let r=t.cameraFrameTextureGL();if(!r)return;let i=e.properties.get(this);i.__webglTexture=r,i.__webglInit=!0,this.viewMatrix.fromArray(t.cameraFrameTextureMatrix(e.domElement.width,e.domElement.height,this.MirrorMode===x.Poses)),this.textureMatrix3.setFromMatrix4(this.viewMatrix),this.textureMatrix3.elements[6]=this.viewMatrix.elements[12],this.textureMatrix3.elements[7]=this.viewMatrix.elements[13],this.textureMatrix3.elements[8]=1,this.matrixAutoUpdate=!1,this.matrix=this.textureMatrix3,this.onTextureUpdated.emit({texture:this,renderer:e})}dispose(){super.dispose()}}class rB{get texture(){return this.shaderRenderTarget.texture}constructor(e){this.shaderScene=new rA.Z58,this.shaderRenderTarget=new rA.nWS(1024,1024),this.shaderCamera=new rA.qUd(-1,1,1,-1,0,1),this.intermediateRenderTarget=new rA.nWS(1024,1024),eh("Inline decoder initialized"),this.shaderMaterial=new rA.BKk({uniforms:{u_texture:{value:null}},vertexShader:rP,fragmentShader:rL});let t=new rA.bdM(2,2),r=new rA.eaF(t,this.shaderMaterial);this.shaderScene.add(r),this.shaderRenderTarget.texture.generateMipmaps=!1,this.shaderRenderTarget.texture.minFilter=rA.k6q,this.shaderRenderTarget.texture.magFilter=rA.k6q,r.position.z=-1,this.shaderMaterial.uniforms.u_texture.value=e,e.onTextureUpdated.bind(({texture:e,renderer:t})=>{this.update(t,e)})}update(e,t){let r=!0;if(rA.er$&&e.outputColorSpace&&(r=e.outputColorSpace===rA.er$),!r)return;let i=e.getRenderTarget();this.shaderMaterial.uniforms.u_texture.value=t,e.setRenderTarget(this.intermediateRenderTarget),e.render(this.shaderScene,this.shaderCamera),this.shaderRenderTarget.texture=this.intermediateRenderTarget.texture,e.setRenderTarget(i),this.texture.matrixAutoUpdate=!1,this.texture.matrix=t.matrix;let a=e.properties.get(t);a.__webglTexture=e.properties.get(this.texture).__webglTexture,a.__webglInit=!0}dispose(){this.shaderRenderTarget.dispose()}}!function(e){e[e.Default=0]="Default",e[e.Attitude=1]="Attitude",e[e.AnchorOrigin=2]="AnchorOrigin"}(R||(R={})),function(e){e[e.None=0]="None",e[e.Poses=1]="Poses",e[e.CSS=2]="CSS"}(x||(x={})),function(e){e[e.Default=0]="Default",e[e.High=1]="High"}(M||(M={})),function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.Rear=2]="Rear"}(k||(k={}));class rO extends rA.i7d{set far(e){this.zFar=e}get far(){var e;return null!=(e=this.zFar)?e:100}set near(e){this.zNear=e}get near(){var e;return null!=(e=this.zNear)?e:.001}get profile(){return this._profile}set profile(e){this._profile=e,this.rearCameraSource instanceof rF&&(this.rearCameraSource.profile=e===M.High?I.HE.HIGH:I.HE.DEFAULT),this.userCameraSource instanceof rF&&(this.userCameraSource.profile=e===M.High?I.HE.HIGH:I.HE.DEFAULT)}constructor(e){super(),this.onCameraPoseUpdate=new g,this.poseMode=R.Default,this.rearCameraMirrorMode=x.None,this.userCameraMirrorMode=x.Poses,this._currentMirrorMode=x.None,this.isPerspectiveCamera=!0,this.cameraDirection=k.None,this.hasSetCSSScaleX=!1,this.renderWidth=0,this.renderHeight=0,this._profile=M.Default,this.pipeline=e instanceof r_?e:(null==e?void 0:e.pipeline)||rR(),this.rawPose=this.pipeline.cameraPoseDefault(),!e||e instanceof r_?(this.rearCameraSource=new rF(t2(),this.pipeline),this.userCameraSource=new rF(t2(!0),this.pipeline),this.backgroundTexture=new rz):(this.zNear=e.zNear?e.zNear:.01,this.zFar=e.zFar?e.zFar:100,this.rearCameraSource=this.cameraSourceFromOpts(e.rearCameraSource),this.userCameraSource=this.cameraSourceFromOpts(e.userCameraSource,!0),this.backgroundTexture=e.backgroundTexture?e.backgroundTexture:new rz),this.matrixAutoUpdate=!1,document.addEventListener("visibilitychange",()=>{"visible"===document.visibilityState?this.resume():this.pause()})}cameraSourceFromOpts(e,t=!1){return e instanceof Element?new ro(this.pipeline,e):new rF(e||t2(t),this.pipeline)}pause(){this.userCameraSource.pause(),this.rearCameraSource.pause()}resume(){switch(this.cameraDirection){case k.User:this.userCameraSource.start();break;case k.Rear:this.rearCameraSource.start()}}start(e){this.cameraDirection=e?k.User:k.Rear,this.resume()}stop(){this.cameraDirection=k.None,this.pause()}setPoseModeAnchorOrigin(e){this.poseAnchorOrigin=e,this.poseMode=R.AnchorOrigin}get currentMirrorMode(){return this._currentMirrorMode}handleColorSpace(e){let t=!1;(null==e?void 0:e.outputColorSpace)&&(null==rT?void 0:rA.er$)&&(t=(null==e?void 0:e.outputColorSpace)===(null==rT?void 0:rA.er$)),t?this.inlineDecoder||(this.inlineDecoder=new rB(this.backgroundTexture)):this.backgroundTexture.colorSpace=e.outputColorSpace}updateFrame(e){this.pipeline.processGL(),this.pipeline.frameUpdate(),this._currentMirrorMode=this.pipeline.cameraFrameUserFacing()?this.userCameraMirrorMode:this.rearCameraMirrorMode;let{domElement:t}=e;switch(this.currentMirrorMode!==x.CSS&&this.hasSetCSSScaleX?(t.style.transform="",this.hasSetCSSScaleX=!1):this.currentMirrorMode===x.CSS&&!this.hasSetCSSScaleX&&(t.style.transform="scaleX(-1)",this.hasSetCSSScaleX=!0),this.renderWidth=e.domElement.width,this.renderHeight=e.domElement.height,this._updateProjectionMatrix(),this.poseMode){case R.Default:this.rawPose=this.pipeline.cameraPoseDefault();break;case R.Attitude:this.rawPose=this.pipeline.cameraPoseWithAttitude(this.currentMirrorMode===x.Poses);break;case R.AnchorOrigin:this.rawPose=this.poseAnchorOrigin?this.getOriginPose():this.pipeline.cameraPoseDefault();break;default:this.rawPose=this.pipeline.cameraPoseDefault()}this.matrixWorldNeedsUpdate=!0,this.backgroundTexture.MirrorMode=this.currentMirrorMode,this.backgroundTexture.updateFromPipeline(e,this.pipeline),this.handleColorSpace(e),this.onCameraPoseUpdate.emit()}_updateProjectionMatrix(){let e=this.pipeline.projectionMatrix(this.renderWidth,this.renderHeight,this.zNear,this.zFar);this.projectionMatrix.fromArray(e),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}updateMatrixWorld(e){this.matrix.fromArray(this.rawPose),this.matrix.decompose(this.position,this.quaternion,this.scale),super.updateMatrixWorld(e)}getOriginPose(){return this.poseAnchorOrigin?this.pipeline.cameraPoseWithOrigin(this.poseAnchorOrigin.poseCameraRelative(this.currentMirrorMode===x.Poses)):this.pipeline.cameraPoseDefault()}dispose(){this.rearCameraSource.destroy(),this.userCameraSource.destroy()}}class rN extends rA.YJl{constructor(e,t,r){super(),this.camera=e,this.imageTracker=t,this.anchorId=r,this.isReady=!1,this.matrixAutoUpdate=!1}updateMatrixWorld(e){this.currentAnchor&&this.imageTracker.visible.has(this.currentAnchor)||(this.anchorId?this.currentAnchor=this.imageTracker.anchors.get(this.anchorId):this.currentAnchor=this.imageTracker.visible.values().next().value),this.currentAnchor&&(this.matrix.fromArray(this.currentAnchor.pose(this.camera.rawPose,this.camera.currentMirrorMode===x.Poses)),this.matrix.decompose(this.position,this.quaternion,this.scale)),super.updateMatrixWorld(e)}}class rV extends rA.aHM{load(e,t,r,i){if("function"==typeof t&&(!r||0!==r.length)){let r=new rx;this.manager.itemStart(e),r.loadTarget(e).then(()=>{t(r),this.manager.itemEnd(e)}).catch(t=>{i&&i(t),this.manager.itemError(e),this.manager.itemEnd(e)});return}{let r=new rx;return this.manager.itemStart(e),r.loadTarget(e).then(()=>{t&&t(r),this.manager.itemEnd(e)}).catch(t=>{i&&i(t),this.manager.itemError(e),this.manager.itemEnd(e)}),r}}parse(){}}class rG extends rA.YJl{constructor(e,t){super(),this.camera=e,this.instantTracker=t,this.matrixAutoUpdate=!1}setAnchorPoseFromCameraOffset(e,t,r,i){this.instantTracker.setAnchorPoseFromCameraOffset(e,t,r,i)}updateMatrixWorld(e){this.matrix.fromArray(this.instantTracker.anchor.pose(this.camera.rawPose,this.camera.currentMirrorMode===x.Poses)),this.matrix.decompose(this.position,this.quaternion,this.scale),super.updateMatrixWorld(e)}}class rW extends rA.YJl{constructor(e,t,r){super(),this.camera=e,this.faceTracker=t,this.anchorId=r,this.isReady=!1,this.matrixAutoUpdate=!1}updateMatrixWorld(e){this.currentAnchor&&this.faceTracker.visible.has(this.currentAnchor)||(this.anchorId?this.currentAnchor=this.faceTracker.anchors.get(this.anchorId):this.currentAnchor=this.faceTracker.visible.values().next().value),this.currentAnchor&&(this.matrix.fromArray(this.currentAnchor.pose(this.camera.rawPose,this.camera.currentMirrorMode===x.Poses)),this.matrix.decompose(this.position,this.quaternion,this.scale)),super.updateMatrixWorld(e)}}class rq extends rA.YJl{constructor(e,t,r){super(),this.camera=e,this.faceTracker=t,this.pose=z.vt(),this.landmark=new rc(r),this.matrixAutoUpdate=!1}updateMatrixWorld(e){this.currentAnchor&&this.faceTracker.visible.has(this.currentAnchor)||(this.currentAnchor=this.faceTracker.visible.values().next().value),this.currentAnchor&&(this.landmark.updateFromFaceAnchor(this.currentAnchor,this.camera.currentMirrorMode===x.Poses),z.lw(this.pose,this.currentAnchor.pose(this.camera.rawPose,this.camera.currentMirrorMode===x.Poses),this.landmark.pose),this.matrix.fromArray(this.pose),this.matrix.decompose(this.position,this.quaternion,this.scale)),super.updateMatrixWorld(e)}dispose(){this.landmark.destroy()}}class rH extends rA.aHM{load(e,t,r,i){if("string"==typeof e&&"function"==typeof t&&(!r||0!==r.length)){let r=new rk;this.manager.itemStart(e),r.loadModel(e).then(()=>{t(r),this.manager.itemEnd(e)}).catch(t=>{i&&i(t),this.manager.itemError(e),this.manager.itemEnd(e)});return}{let r=new rk,a=e?r.loadModel(e):r.loadDefaultModel(),s="string"==typeof e?e:"__zappar_threejs_face_tracker_default";return this.manager.itemStart(s),a.then(()=>{t&&t(r),this.manager.itemEnd(s)}).catch(e=>{i&&i(e),this.manager.itemError(s),this.manager.itemEnd(s)}),r}}parse(){}}class rj extends rA.aHM{load(e,t,r,i){if("string"==typeof e&&"function"==typeof t&&(!r||0!==r.length)){let r=new rs,a=`__zappar_threejs_face_mesh_${e}`;this.manager.itemStart(a),r.load(e).then(()=>{t(r),this.manager.itemEnd(a)}).catch(e=>{i&&i(e),this.manager.itemError(a),this.manager.itemEnd(a)});return}{let r=new rs,a=`__zappar_threejs_face_mesh_${JSON.stringify(e||"default")}`;return this.manager.itemStart(a),(e?"string"==typeof e?r.load(e):e.customModel?r.load(e.customModel,e.fillMouth,e.fillEyeLeft,e.fillEyeRight,e.fillNeck):r.loadDefaultFace(e.fillMouth,e.fillEyeLeft,e.fillEyeRight):r.loadDefaultFace()).then(()=>{t&&t(r),this.manager.itemEnd(a)}).catch(e=>{i&&i(e),this.manager.itemError(a),this.manager.itemEnd(a)}),r}}loadFace(e,t,r,i){let a=new rs,s=`__zappar_threejs_face_mesh_face_${JSON.stringify(e||"default")}`;return(e?e.customModel?a.load(e.customModel,e.fillMouth,e.fillEyeLeft,e.fillEyeRight,e.fillNeck):a.loadDefaultFace(e.fillMouth,e.fillEyeLeft,e.fillEyeRight):a.loadDefaultFace()).then(()=>{t&&t(a),this.manager.itemEnd(s)}).catch(e=>{i&&i(e),this.manager.itemError(s),this.manager.itemEnd(s)}),a}loadFullHeadSimplified(e,t,r,i){let a=new rs,s=`__zappar_threejs_face_mesh_full_head_${JSON.stringify(e||"default")}`;return(e?e.customModel?a.load(e.customModel,e.fillMouth,e.fillEyeLeft,e.fillEyeRight,e.fillNeck):a.loadDefaultFullHeadSimplified(e.fillMouth,e.fillEyeLeft,e.fillEyeRight,e.fillNeck):a.loadDefaultFullHeadSimplified()).then(()=>{t&&t(a),this.manager.itemEnd(s)}).catch(e=>{i&&i(e),this.manager.itemError(s),this.manager.itemEnd(s)}),a}parse(){}}class rY extends rA.LoY{constructor(e){super(),this.hasSetIndices=!1,this.hasSetUVs=!1,this.recalculateNormals=!0,this.setIndex([]),this.setAttribute("position",new rA.qtW([],3)),this.setAttribute("normal",new rA.qtW([],3)),this.setAttribute("uv",new rA.qtW([],2)),e||(f||(f=new rj().load()),e=f),this._faceMesh=e}_updateIndices(){this.hasSetIndices||0!==this._faceMesh.indices.length&&(this.setIndex(new rA.A$4(this._faceMesh.indices,1)),this.hasSetIndices=!0)}_updateUVs(){this.hasSetUVs||0!==this._faceMesh.uvs.length&&(this.setAttribute("uv",new rA.THS(this._faceMesh.uvs,2)),this.hasSetUVs=!0)}get calculateNormals(){return this.recalculateNormals}set calculateNormals(e){this.recalculateNormals=e,this.recalculateNormals||("function"==typeof this.removeAttribute&&this.removeAttribute("normal"),delete this.normals)}updateFromFaceAnchorGroup(e){0!==this._faceMesh.vertices.length&&e.currentAnchor&&this.updateFromFaceAnchor(e.currentAnchor)}updateFromFaceAnchor(e){this.updateFromIdentityExpression(e.identity,e.expression)}updateFromIdentityExpression(e,t){0!==this._faceMesh.vertices.length&&(this._updateIndices(),this._updateUVs(),this._faceMesh.updateFromIdentityExpression(e,t),this.vertices||(this.vertices=new Float32Array(this._faceMesh.vertices.length),this.verticesAttribute=new rA.THS(this.vertices,3),this.setAttribute("position",this.verticesAttribute)),this.vertices.set(this._faceMesh.vertices),this.verticesAttribute&&(this.verticesAttribute.needsUpdate=!0),this.computeBoundingSphere(),this.calculateNormals&&(this.normals||(this.normals=new Float32Array(this._faceMesh.normals.length),this.normalsAttribute=new rA.THS(this.normals,3),this.setAttribute("normal",this.normalsAttribute)),this.normals.set(this._faceMesh.normals),this.normalsAttribute&&(this.normalsAttribute.needsUpdate=!0)))}}class rX extends rA.eaF{constructor(e,t){super(),this.onLoad=e,this.onError=t,this.faceMesh=new rs,this.faceBufferGeometry=new rY(this.faceMesh),this.geometry=this.faceBufferGeometry,this.material=new rA.V9B({colorWrite:!1}),this.faceMesh.loadDefaultFullHeadSimplified(!0,!0,!0,!0).then(()=>{var e;return null==(e=this.onLoad)?void 0:e.call(this)}).catch(()=>{var e;return null==(e=this.onError)?void 0:e.call(this)}),this.renderOrder=Number.MIN_SAFE_INTEGER}updateFromFaceAnchorGroup(e){this.faceBufferGeometry.updateFromFaceAnchorGroup(e)}updateFromFaceAnchor(e){this.faceBufferGeometry.updateFromFaceAnchor(e)}updateFromIdentityExpression(e,t){this.faceBufferGeometry.updateFromIdentityExpression(e,t)}dispose(){this.faceMesh.destroy(),this.faceBufferGeometry.dispose()}}let rZ="__zappar_threejs_head_mask_mesh";class r$ extends rA.aHM{load(e,t,r,i){if("string"!=typeof e)return this.manager.itemStart(rZ),new rX(()=>{e&&e(),this.manager.itemEnd(rZ)},()=>{r&&r(),this.manager.itemError(rZ),this.manager.itemEnd(rZ)});this.manager.itemStart(rZ),t(new rX(()=>{this.manager.itemEnd(rZ)},()=>{i&&i(Error("Failed to create HeadMaskMesh")),this.manager.itemError(rZ),this.manager.itemEnd(rZ)}))}parse(){}}let rK="__zappar_threejs_library";class rQ extends rA.aHM{load(e,t,r,i){let a,s,n="string"==typeof e;n?(a=t,s=i):(a=e,s=r),this.manager.itemStart(rK),t6().then(()=>{a&&(n?a(void 0):a()),this.manager.itemEnd(rK)}).catch(e=>{s&&(n?s(e):s()),this.manager.itemError(rK),this.manager.itemEnd(rK)})}parse(){}}class rJ{constructor(e){this.lastLoadPercentage=0,this.divs={inner:document.createElement("div"),title:document.createElement("div"),progress:document.createElement("div"),progressValue:document.createElement("div")},this.css={container:{position:"fixed",width:"100%",height:"100%",top:"0px",left:"0px",zIndex:"10000",backgroundColor:"rgba(0,0,0,0.8)",fontFamily:"sans-serif",color:"rgba(255,255,255,1)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",transition:"opacity 500ms"},inner:{maxWidth:"400px",textAlign:"center"},title:{fontSize:"20px"},progress:{background:"rgba(255,255,255, 0.1)",justifyContent:"flex-start",borderRadius:"100px",alignItems:"center",position:"relative",padding:"0 5px",display:"flex",height:"15px",width:"250px",margin:"15px"},progressValue:{boxShadow:"0 10px 40px -10px #fff",borderTopLeftRadius:"100px",borderBottomLeftRadius:"100px",background:"rgba(255,255,255,1)",height:"10px",width:"0",transition:"width 500ms"}},this.updateLoader=e=>{if(e<this.lastLoadPercentage)return;this.lastLoadPercentage=e;let t=document.getElementById("zappar-loader-progressValue");t.style.width=`${e}%`,t.style.borderTopRightRadius=`${e}px`,t.style.borderBottomRightRadius=`${e}px`,t.addEventListener("transitionend",()=>{100===e&&(this.containerDiv.style.opacity="0",this.containerDiv.addEventListener("transitionend",e=>{"opacity"===e.propertyName&&this.dispose()}))})},this.dispose=()=>{this.containerDiv.remove()},this.customStyle=e,this.containerDiv=document.createElement("div")}initialize(){for(let e in this.divs)this.divs[e].id=`zappar-loader-${e}`;this.refreshStyle(),this.divs.inner.appendChild(this.divs.title),this.divs.inner.appendChild(this.divs.progress),this.divs.progress.appendChild(this.divs.progressValue),this.containerDiv.appendChild(this.divs.inner),this.divs.title.innerHTML="Loading...",document.body.append(this.containerDiv)}refreshStyle(){var e,t,r,i,a,s,n,o,l,_,c;Object.assign(null!=(t=null==(e=this===null||void 0===this?void 0:this.css)?void 0:e.container)?t:{},null==(r=this.customStyle)?void 0:r.container),Object.assign(null!=(i=this.css.inner)?i:{},null==(a=this.customStyle)?void 0:a.inner),Object.assign(null!=(s=this.css.title)?s:{},null==(n=this.customStyle)?void 0:n.title),Object.assign(null!=(o=this.css.progress)?o:{},null==(l=this.customStyle)?void 0:l.progress),Object.assign(null!=(_=this.css.progressValue)?_:{},null==(c=this.customStyle)?void 0:c.progressValue),Object.assign(this.containerDiv.style,this.css.container),Object.assign(this.divs.inner.style,this.css.inner),Object.assign(this.divs.title.style,this.css.title),Object.assign(this.divs.progress.style,this.css.progress),Object.assign(this.divs.progressValue.style,this.css.progressValue)}}class r0 extends rJ{constructor(e){super(null==e?void 0:e.style),rA.h_9.onStart=()=>{this.initialize()},rA.h_9.onLoad=()=>{var t;null==(t=null==e?void 0:e.onLoad)||t.call(e)},rA.h_9.onProgress=(e,t,r)=>{this.updateLoader(t/r*100)}}}class r1 extends rA.KPJ{constructor(e){super(()=>{var t;return null==(t=null==e?void 0:e.onLoad)?void 0:t.call(e)},(t,r,i)=>{var a;this.ui.customStyle=null==e?void 0:e.style,this.ui.refreshStyle(),null==(a=null==e?void 0:e.onProgress)||a.call(e,t,r,i),this.ui.updateLoader(r/i*100)},null==e?void 0:e.onError),this.ui=new rJ,this.onStartCallback=void 0,this.onStart=()=>{this.ui.initialize(),this.onStartCallback&&this.onStartCallback()},this._onStart=e=>{this.onStartCallback=e},this.dispose=()=>{this.ui.dispose()},new rQ(this).load()}}class r4{constructor(){this.cubeMapScene=new rA.Z58,this.renderTarget=new rA.o6l(256,{format:rA.GWd,generateMipmaps:!0,minFilter:rA.$_I}),this.cubeCamera=new rA.F1T(.1,1e3,this.renderTarget),this.sphereMaterial=new rA.V9B({side:rA.$EB}),this.sphereGroup=new rA.YJl,this.environmentMap=this.renderTarget.texture,this.cubeMapScene.add(this.cubeCamera);let e=new rA.eaF(new rA.Gu$(10,16,12),this.sphereMaterial);e.rotation.set(0,-.5*Math.PI,0),this.sphereGroup.add(e),this.cubeMapScene.add(this.sphereGroup)}dispose(){this.renderTarget.dispose(),this.sphereMaterial.dispose()}update(e,t){152>parseInt(rA.sPf,10)?this.environmentMap.encoding=e.outputEncoding:this.environmentMap.colorSpace=e.outputColorSpace,this.sphereMaterial.map=t.backgroundTexture,this.sphereGroup.quaternion.copy(t.quaternion),this.cubeCamera.update(e,this.cubeMapScene)}}class r2 extends rA.LoY{constructor(e){if(super(),this.imageTarget=e,this.hasSetIndices=!1,this.hasSetUVs=!1,this.recalculateNormals=!0,0===this.imageTarget.preview.vertices.length)throw Error("No vertices found in the image target.");let t=this.imageTarget.preview.vertices.length/3;this.vertices=new Float32Array(3*t),this.vertices.set(this.imageTarget.preview.vertices),this.setAttribute("position",new rA.THS(this.vertices,3)),this.setAttribute("normal",new rA.qtW(3*t,3)),this._updateUVs(),this._updateIndices(),this.computeBoundingSphere(),this.computeVertexNormals(),this.attributes.position.needsUpdate=!0,this.attributes.normal.needsUpdate=!0,this.attributes.uv&&(this.attributes.uv.needsUpdate=!0)}_updateIndices(){var e;!this.hasSetIndices&&(null==(e=this.imageTarget)?void 0:e.preview.indices.length)>0&&(this.setIndex(new rA.A$4(this.imageTarget.preview.indices,1)),this.hasSetIndices=!0)}_updateUVs(){!this.hasSetUVs&&this.imageTarget.preview.uvs.length>0&&(this.setAttribute("uv",new rA.THS(new Float32Array(this.imageTarget.preview.uvs),2)),this.hasSetUVs=!0)}get calculateNormals(){return this.recalculateNormals}}class r3 extends rA.eaF{constructor(e,t){if(!t){let r=new rA.Tap().load(e.image.src);r.colorSpace=rA.er$,t=new rA.V9B({map:r})}super(new r2(e),t)}}class r5 extends rA.YJl{constructor(e,t){super(),this.camera=e,this.worldTracker=t,this.status=I.uI.ANCHOR_STATUS_INITIALIZING,this.matrixAutoUpdate=!1}updatePose(){this.anchor&&(this.status=this.anchor.status,this.matrix.fromArray(this.anchor.pose(this.camera.rawPose,this.camera.currentMirrorMode===x.Poses)),this.matrix.decompose(this.position,this.quaternion,this.scale))}updateMatrixWorld(e){switch(this.updatePose(),!this.anchor&&this.status!==I.uI.ANCHOR_STATUS_INITIALIZING&&(this.status=I.uI.ANCHOR_STATUS_STOPPED),this.status){case I.uI.ANCHOR_STATUS_PAUSED:case I.uI.ANCHOR_STATUS_STOPPED:case I.uI.ANCHOR_STATUS_TRACKING:break;default:console.warn(`Unknown anchor status: ${this.status}`)}super.updateMatrixWorld(e)}dispose(){this.worldTracker.destroy()}}class r7 extends r5{constructor(e,t){super(e,t),this.anchor=t.groundAnchor}}let r6=new rA.RlV,r8=new rA.Pq0(0,1,0),r9=new rA.Zcv(r8),ie=new rA.kn4,it=new rA.Pq0(0,0,0),ir=new rA.Pq0(0,1,0),ii=new rA.Pq0(0,0,0);class ia extends rA.YJl{constructor(e){super(),this.camera=e,this.faceCamera=!0,this.placementMode=!1,this.normalizeScale=!1}update(){this.placementMode&&this.groundPlaneIntersection()}groundPlaneIntersection(){if(this.parent){if((r8.set(0,1,0),r9.set(r8,0),r9.applyMatrix4(this.parent.matrixWorld),this.camera.updateMatrixWorld(),r6.origin.set(0,0,0),r6.direction.set(0,0,-1),r6.applyMatrix4(this.camera.matrixWorld),r6.intersectPlane(r9,it))&&(ie.copy(this.parent.matrixWorld),ie.invert(),it.applyMatrix4(ie),!(Number.isNaN(it.x)||Number.isNaN(it.y)||Number.isNaN(it.z)))){if(this.faceCamera&&(this.camera.getWorldPosition(ii),this.rotation.y=Math.atan2(ii.x-it.x,ii.z-it.z),this.position.copy(it)),this.normalizeScale){ie.multiply(this.camera.matrixWorld),ir.set(ie.elements[12],ie.elements[13],ie.elements[14]);let e=r9.distanceToPoint(ir);e>0&&this.scale.set(e,e,e)}this.updateMatrix(),this.matrixWorldNeedsUpdate=!0,this.updateMatrixWorld(!0)}}}}class is extends rA.YJl{constructor(e,t,r){super(),this.camera=e,this.worldTracker=t,this.material=r,this.onIntersect=new v,this.onIntersectEnd=new v,this._previousIntersections=new Set,this._currentIntersections=new Map,this._geometries=new Map,this._update=()=>{var e;let t=this.worldTracker?[...this.worldTracker.planes.values()]:[],r=new Set;for(let i of t){if(i.status!==I.uI.ANCHOR_STATUS_TRACKING)continue;r.add(i.id);let t=this._geometries.get(i.id);if(!t){let r=new rA.LoY,a=this.material instanceof rA.imn?this.material:new rA.V9B(Object.assign({side:rA.$EB,vertexColors:!0,transparent:!0,opacity:.2},null!=(e=this.material)?e:{}));t={polygonVersion:-1,geometry:r,mesh:new rA.eaF(r,a),anchorId:i.id},this.add(t.mesh),this._geometries.set(i.id,t)}if(t.mesh.matrix.fromArray(i.pose(this.camera.rawPose,this.camera.currentMirrorMode===x.Poses)),t.mesh.matrix.decompose(t.mesh.position,t.mesh.quaternion,t.mesh.scale),t.polygonVersion===i.polygonVersion)continue;t.polygonVersion=i.polygonVersion;let a=function(e,t){var r;let i=t.length/2,a=1+i*(e.fade?2:1),s=new Float32Array(12*a),n={numberVertices:a,vertexBuffer:s,indexBuffer:new Uint16Array(i*(e.fade?3:1)*3),stride:12,normalOffset:3,uvOffset:6,colorOffset:8};return function(e,t){var r;let i=t.length/2,a=[0,0];for(let e=0;e<i;e+=2)a[0]+=t[e],a[1]+=t[e+1];a[0]/=i,a[1]/=i,e.vertexBuffer[0]=a[0],e.vertexBuffer[1]=0,e.vertexBuffer[2]=a[1],e.vertexBuffer[3]=0,e.vertexBuffer[4]=1,e.vertexBuffer[5]=0;let s=(r=a[0],[r,-a[1]]);e.vertexBuffer[6]=s[0],e.vertexBuffer[7]=s[1],e.vertexBuffer[8]=1,e.vertexBuffer[9]=1,e.vertexBuffer[10]=1,e.vertexBuffer[11]=1;for(let r=0;r<i;r++){let i=[t[2*r+0],t[2*r+1]];e.vertexBuffer[e.stride*(r+1)+0]=i[0],e.vertexBuffer[e.stride*(r+1)+1]=0,e.vertexBuffer[e.stride*(r+1)+2]=i[1],e.vertexBuffer[e.stride*(r+1)+3]=0,e.vertexBuffer[e.stride*(r+1)+4]=1,e.vertexBuffer[e.stride*(r+1)+5]=0;let a=[i[0],-i[1]];e.vertexBuffer[e.stride*(r+1)+6]=a[0],e.vertexBuffer[e.stride*(r+1)+7]=a[1],e.vertexBuffer[e.stride*(r+1)+8]=1,e.vertexBuffer[e.stride*(r+1)+9]=1,e.vertexBuffer[e.stride*(r+1)+10]=1,e.vertexBuffer[e.stride*(r+1)+11]=1}}(n,t),function(e,t,r){let i=r.length/2,a=0;for(let r=0;r<i;r++)e.indexBuffer[a]=0,a++,e.indexBuffer[a]=r+1,a++,e.indexBuffer[a]=r+2,a++,t&&(e.indexBuffer[a]=r+1,a++,e.indexBuffer[a]=r+i+1,a++,e.indexBuffer[a]=r+i+2,a++,e.indexBuffer[a]=r+1,a++,e.indexBuffer[a]=r+i+2,a++,e.indexBuffer[a]=r+2,a++);t?(a=9*(i-1),e.indexBuffer[a+2]=1,e.indexBuffer[a+5]=i+1,e.indexBuffer[a+7]=i+1,e.indexBuffer[a+8]=1):(a=3*(i-1),e.indexBuffer[a+2]=1)}(n,null!=(r=e.fade)&&r,t),n}({fade:!1},i.polygon),s=new rA.eB$(a.vertexBuffer,a.stride);t.geometry.setAttribute("position",new rA.eHs(s,3,0)),t.geometry.setAttribute("normal",new rA.eHs(s,3,a.normalOffset)),t.geometry.setAttribute("uv",new rA.eHs(s,2,a.uvOffset)),t.geometry.setAttribute("color",new rA.eHs(s,4,a.colorOffset)),t.geometry.setIndex(new rA.THS(a.indexBuffer,1)),t.geometry.computeBoundingSphere(),t.geometry.computeBoundingBox()}for(let[e,t]of this._geometries.entries())r.has(e)||(t.mesh.removeFromParent(),t.geometry.dispose(),this._geometries.delete(e))},t._pipeline.onFrameUpdate.bind(this._update)}intersect(e){let t=[];for(let r of(this._currentIntersections.clear(),this._geometries.values())){r.mesh.updateWorldMatrix(!0,!1);let i=e.intersectObject(r.mesh);i.length>0&&(t.push({anchorId:r.anchorId,intersection:i[0]}),this._currentIntersections.set(r.anchorId,i[0]))}for(let[e,t]of this._currentIntersections.entries())this._previousIntersections.has(e)||this.onIntersect.emit({anchorId:e,intersection:t});for(let e of this._previousIntersections)this._currentIntersections.has(e)||this.onIntersectEnd.emit({anchorId:e});for(let e of(this._previousIntersections.clear(),this._currentIntersections.keys()))this._previousIntersections.add(e);return t.sort((e,t)=>e.intersection.distance-t.intersection.distance),t}}let io=new rA.tBo,il=new rA.Pq0,i_=new rA.kn4,ic=new rA.Zcv,id=`
<button class="zappar-three-place-ui-button">
	<div id="zappar-three-place-ui-button-icon">
		<svg xmlns="http://www.w3.org/2000/svg" height="30px" viewBox="0 -960 960 960" width="30px" fill="#ffffff"><path d="M379.33-244 154-469.33 201.67-517l177.66 177.67 378.34-378.34L805.33-670l-426 426Z"/></svg>
	</div>
	<div class="zappar-three-place-ui-button-text"></div>
</button>
`,ih=`
<button class="zappar-three-place-ui-button">
	<div id="zappar-three-place-ui-button-icon">
	<svg xmlns="http://www.w3.org/2000/svg" height="30px" viewBox="0 -960 960 960" width="30px" fill="#ffffff"><path d="M440-280q-7 0-12-4t-7-10q-14-42-34-70t-40-54q-20-26-33.5-54T300-540q0-58 41-99t99-41q58 0 99 41t41 99q0 40-13.5 68T533-418q-20 26-40 54t-34 70q-2 6-7 10t-12 4Zm0-112q9-14 18-26t17-23q23-30 34-50t11-49q0-33-23.5-56.5T440-620q-33 0-56.5 23.5T360-540q0 29 11 49t34 50q8 11 17 23t18 26Zm0-98q21 0 35.5-14.5T490-540q0-21-14.5-35.5T440-590q-21 0-35.5 14.5T390-540q0 21 14.5 35.5T440-490Zm2 372.67q-151.33 0-257-105.67Q79.33-328.67 79.33-480q0-75.67 28.5-141.5t77.67-115q49.17-49.17 115-77.67t141.5-28.5q75.67 0 141.5 28.5t115 77.67q49.17 49.17 77.67 115t28.5 141.5v14.67L869-530l47 46.67-144.67 144.66-144.66-144.66 47-46.67L738-465.67V-480q0-122-87-209t-209-87q-122 0-209 87t-87 209q.33 122 87.17 209Q320-184 442-184q57 0 109.33-21.5Q603.67-227 643-264l47.67 47.67q-48.34 46-113.17 72.5T442-117.33ZM440-540Z"/></svg>
	</div>
	<div class="zappar-three-place-ui-button-text"></div>
</button>
`,iu=`

#overlay {
    position: fixed;
    top: 0;
    left: 0;
    pointer-events: none;
    overflow: hidden;
    z-index: 1000000;
    width: 100%;
    height: 100%;
}

#overlay > * {
    pointer-events: auto;
    position: absolute;
}

.zappar-three-place-ui {
	position: absolute;
	pointer-events: none;
	display: flex;
	flex-direction: column;
	padding: 40px;
	box-sizing: border-box;
}

.zappar-three-place-ui-button {
	outline: none;
	background-color: #555;
	border-radius: 40px;
	font-family: sans-serif;
	color: white;
	font-size: 16px;
	border: none;
	min-width: 60px;
	height: 60px;
	display: flex;
    align-items: center;
    padding-left: 15px;
    padding-right: 15px;
    justify-content: center;
}

.zappar-three-place-ui-button:disabled {
	opacity: 0.1;
}

.zappar-three-place-ui-button-text {
	padding-left: 7px;
	padding-right: 7px;
}

.zappar-three-place-ui-horizontal-left {
	align-items: flex-start;
}

.zappar-three-place-ui-horizontal-right {
	align-items: flex-end;
}

.zappar-three-place-ui-horizontal-center {
	align-items: center;
}

.zappar-three-place-ui-vertical-top {
	top: 0px;
}

.zappar-three-place-ui-vertical-bottom {
	bottom: 0px;
}

.zappar-three-place-ui-vertical-center {
	top: 50%;
	margin-top: -30px;
}`,im=!1,ip=document.createElement("div");ip.id="overlay";class ig extends rA.YJl{get placementMode(){return this._placementMode}set placementMode(e){e!==this._placementMode&&(this._placementMode=e,this.worldTracker.enabled&&(e?this.onPlacementStart.emit():this.onPlacementEnd.emit()))}set placeUIClassList(e){this._placeUIClassList=e,this.updateUI()}get placeUIClassList(){return this._placeUIClassList}set enabled(e){this.worldTracker.enabled=e}get enabled(){return this.worldTracker.enabled}constructor(e,t,r,i){var a;super(),this.camera=e,this.worldTracker=t,this.renderer=r,this._placementMode=!1,this._placeUIClassList=["zappar-three-place-ui"],this.ready=!1,this.startInPlacementMode=!1,this.placeOnPlanes=!0,this.placeOnGround=!1,this.visualizePlanesDuringPlacement=!0,this.showContentDuringPlacement=!0,this.showPlaceButton=!0,this.showPlaceButtonIcon=!0,this.placeButtonText="",this.showRestartPlacementButton=!0,this.showRestartPlacementButtonIcon=!0,this.restartPlacementButtonText="",this.longPressToMove="none",this.showLongPressInstructionOnPlace=!1,this.longPressInstruction="Tap and hold to move",this.placeButtonHorizontalAlignment="center",this.placeButtonVerticalAlignment="bottom",this.restartPlacementButtonHorizontalAlignment="left",this.restartPlacementButtonVerticalAlignment="bottom",this.fingerHeld=!1,this.hasFirstPlaced=!1,this.placementValid=!1,this.contentGroup=new rA.YJl,this.onPlacementStart=new g,this.onPlacementEnd=new g,this.onPlaneIntersect=new v,this.onPlaneIntersectEnd=new v,this.onQuality=new v,this.handleTouchStart=e=>{let t=this.renderer.domElement;if("none"===this.longPressToMove)return;let r=!1;if(setTimeout(()=>{r||("hold"===this.longPressToMove&&(this.fingerHeld=!0),this.placementMode=!0,this.updateUI())},1e3),"hold"===this.longPressToMove){let e=()=>{r=!0,this.fingerHeld=!1,this.placementMode=!1,this.updateUI(),t.removeEventListener("touchend",e)};t.addEventListener("touchend",e)}},this.handleTouchEnd=()=>{"hold"===this.longPressToMove&&(this.fingerHeld=!1,this.placementMode=!1,this.updateUI())},this.onFrameUpdate=()=>{var e,t,r,i;let a;if(!(!this.worldTracker.enabled||1>this.camera.pipeline.frameNumber())){if(this.updateReadyStatus(),this.planes.visible=this.visualizePlanesDuringPlacement&&this.placementMode,!this.worldTracker||(null==(e=this.customAnchor)?void 0:e.status)===I.uI.ANCHOR_STATUS_STOPPED){null==(t=this.customAnchor)||t.destroy(),this.placementValid=!1,delete this.customAnchor,this.updateUI();return}if(this.worldTracker&&this.worldTracker.quality===I.DN.WORLD_TRACKER_QUALITY_GOOD){if(!this.customAnchor){if(this.startInPlacementMode)this.placementMode=!0;else for(let e of this.worldTracker.planes.values())if(e.firstPlane){this.customAnchor=new ru(this.worldTracker),this.anchor=this.customAnchor,this.placementMode=!1,this.customAnchor.setPoseFromAnchorOffset(e,0,0,0,I.zn.Z_TOWARDS_CAMERA),this.contentGroup.visible=!0,this.handleFirstPlaced(),this.updateUI();return}}if(!this.placementMode){this.anchor&&(this.contentGroup.matrix.fromArray(this.anchor.pose(this.camera.rawPose,this.camera.currentMirrorMode===x.Poses)),this.contentGroup.matrix.decompose(this.contentGroup.position,this.contentGroup.quaternion,this.contentGroup.scale),this.contentGroup.updateMatrixWorld(),this.placementValid=!0,this.contentGroup.visible=!0),this.updateUI();return}if(this.customAnchor||(this.customAnchor=new ru(this.worldTracker),this.anchor=this.customAnchor,this.contentGroup.visible=!0),io.setFromCamera(new rA.I9Y(0,-.3),this.camera),this.placeOnPlanes){let e=this.planes.intersect(io);if(e.length>0){let t=new rA.Pq0;t.copy(e[0].intersection.point),e[0].intersection.object.worldToLocal(t),a=[e[0].anchorId,e[0].intersection.point,t,e[0].intersection.distance]}}if(!a&&this.placeOnGround&&(null==(i=null==(r=this.worldTracker)?void 0:r.groundAnchor)?void 0:i.status)!==0){i_.fromArray(this.worldTracker.groundAnchor.pose(this.camera.rawPose,this.camera.currentMirrorMode===x.Poses)),il.set(0,1,0),ic.set(il,0),ic.applyMatrix4(i_);let e=io.ray.distanceToPlane(ic);if(null!==e&&(!a||a[3]>e)){let t=new rA.Pq0;if(io.ray.intersectPlane(ic,t)){let r=new rA.Pq0;i_.invert(),r.copy(t),r.applyMatrix4(i_),a=[this.worldTracker.groundAnchor.id,t,r,e]}}}a?(this.placementValid=!0,this.contentGroup.visible=this.showContentDuringPlacement,this.customAnchor.setPoseFromAnchorOffset(a[0],a[2].x,a[2].y,a[2].z,I.zn.Z_TOWARDS_CAMERA),this.contentGroup.matrix.fromArray(this.customAnchor.pose(this.camera.rawPose,this.camera.currentMirrorMode===x.Poses)),this.contentGroup.matrix.decompose(this.contentGroup.position,this.contentGroup.quaternion,this.contentGroup.scale),this.contentGroup.updateMatrixWorld()):(this.placementValid=!1,this.contentGroup.visible=!1),this.updateUI()}}},this.updateReadyStatus=()=>{this.ready=this.isReady()},function(){if(im)return;let e=document.createElement("link");e.setAttribute("rel","stylesheet"),e.href=`data:text/css,${encodeURIComponent(iu)}`,document.head?document.head.appendChild(e):document.body&&document.body.appendChild(e),im=!0}(),this.planes=new is(e,t,i),this.planes.onIntersect.bind(e=>{this.enabled&&this.onPlaneIntersect.emit(e)}),this.planes.onIntersectEnd.bind(e=>{this.enabled&&this.onPlaneIntersectEnd.emit(e)}),this.add(this.planes),e.onCameraPoseUpdate.bind(()=>{this.onFrameUpdate()}),null==(a=r.domElement.parentElement)||a.appendChild(ip),this.add(this.contentGroup),this.contentGroup.visible=!1,this.add=(...e)=>(this.contentGroup.add(...e),this),this.remove=(...e)=>(this.contentGroup.remove(...e),this),this.worldTracker.enabled&&this.onQuality.emit(t.quality),this.worldTracker.onQuality.bind(e=>{this.worldTracker.enabled&&this.onQuality.emit(e)}),this.setupTouchListeners()}setupTouchListeners(){let e=this.renderer.domElement;e.addEventListener("touchstart",this.handleTouchStart),e.addEventListener("touchend",this.handleTouchEnd)}handleFirstPlaced(){!this.hasFirstPlaced&&(this.hasFirstPlaced=!0,this.showLongPressInstructionOnPlace&&"none"!==this.longPressToMove&&this.showTextAlert(this.longPressInstruction))}updateUI(){let e=this.placementMode;e&&this.showPlaceButton&&!this.fingerHeld&&this.ready?this.updatePlaceButton():this.removePlaceButton(),!e&&this.showRestartPlacementButton&&this.ready?this.updateRestartPlacementButton():this.removeRestartPlacementButton()}updatePlaceButton(){var e;this.placeUI||(this.placeUI=document.createElement("div"),this.placeUI.innerHTML=id,this.placeButton=this.placeUI.querySelector(".zappar-three-place-ui-button"),ip.append(this.placeUI),null==(e=this.placeButton)||e.addEventListener("click",()=>{this.placementMode=!1})),this.placeUI.className=this.placeUIClassList.join(" ");let t=this.placeUI.querySelector("#zappar-three-place-ui-button-icon");t&&(t.style.display=this.showPlaceButtonIcon?"block":"none");let r=this.placeUI.querySelector(".zappar-three-place-ui-button-text");r&&(r.textContent=this.placeButtonText,r.style.display=this.placeButtonText?"block":"none"),this.setElementPosition(this.placeUI,this.placeButtonHorizontalAlignment,this.placeButtonVerticalAlignment),this.placeButton&&(this.placeButton.disabled=!this.placementValid)}updateRestartPlacementButton(){var e;this.restartPlacementUI||(this.restartPlacementUI=document.createElement("div"),this.restartPlacementUI.innerHTML=ih,this.restartPlacementButton=this.restartPlacementUI.querySelector(".zappar-three-place-ui-button"),ip.append(this.restartPlacementUI),null==(e=this.restartPlacementButton)||e.addEventListener("click",()=>{this.placementMode=!0})),this.restartPlacementUI.className=this.placeUIClassList.join(" ");let t=this.restartPlacementUI.querySelector("#zappar-three-place-ui-button-icon");t&&(t.style.display=this.showRestartPlacementButtonIcon?"block":"none");let r=this.restartPlacementUI.querySelector(".zappar-three-place-ui-button-text");r&&(r.textContent=this.restartPlacementButtonText,r.style.display=this.restartPlacementButtonText?"block":"none"),this.setElementPosition(this.restartPlacementUI,this.restartPlacementButtonHorizontalAlignment,this.restartPlacementButtonVerticalAlignment)}removePlaceButton(){this.placeUI&&(this.placeUI.remove(),this.placeUI=void 0,this.placeButton=void 0)}removeRestartPlacementButton(){this.restartPlacementUI&&(this.restartPlacementUI.remove(),this.restartPlacementUI=void 0,this.restartPlacementButton=void 0)}setElementPosition(e,t,r){switch(e.style.position="absolute",t){case"left":e.style.left="10px";break;case"right":e.style.right="10px";break;case"center":e.style.left="50%",e.style.transform="translateX(-50%)";break;default:console.error("Invalid horizontal alignment")}switch(r){case"top":e.style.top="10px";break;case"bottom":e.style.bottom="10px";break;case"center":e.style.top="50%",e.style.transform+=" translateY(-50%)";break;default:console.error("Invalid vertical alignment")}}isReady(){return!!this.worldTracker&&this.worldTracker.quality!==I.DN.WORLD_TRACKER_QUALITY_INITIALIZING&&(!!this.customAnchor||0!==this.worldTracker.planes.size)}showTextAlert(e){let t=document.createElement("div");t.textContent=e,t.style.position="absolute",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.backgroundColor="rgba(0, 0, 0, 0.7)",t.style.color="white",t.style.padding="10px",t.style.borderRadius="5px",ip.appendChild(t),setTimeout(()=>t.remove(),3e3)}dispose(){var e;null==(e=this.customAnchor)||e.destroy(),this.customAnchor=void 0,this.anchor=void 0,this.removePlaceButton(),this.removeRestartPlacementButton(),this.renderer.domElement.removeEventListener("touchstart",this.handleTouchStart),this.renderer.domElement.removeEventListener("touchend",this.handleTouchEnd)}}class iv extends rA.LoY{update(e){let t=e.length/2,r=new Float32Array(3*t);for(let i=0;i<t;i++)r[3*i+0]=e[2*i+0],r[3*i+1]=e[2*i+1],r[3*i+2]=0;this.setAttribute("position",new rA.THS(r,3))}}let ib=`

uniform mat4 pointsMatrix;
uniform float pointSize;

void main() {
  gl_PointSize = pointSize;
  gl_Position = pointsMatrix * vec4( position, 1.0 );
}
`,iy=`
uniform vec3 color;
uniform float opacity;

void main() {
	gl_FragColor = vec4( color, opacity );
}
`;class iw extends rA.ONl{set size(e){this._uniforms.pointSize.value=e}get size(){return this._uniforms.pointSize.value}set color(e){this._uniforms.color.value=e}get color(){return this._uniforms.color.value}set opacity(e){this._uniforms.opacity.value=e}get opacity(){return this._uniforms.opacity.value}constructor(e,t={}){super(new iv,new rA.BKk(Object.assign({depthTest:!1,depthWrite:!1,vertexShader:ib,fragmentShader:iy,blending:rA.EZo},t))),this.worldTracker=e,this._renderSize=new rA.I9Y,this._uniforms={color:{value:new rA.Q1f("white")},opacity:{value:.4},pointsMatrix:{value:new rA.kn4},pointSize:{value:5}},this.update=e=>{let t=e.getSize(this._renderSize);this._uniforms.pointsMatrix.value.fromArray(this.worldTracker.computePointsDataMatrix(t.x,t.y,!1)),this.geometry.update(this.worldTracker.tracksData)},this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!1,this.material.uniforms=this._uniforms,this.worldTracker.tracksDataEnabled=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}class iA extends r5{constructor(e,t){super(e,t),this.anchor=t.worldAnchor}}console.log("Zappar for ThreeJS v4.0.0-beta.2")},6391:(e,t,r)=>{e.exports=r.p+"static/media/zappar-cv.4063e7cd.wasm"},6637:(e,t,r)=>{r.d(t,{$0:()=>c,$h:()=>d,B8:()=>n,C:()=>s,CV:()=>_,kN:()=>l,lw:()=>o,vt:()=>a});var i=r(1142);function a(){var e=new i.tb(16);return i.tb!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function s(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function n(e,t){var r=t[0],i=t[1],a=t[2],s=t[3],n=t[4],o=t[5],l=t[6],_=t[7],c=t[8],d=t[9],h=t[10],u=t[11],m=t[12],p=t[13],f=t[14],g=t[15],v=r*o-i*n,b=r*l-a*n,y=r*_-s*n,w=i*l-a*o,A=i*_-s*o,T=a*_-s*l,E=c*p-d*m,R=c*f-h*m,x=c*g-u*m,M=d*f-h*p,k=d*g-u*p,I=h*g-u*f,S=v*I-b*k+y*M+w*x-A*R+T*E;return S?(S=1/S,e[0]=(o*I-l*k+_*M)*S,e[1]=(a*k-i*I-s*M)*S,e[2]=(p*T-f*A+g*w)*S,e[3]=(h*A-d*T-u*w)*S,e[4]=(l*x-n*I-_*R)*S,e[5]=(r*I-a*x+s*R)*S,e[6]=(f*y-m*T-g*b)*S,e[7]=(c*T-h*y+u*b)*S,e[8]=(n*k-o*x+_*E)*S,e[9]=(i*x-r*k-s*E)*S,e[10]=(m*A-p*y+g*v)*S,e[11]=(d*y-c*A-u*v)*S,e[12]=(o*R-n*M-l*E)*S,e[13]=(r*M-i*R+a*E)*S,e[14]=(p*b-m*w-f*v)*S,e[15]=(c*w-d*b+h*v)*S,e):null}function o(e,t,r){var i=t[0],a=t[1],s=t[2],n=t[3],o=t[4],l=t[5],_=t[6],c=t[7],d=t[8],h=t[9],u=t[10],m=t[11],p=t[12],f=t[13],g=t[14],v=t[15],b=r[0],y=r[1],w=r[2],A=r[3];return e[0]=b*i+y*o+w*d+A*p,e[1]=b*a+y*l+w*h+A*f,e[2]=b*s+y*_+w*u+A*g,e[3]=b*n+y*c+w*m+A*v,b=r[4],y=r[5],w=r[6],A=r[7],e[4]=b*i+y*o+w*d+A*p,e[5]=b*a+y*l+w*h+A*f,e[6]=b*s+y*_+w*u+A*g,e[7]=b*n+y*c+w*m+A*v,b=r[8],y=r[9],w=r[10],A=r[11],e[8]=b*i+y*o+w*d+A*p,e[9]=b*a+y*l+w*h+A*f,e[10]=b*s+y*_+w*u+A*g,e[11]=b*n+y*c+w*m+A*v,b=r[12],y=r[13],w=r[14],A=r[15],e[12]=b*i+y*o+w*d+A*p,e[13]=b*a+y*l+w*h+A*f,e[14]=b*s+y*_+w*u+A*g,e[15]=b*n+y*c+w*m+A*v,e}function l(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function _(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function c(e,t,r){var a,s,n,o=r[0],l=r[1],_=r[2],c=Math.hypot(o,l,_);return c<i.p8?null:(o*=c=1/c,l*=c,_*=c,a=Math.sin(t),n=1-(s=Math.cos(t)),e[0]=o*o*n+s,e[1]=l*o*n+_*a,e[2]=_*o*n-l*a,e[3]=0,e[4]=o*l*n-_*a,e[5]=l*l*n+s,e[6]=_*l*n+o*a,e[7]=0,e[8]=o*_*n+l*a,e[9]=l*_*n-o*a,e[10]=_*_*n+s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function d(e,t,r,i,a,s,n){var o=1/(r-t),l=1/(a-i),_=1/(s-n);return e[0]=2*s*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*s*l,e[6]=0,e[7]=0,e[8]=(r+t)*o,e[9]=(a+i)*l,e[10]=(n+s)*_,e[11]=-1,e[12]=0,e[13]=0,e[14]=n*s*2*_,e[15]=0,e}},6707:(e,t,r)=>{e.exports=r.p+"static/media/face_tracking_model.c3b15d03.zbin"},8044:(e,t,r)=>{var i,a,s,n,o,l,_,c,d,h,u;r.d(t,{DN:()=>c,EC:()=>a,HE:()=>u,HO:()=>s,f_:()=>o,iq:()=>i,uI:()=>d,yc:()=>_,z0:()=>h,zn:()=>n}),function(e){e[e.UNKNOWN=131072]="UNKNOWN",e[e.AZTEC=1]="AZTEC",e[e.CODABAR=2]="CODABAR",e[e.CODE_39=4]="CODE_39",e[e.CODE_93=8]="CODE_93",e[e.CODE_128=16]="CODE_128",e[e.DATA_MATRIX=32]="DATA_MATRIX",e[e.EAN_8=64]="EAN_8",e[e.EAN_13=128]="EAN_13",e[e.ITF=256]="ITF",e[e.MAXICODE=512]="MAXICODE",e[e.PDF_417=1024]="PDF_417",e[e.QR_CODE=2048]="QR_CODE",e[e.RSS_14=4096]="RSS_14",e[e.RSS_EXPANDED=8192]="RSS_EXPANDED",e[e.UPC_A=16384]="UPC_A",e[e.UPC_E=32768]="UPC_E",e[e.UPC_EAN_EXTENSION=65536]="UPC_EAN_EXTENSION",e[e.ALL=131071]="ALL"}(i||(i={})),function(e){e[e.EYE_LEFT=0]="EYE_LEFT",e[e.EYE_RIGHT=1]="EYE_RIGHT",e[e.EAR_LEFT=2]="EAR_LEFT",e[e.EAR_RIGHT=3]="EAR_RIGHT",e[e.NOSE_BRIDGE=4]="NOSE_BRIDGE",e[e.NOSE_TIP=5]="NOSE_TIP",e[e.NOSE_BASE=6]="NOSE_BASE",e[e.LIP_TOP=7]="LIP_TOP",e[e.LIP_BOTTOM=8]="LIP_BOTTOM",e[e.MOUTH_CENTER=9]="MOUTH_CENTER",e[e.CHIN=10]="CHIN",e[e.EYEBROW_LEFT=11]="EYEBROW_LEFT",e[e.EYEBROW_RIGHT=12]="EYEBROW_RIGHT"}(a||(a={})),function(e){e[e.WORLD=3]="WORLD",e[e.MINUS_Z_AWAY_FROM_USER=4]="MINUS_Z_AWAY_FROM_USER",e[e.MINUS_Z_HEADING=5]="MINUS_Z_HEADING",e[e.UNCHANGED=6]="UNCHANGED"}(s||(s={})),function(e){e[e.UNCHANGED=0]="UNCHANGED",e[e.WORLD=1]="WORLD",e[e.PARENT=2]="PARENT",e[e.Z_TOWARDS_CAMERA=3]="Z_TOWARDS_CAMERA"}(n||(n={})),function(e){e[e.LOG_LEVEL_NONE=0]="LOG_LEVEL_NONE",e[e.LOG_LEVEL_ERROR=1]="LOG_LEVEL_ERROR",e[e.LOG_LEVEL_WARNING=2]="LOG_LEVEL_WARNING",e[e.LOG_LEVEL_VERBOSE=3]="LOG_LEVEL_VERBOSE"}(o||(o={})),function(e){e[e.FRAME_PIXEL_FORMAT_I420=0]="FRAME_PIXEL_FORMAT_I420",e[e.FRAME_PIXEL_FORMAT_I420A=1]="FRAME_PIXEL_FORMAT_I420A",e[e.FRAME_PIXEL_FORMAT_I422=2]="FRAME_PIXEL_FORMAT_I422",e[e.FRAME_PIXEL_FORMAT_I444=3]="FRAME_PIXEL_FORMAT_I444",e[e.FRAME_PIXEL_FORMAT_NV12=4]="FRAME_PIXEL_FORMAT_NV12",e[e.FRAME_PIXEL_FORMAT_RGBA=5]="FRAME_PIXEL_FORMAT_RGBA",e[e.FRAME_PIXEL_FORMAT_BGRA=6]="FRAME_PIXEL_FORMAT_BGRA",e[e.FRAME_PIXEL_FORMAT_Y=7]="FRAME_PIXEL_FORMAT_Y"}(l||(l={})),function(e){e[e.IMAGE_TRACKER_TYPE_PLANAR=0]="IMAGE_TRACKER_TYPE_PLANAR",e[e.IMAGE_TRACKER_TYPE_CYLINDRICAL=1]="IMAGE_TRACKER_TYPE_CYLINDRICAL",e[e.IMAGE_TRACKER_TYPE_CONICAL=2]="IMAGE_TRACKER_TYPE_CONICAL"}(_||(_={})),function(e){e[e.WORLD_TRACKER_QUALITY_INITIALIZING=0]="WORLD_TRACKER_QUALITY_INITIALIZING",e[e.WORLD_TRACKER_QUALITY_GOOD=1]="WORLD_TRACKER_QUALITY_GOOD",e[e.WORLD_TRACKER_QUALITY_LIMITED=2]="WORLD_TRACKER_QUALITY_LIMITED",e[e.WORLD_TRACKER_QUALITY_INACTIVE=3]="WORLD_TRACKER_QUALITY_INACTIVE"}(c||(c={})),function(e){e[e.ANCHOR_STATUS_INITIALIZING=0]="ANCHOR_STATUS_INITIALIZING",e[e.ANCHOR_STATUS_TRACKING=1]="ANCHOR_STATUS_TRACKING",e[e.ANCHOR_STATUS_PAUSED=2]="ANCHOR_STATUS_PAUSED",e[e.ANCHOR_STATUS_STOPPED=3]="ANCHOR_STATUS_STOPPED"}(d||(d={})),function(e){e[e.PLANE_ORIENTATION_HORIZONTAL=0]="PLANE_ORIENTATION_HORIZONTAL",e[e.PLANE_ORIENTATION_VERTICAL=1]="PLANE_ORIENTATION_VERTICAL"}(h||(h={})),function(e){e[e.DEFAULT=0]="DEFAULT",e[e.HIGH=1]="HIGH"}(u||(u={}))},9682:(e,t,r)=>{r.d(t,{M:()=>n});var i,a=r(2401),s=r(8044);!function(e){e[e.OBJECT_URL=0]="OBJECT_URL",e[e.SRC_OBJECT=1]="SRC_OBJECT"}(i||(i={}));let n={deviceMotionMutliplier:-1,blacklisted:!1,showGyroPermissionsWarningIfNecessary:!1,showSafariPermissionsResetIfNecessary:!1,requestHighFrameRate:!1,videoWidth:640,videoHeight:480,getDataSize:e=>e===s.HE.HIGH?[640,480]:[320,240],videoElementInDOM:!1,preferMediaStreamTrackProcessorCamera:!1,preferImageBitmapCamera:!1,ios164CameraSelection:!1,relyOnConstraintsForCameraSelection:!1,forceWindowOrientation:!1,intervalMultiplier:1,trustSensorIntervals:!1,offscreenCanvasSupported:void 0!==globalThis.OffscreenCanvas};"undefined"!=typeof window&&(window.zeeProfile=n,window.location.href.indexOf("_mstppipeline")>=0&&(console.log("Configuring for MSTP camera pipeline (if supported)"),n.preferMediaStreamTrackProcessorCamera=!0),window.location.href.indexOf("_imagebitmappipeline")>=0&&(console.log("Configuring for ImageBitmap camera pipeline (if supported)"),n.preferImageBitmapCamera=!0));let o=new a.UAParser,l=(o.getOS().name||"unknown").toLowerCase(),_=(o.getEngine().name||"unknown").toLowerCase();function c(e){n.forceWindowOrientation=!0,n.preferMediaStreamTrackProcessorCamera=!1,n.intervalMultiplier=1e3,n.trustSensorIntervals=!0;let t=e.split(".");if(t.length>=2){let e=parseInt(t[0]),r=parseInt(t[1]);(e<11||11===e&&r<3)&&(n.blacklisted=!0),(e<12||12===e&&r<2)&&(n.videoElementInDOM=!0),(12===e&&r>=2||e>=13)&&(n.showGyroPermissionsWarningIfNecessary=!0),e>=13&&(n.showSafariPermissionsResetIfNecessary=!0),(e>=12&&r>1||e>=13)&&navigator.mediaDevices&&navigator.mediaDevices.getSupportedConstraints&&navigator.mediaDevices.getSupportedConstraints().frameRate&&(n.requestHighFrameRate=!0,e<14&&(n.videoHeight=360,n.getDataSize=e=>e===s.HE.HIGH?[640,360]:[320,180])),16===e&&r>=4&&(n.ios164CameraSelection=!0),e>=17&&(n.relyOnConstraintsForCameraSelection=!0)}}"webkit"===_&&"ios"!==l&&(n.deviceMotionMutliplier=1,"undefined"!=typeof window&&void 0!==window.orientation&&c("15.0")),"webkit"===_&&"ios"===l&&(n.deviceMotionMutliplier=1,c(o.getOS().version||"15.0"))}}]);